"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[863],{25558:function(e,t,n){var i=n(93913),r=n.n(i),o=n(34575),a=n.n(o),s={DEFAULT:0,LOADING:1,ENCODING:2,ENCODED:3,UPLOADING:4,UPLOADED:5},c={VERTICAL:0,HORIZONTAL:1},u=r()((function e(t){a()(this,e),t=t||{},this.key=t.key||null,this.url=t.url||"",this.status=t.status||s.DEFAULT,this.orientation=t.orientation||c.VERTICAL,this.base64=null,this.width=0,this.height=0,this.webURL=null}));u.ImageStatus=s,u.ImageOrientation=c,t.Z=u},5815:function(e,t,n){n.d(t,{Z:function(){return N}});var i=n(50008),r=n.n(i),o=n(48926),a=n.n(o),s=n(34575),c=n.n(s),u=n(93913),l=n.n(u),f=n(87757),d=n.n(f),m=n(11954),p=n(53527);var h,v=(h=p.ZP.getInstance().getPageID(),(0,m.e)({pageInfo:{pageId:h}})),g=function(){function e(){c()(this,e),this.bucketTag=null,this.loaded=!1,this.api="image/signature"}return l()(e,[{key:"load",value:function(e){e=e||{},this.bucketTag=e.bucketTag||this.bucketTag}},{key:"getSign",value:function(){var e=this;return new Promise((function(t,n){v.post(e.api,{bucket_tag:e.bucketTag}).then((function(e){t({signature:(e=e||{}).signature||""})}),(function(){n()}))}))}}]),e}(),y=n(25558),S=function(){function e(){c()(this,e),this.img=null,this.coreContext=null}var t;return l()(e,[{key:"load",value:function(e){e=e||{},this.coreContext=e.context||null}},{key:"onSelected",value:(t=a()(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&this.coreContext&&this.img)){e.next=5;break}return this.coreContext.updateImage(this.img,t),e.next=4,this.coreContext.loadImage(this.img);case 4:this.coreContext.process(this.img);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"onSelectStart",value:function(){this.img&&(this.img=null),this.img=this.coreContext.createImage()}},{key:"onSelectCancel",value:function(){this.coreContext&&(this.coreContext.remove(this.img),this.img=null)}}]),e}(),A=S;var I=new function(e){Math.round;var t,n,i,r,o,a=Math.floor,s=new Array(64),c=new Array(64),u=new Array(64),l=new Array(64),f=new Array(65535),d=new Array(65535),m=new Array(64),p=new Array(64),h=[],v=0,g=7,y=new Array(64),S=new Array(64),A=new Array(64),I=new Array(256),w=new Array(2048),b=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],k=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],C=[0,1,2,3,4,5,6,7,8,9,10,11],P=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],E=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],L=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],x=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],R=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function D(e,t){for(var n=0,i=0,r=[],o=1;o<=16;o++){for(var a=1;a<=e[o];a++)r[t[i]]=[],r[t[i]][0]=n,r[t[i]][1]=o,i++,n++;n*=2}return r}function N(e){for(var t=e[0],n=e[1]-1;n>=0;)t&1<<n&&(v|=1<<g),n--,--g<0&&(255==v?(O(255),O(0)):O(v),g=7,v=0)}function O(e){h.push(I[e])}function M(e){O(e>>8&255),O(255&e)}function F(e,t,n,i,r){for(var o,a=r[0],s=r[240],c=function(e,t){var n,i,r,o,a,s,c,u,l,f,d=0;for(l=0;l<8;++l){n=e[d],i=e[d+1],r=e[d+2],o=e[d+3],a=e[d+4],s=e[d+5],c=e[d+6];var p=n+(u=e[d+7]),h=n-u,v=i+c,g=i-c,y=r+s,S=r-s,A=o+a,I=o-a,w=p+A,b=p-A,k=v+y,C=v-y;e[d]=w+k,e[d+4]=w-k;var P=.707106781*(C+b);e[d+2]=b+P,e[d+6]=b-P;var E=.382683433*((w=I+S)-(C=g+h)),L=.5411961*w+E,x=1.306562965*C+E,U=.707106781*(k=S+g),R=h+U,D=h-U;e[d+5]=D+L,e[d+3]=D-L,e[d+1]=R+x,e[d+7]=R-x,d+=8}for(d=0,l=0;l<8;++l){n=e[d],i=e[d+8],r=e[d+16],o=e[d+24],a=e[d+32],s=e[d+40],c=e[d+48];var N=n+(u=e[d+56]),O=n-u,M=i+c,F=i-c,B=r+s,T=r-s,V=o+a,_=o-a,Q=N+V,G=N-V,W=M+B,j=M-B;e[d]=Q+W,e[d+32]=Q-W;var Z=.707106781*(j+G);e[d+16]=G+Z,e[d+48]=G-Z;var J=.382683433*((Q=_+T)-(j=F+O)),z=.5411961*Q+J,H=1.306562965*j+J,X=.707106781*(W=T+F),q=O+X,K=O-X;e[d+40]=K+z,e[d+24]=K-z,e[d+8]=q+H,e[d+56]=q-H,d++}for(l=0;l<64;++l)f=e[l]*t[l],m[l]=f>0?f+.5|0:f-.5|0;return m}(e,t),u=0;u<64;++u)p[b[u]]=c[u];var l=p[0]-n;n=p[0],0==l?N(i[0]):(N(i[d[o=32767+l]]),N(f[o]));for(var h=63;h>0&&0==p[h];)h--;if(0==h)return N(a),n;for(var v,g=1;g<=h;){for(var y=g;0==p[g]&&g<=h;)++g;var S=g-y;if(S>=16){v=S>>4;for(var A=1;A<=v;++A)N(s);S&=15}o=32767+p[g],N(r[(S<<4)+d[o]]),N(f[o]),g++}return 63!=h&&N(a),n}function B(e){e<=0&&(e=1),e>100&&(e=100),o!=e&&(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n=0;n<64;n++){var i=a((t[n]*e+50)/100);i<1?i=1:i>255&&(i=255),s[b[n]]=i}for(var r=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],o=0;o<64;o++){var f=a((r[o]*e+50)/100);f<1?f=1:f>255&&(f=255),c[b[o]]=f}for(var d=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],m=0,p=0;p<8;p++)for(var h=0;h<8;h++)u[m]=1/(s[b[m]]*d[p]*d[h]*8),l[m]=1/(c[b[m]]*d[p]*d[h]*8),m++}(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),o=e)}this.encode=function(e,o,a){(new Date).getTime(),o&&B(o),h=[],v=0,g=7,M(65496),M(65504),M(16),O(74),O(70),O(73),O(70),O(0),O(1),O(1),O(0),M(1),M(1),O(0),O(0),function(){M(65499),M(132),O(0);for(var e=0;e<64;e++)O(s[e]);O(1);for(var t=0;t<64;t++)O(c[t])}(),function(e,t){M(65472),M(17),O(8),M(t),M(e),O(3),O(1),O(17),O(0),O(2),O(17),O(1),O(3),O(17),O(1)}(e.width,e.height),function(){M(65476),M(418),O(0);for(var e=0;e<16;e++)O(k[e+1]);for(var t=0;t<=11;t++)O(C[t]);O(16);for(var n=0;n<16;n++)O(P[n+1]);for(var i=0;i<=161;i++)O(E[i]);O(1);for(var r=0;r<16;r++)O(L[r+1]);for(var o=0;o<=11;o++)O(x[o]);O(17);for(var a=0;a<16;a++)O(U[a+1]);for(var s=0;s<=161;s++)O(R[s])}(),M(65498),M(12),O(3),O(1),O(0),O(2),O(17),O(3),O(17),O(0),O(63),O(0);var f=0,d=0,m=0;v=0,g=7,this.encode.displayName="_encode_";for(var p,I,b,D,T,V,_,Q,G,W=e.data,j=e.width,Z=e.height,J=4*j,z=0;z<Z;){for(p=0;p<J;){for(V=T=J*z+p,_=-1,Q=0,G=0;G<64;G++)V=T+(Q=G>>3)*J+(_=4*(7&G)),z+Q>=Z&&(V-=J*(z+1+Q-Z)),p+_>=J&&(V-=p+_-J+4),I=W[V++],b=W[V++],D=W[V++],y[G]=(w[I]+w[b+256>>0]+w[D+512>>0]>>16)-128,S[G]=(w[I+768>>0]+w[b+1024>>0]+w[D+1280>>0]>>16)-128,A[G]=(w[I+1280>>0]+w[b+1536>>0]+w[D+1792>>0]>>16)-128;f=F(y,u,f,t,i),d=F(S,l,d,n,r),m=F(A,l,m,n,r),p+=32}z+=8}if(g>=0){var H=[];H[1]=g+1,H[0]=(1<<g+1)-1,N(H)}if(M(65497),a){for(var X=h.length,q=new Uint8Array(X),K=0;K<X;K++)q[K]=h[K].charCodeAt();return h=[],q}var Y="data:image/jpeg;base64,"+btoa(h.join(""));return h=[],Y},e||(e=50),function(){for(var e=String.fromCharCode,t=0;t<256;t++)I[t]=e(t)}(),t=D(k,C),n=D(L,x),i=D(P,E),r=D(U,R),function(){for(var e=1,t=2,n=1;n<=15;n++){for(var i=e;i<t;i++)d[32767+i]=n,f[32767+i]=[],f[32767+i][1]=n,f[32767+i][0]=i;for(var r=-(t-1);r<=-e;r++)d[32767+r]=n,f[32767+r]=[],f[32767+r][1]=n,f[32767+r][0]=t-1+r;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)w[e]=19595*e,w[e+256>>0]=38470*e,w[e+512>>0]=7471*e+32768,w[e+768>>0]=-11059*e,w[e+1024>>0]=-21709*e,w[e+1280>>0]=32768*e+8421375,w[e+1536>>0]=-27439*e,w[e+1792>>0]=-5329*e}(),B(e)}(100),w={EXIF:null};(function(){var e=function e(t){return t instanceof e?t:this instanceof e?void 0:new e(t)},t=e.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},n=e.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},i=e.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},o=e.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function a(e){return!!e.exifdata}function s(e,t){function n(n){var i=c(n),r=function(e){var t=new DataView(e);if(255!=t.getUint8(0)||216!=t.getUint8(1))return!1;var n=2,i=e.byteLength,r=function(e,t){return 56===e.getUint8(t)&&66===e.getUint8(t+1)&&73===e.getUint8(t+2)&&77===e.getUint8(t+3)&&4===e.getUint8(t+4)&&4===e.getUint8(t+5)};for(;n+5<i;){if(r(t,n)){var o=t.getUint8(n+7);return o%2!=0&&(o+=1),0===o&&(o=4),l(e,n+8+o,t.getUint16(n+6+o))}n++}}(n);e.exifdata=i||{},e.iptcdata=r||{},t&&t.call(e)}if(e.src)if(/^data\:/i.test(e.src))n(function(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/im)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gim,"").replace(/%0A/gi,"");for(var n=atob(e),i=n.length,r=new ArrayBuffer(i),o=new Uint8Array(r),a=0;a<i;a++)o[a]=n.charCodeAt(a);return r}(e.src));else if(/^blob\:/i.test(e.src)){var i=new FileReader;i.onload=function(e){n(e.target.result)},function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="blob",n.onload=function(e){200!=this.status&&0!==this.status||t(this.response)},n.send()}(e.src,(function(e){i.readAsArrayBuffer(e)}))}else{var r=new XMLHttpRequest;r.onload=function(){if(200!=this.status&&0!==this.status)throw new Error("Could not load image");n(r.response),r=null},r.open("GET",e.src,!0),r.responseType="arraybuffer",r.send(null)}else if(window.FileReader&&(e instanceof window.Blob||e instanceof window.File)){var o=new FileReader;o.onload=function(e){n(e.target.result)},o.readAsArrayBuffer(e)}}function c(e){var t=new DataView(e);if(255!=t.getUint8(0)||216!=t.getUint8(1))return!1;for(var n=2,i=e.byteLength;n<i;){if(255!=t.getUint8(n))return!1;if(225==t.getUint8(n+1))return p(t,n+4,t.getUint16(n+2));n+=2+t.getUint16(n+2)}}var u={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};function l(e,t,n){for(var i,r,o,a,s=new DataView(e),c={},l=t;l<t+n;)28===s.getUint8(l)&&2===s.getUint8(l+1)&&(a=s.getUint8(l+2))in u&&((o=s.getInt16(l+3))+5,r=u[a],i=m(s,l+5,o),c.hasOwnProperty(r)?c[r]instanceof Array?c[r].push(i):c[r]=[c[r],i]:c[r]=i),l++;return c}function f(e,t,n,i,r){var o,a,s=e.getUint16(n,!r),c={};for(a=0;a<s;a++)o=n+12*a+2,c[i[e.getUint16(o,!r)]]=d(e,o,t,n,r);return c}function d(e,t,n,i,r){var o,a,s,c,u,l,f=e.getUint16(t+2,!r),d=e.getUint32(t+4,!r),p=e.getUint32(t+8,!r)+n;switch(f){case 1:case 7:if(1==d)return e.getUint8(t+8,!r);for(o=d>4?p:t+8,a=[],c=0;c<d;c++)a[c]=e.getUint8(o+c);return a;case 2:return m(e,o=d>4?p:t+8,d-1);case 3:if(1==d)return e.getUint16(t+8,!r);for(o=d>2?p:t+8,a=[],c=0;c<d;c++)a[c]=e.getUint16(o+2*c,!r);return a;case 4:if(1==d)return e.getUint32(t+8,!r);for(a=[],c=0;c<d;c++)a[c]=e.getUint32(p+4*c,!r);return a;case 5:if(1==d)return u=e.getUint32(p,!r),l=e.getUint32(p+4,!r),(s=new Number(u/l)).numerator=u,s.denominator=l,s;for(a=[],c=0;c<d;c++)u=e.getUint32(p+8*c,!r),l=e.getUint32(p+4+8*c,!r),a[c]=new Number(u/l),a[c].numerator=u,a[c].denominator=l;return a;case 9:if(1==d)return e.getInt32(t+8,!r);for(a=[],c=0;c<d;c++)a[c]=e.getInt32(p+4*c,!r);return a;case 10:if(1==d)return e.getInt32(p,!r)/e.getInt32(p+4,!r);for(a=[],c=0;c<d;c++)a[c]=e.getInt32(p+8*c,!r)/e.getInt32(p+4+8*c,!r);return a}}function m(e,t,n){for(var i="",r=t;r<t+n;r++)i+=String.fromCharCode(e.getUint8(r));return i}function p(e,r){if("Exif"!=m(e,r,4))return!1;var a,s,c,u,l=r+6;if(18761==e.getUint16(l))a=!1;else{if(19789!=e.getUint16(l))return!1;a=!0}if(42!=e.getUint16(l+2,!a))return!1;var d=e.getUint32(l+4,!a);if(d<8)return!1;var p=f(e,l,l+d,n,a);if(p.ExifIFDPointer)for(s in c=f(e,l,l+p.ExifIFDPointer,t,a)){switch(s){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":c[s]=o[s][c[s]];break;case"ExifVersion":case"FlashpixVersion":c[s]=String.fromCharCode(c[s][0],c[s][1],c[s][2],c[s][3]);break;case"ComponentsConfiguration":c[s]=o.Components[c[s][0]]+o.Components[c[s][1]]+o.Components[c[s][2]]+o.Components[c[s][3]]}p[s]=c[s]}if(p.GPSInfoIFDPointer)for(s in u=f(e,l,l+p.GPSInfoIFDPointer,i,a)){if("GPSVersionID"===s)u[s]=u[s][0]+"."+u[s][1]+"."+u[s][2]+"."+u[s][3];p[s]=u[s]}return p}e.getData=function(e,t){return!((e instanceof Image||e instanceof HTMLImageElement)&&!e.complete)&&(a(e)?t&&t.call(e):s(e,t),!0)},e.getTag=function(e,t){if(a(e))return e.exifdata[t]},e.getAllTags=function(e){if(!a(e))return{};var t,n=e.exifdata,i={};for(t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i},e.pretty=function(e){if(!a(e))return"";var t,n=e.exifdata,i="";for(t in n)n.hasOwnProperty(t)&&("object"===r()(n[t])?n[t]instanceof Number?i+=t+" : "+n[t]+" ["+n[t].numerator+"/"+n[t].denominator+"]\r\n":i+=t+" : ["+n[t].length+" values]\r\n":i+=t+" : "+n[t]+"\r\n");return i},e.readFromBinaryFile=function(e){return c(e)},w.EXIF=e}).call(window);var b=w,k=null,C=function(){function e(t){c()(this,e),this.returnNullIfNotFitLimit=t.returnNullIfNotFitLimit||!1,this.limitBase64Length=t.limitBase64Length||0}return l()(e,[{key:"compressImage",value:function(e,t){var n=this;e&&t&&this.getImgData(e,(function(e,i){var r=i.width,o=i.height,a=r/o;(r>1200||o>1200)&&(r=1200,(o=parseInt(r/a,10))>1200&&(o=1200,r=parseInt(o*a,10)));var s=document.createElement("canvas"),c=s.getContext("2d");if(s.width=r,s.height=o,c.drawImage(i,0,0,r,o),e&&1!==e)switch(e){case 6:n.rotateImg(i,"left",s,r,o);break;case 8:n.rotateImg(i,"right",s,r,o);break;case 3:n.rotateImg(i,"right",s,r,o),n.rotateImg(i,"right",s,r,o)}if(6!==e&&8!==e||(r+=o,r-=o=r-o),n.notSupportCompressJpeg||n.tryLoopCompress(r,o,75,(function(e){return s.toDataURL("image/jpeg",e/100)}),!1,t),n.notSupportCompressJpeg){var u=c.getImageData(0,0,r,o);n.tryLoopCompress(r,o,75,(function(e){return I.encode(u,e,!1)}),!0,t)}}))}},{key:"getImgData",value:function(e,t){var n=new Image;n.src=e.url,n.onload=function(){try{void 0!==e.exifOrientation?t(e.exifOrientation,n):b.EXIF.getData(n,(function(){b.EXIF.getAllTags(n);var e=b.EXIF.getTag(n,"Orientation");t(e,n)}))}catch(e){t(null,n)}}}},{key:"tryLoopCompress",value:function(e,t,n,i,r,o){var a;do{if(a=i(n),n-=10,!r&&(!a||a.length<10||0===a.indexOf("data:image/png;")))return void(this.notSupportCompressJpeg=!0)}while(a.length>this.limitBase64Length&&n>=10);a.length>this.limitBase64Length&&this.returnNullIfNotFitLimit?o&&o(null,e,t):o&&o(a,e,t)}},{key:"rotateImg",value:function(e,t,n,i,r){if(e){var o=2;o||(o=0),"right"===t?++o>3&&(o=0):--o<0&&(o=3);var a=90*o*Math.PI/180,s=n.getContext("2d");switch(o){case 0:n.width=i,n.height=r,s.drawImage(e,0,0,i,r);break;case 1:n.width=r,n.height=i,s.rotate(a),s.drawImage(e,0,-r,i,r);break;case 2:n.width=i,n.height=r,s.rotate(a),s.drawImage(e,-i,-r,i,r);break;case 3:n.width=r,n.height=i,s.rotate(a),s.drawImage(e,-i,0,i,r)}}}}]),e}();C.getInstance=function(){return k||(k=new C),k};var P=C;var E=y.Z.ImageStatus,L=y.Z.ImageOrientation,x=300,U=300;function R(e,t){if(t&&e){for(var n=[],i=2;i<arguments.length;++i)n.push(arguments[i]);t.apply(e,n)}}var D=function(){function e(t){c()(this,e),this.loaded=!1,this.imageMap=t.imageMap||{},this.keyList=t.keyList||[],this.nativeReceiver=null,this.seed=t.seed||1,this.uploadAPI="v2/store_image",this.signatureModule=null,this.taskMap={},this.callbackMap={},this.context=null,this.imageTargetSize=U,this.imageLimitSize=x,this.imageUtil=null,this.fileDomain="",this.useXHR=!!t.useXHR}var t,n,i;return l()(e,[{key:"load",value:function(e){this.loaded||(e=e||{},this.uploadAPI=e.uploadAPI||this.uploadAPI,this.callbackMap=e.callbackMap||this.callbackMap,this.context=e.context||this.context,this.imageTargetSize=e.imageTargetSize||this.imageTargetSize,this.imageLimitSize=e.imageLimitSize||this.imageLimitSize,this.fileDomain=e.fileDomain||(location.href.includes("hutaojie")?"https://file.hutaojie.com/":"https://file.pinduoduo.com/"),this.imageUtil=e.imageUtil||new P({limitBase64Length:1024*this.imageLimitSize,returnNullIfNotFitLimit:!1}),this.nativeReceiver=new A,this.signatureModule=new g,this.nativeReceiver.load({context:this}),this.signatureModule.load({bucketTag:e.bucketTag}))}},{key:"createImage",value:function(){return new y.Z({key:"img-"+this.seed++})}},{key:"updateImage",value:function(e,t,n){e&&(n=n||{},e.url=t,e.orientation=n.orientation||e.orientation)}},{key:"loadImage",value:(i=a()(d().mark((function e(t){var n,i,r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||t.status!==E.DEFAULT){e.next=11;break}return this.imageMap[t.key]=t,this.keyList.push(t.key),t.status=E.LOADING,e.next=6,this.getImageOrientation(t);case 6:n=e.sent,t.exifOrientation=n,i=this.context,r=this.callbackMap.onLoad,R(i,r,t);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getImageOrientation",value:(n=a()(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=new Image;n.onload=function(){if(2===n.width&&3===n.height)return e(0);var i=new Image;i.onload=function(){try{b.EXIF.getData(i,(function(){e(b.EXIF.getTag(i,"Orientation")||0)}))}catch(t){e(b.EXIF.getTag(i,"Orientation")||0)}},i.src=t.url},n.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAIAAwMBEQACEQEDEQH/xABRAAEAAAAAAAAAAAAAAAAAAAAKEAEBAQADAQEAAAAAAAAAAAAGBQQDCAkCBwEBAAAAAAAAAAAAAAAAAAAAABEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8AG8T9NfSMEVMhQvoP3fFiRZ+MTHDifa/95OFSZU5OzRzxkyejv8ciEfhSceSXGjS8eSdLnZc2HDm4M3BxcXwH/9k="})));case 1:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"createImageAndLoad",value:(t=a()(d().mark((function e(t,n){var i;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.createImage(t,n),this.updateImage(i,t,n),e.next=4,this.loadImage(i);case 4:return e.abrupt("return",i);case 5:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"loadImageByFile",value:function(e){if((e=e||{}).type){if(!/^(image\/jpeg|image\/png)$/i.test(e.type))return}else if(e.name){var t=e.name||"";if(-1===(t=t.toUpperCase()).indexOf("IMAGE%3A")&&-1===t.indexOf("IMAGE:"))return}var n=(URL||window.webkitURL).createObjectURL(e);return this.createImageAndLoad(n)}},{key:"remove",value:function(e){if(e){var t=e.key,n=this.keyList.indexOf(t);n>=0&&this.keyList.splice(n,1)}}},{key:"getImage",value:function(e){return this.imageMap[e]||null}},{key:"getImages",value:function(){var e=this.imageMap||{},t=this.keyList||[],n=[];return t.forEach((function(t){var i=e[t]||null;i&&n.push(i)})),n}},{key:"getImageCount",value:function(){return this.keyList.length}},{key:"getImageProperties",value:function(e,t){var n=this.imageMap||{},i=this.keyList||[],o=[];return i.forEach((function(i){var a=n[i];if(e&&a)if("string"==typeof e)a&&a[e]&&o.push(a[e]||t);else if("object"===r()(e)){var s={};for(var c in e)e.hasOwnProperty(c)&&(s[c]=a[e[c]]||t);s&&o.push(s)}})),o}},{key:"encodeImage",value:function(e){e=e||{};var t=this;return new Promise((function(n,i){if(e.status===E.LOADING&&e.url){e.status=E.ENCODING,R(t.context,t.callbackMap.onEncode,e);var r=new Image,o=e.url,a=function(t,i,r){e.base64=t.replace(/%0A/gi,""),e.width=i,e.height=r,e.orientation=i>r?L.HORIZONTAL:L.VERTICAL,e.status=E.ENCODED,n(e)};r.onload=function(n){0!==o.indexOf("data:image/")||o.length>1024*t.imageLimitSize?t.imageUtil.compressImage(e,a):a(o,r.width,r.height)},r.src=o}else i()}))}},{key:"uploadImage",value:function(e,t){var n=this,i=this;return e=e||{},new Promise((function(r,o){if(t&&e&&e.status===E.ENCODED&&e.base64){e.status=E.UPLOADING,R(i.context,i.callbackMap.onUpload,e);var a=function(t){e.status=E.UPLOADED,t=t||{},e.webURL=t.url,e.width=t.width,e.height=t.height,r(e)},s=function(e){o(e)},c=n.fileDomain+n.uploadAPI,u={upload_sign:t,image:e.base64};n.useXHR?function(e,t,n,i){var r={method:e,body:null==n?null:JSON.stringify(n),headers:{"Content-Type":null==n?"application/x-www-form-urlencoded;charset=UTF-8":"application/json;charset=UTF-8"},credentials:"include"};r.headers.AccessToken=localStorage.getItem("AccessToken")||"";var o=new XMLHttpRequest;o.open(r.method,t,!0),o.withCredentials=!0;var a=r.headers||{};for(var s in a)o.setRequestHeader(s,a[s]);return o.onerror=i.onUploadError,o.upload.addEventListener("progress",i.onUploadProgress),o.ontimeout=i.onUploadTimeout,o.send(r.body),new Promise((function(e,t){o.onload=function(){var n=null;try{n=JSON.parse(o.responseText)}catch(e){n={}}if(n&&n.error_code)return t({errorCode:n.error_code,errorMessage:n.error_message});e(n)},o.onerror=function(e){t(e)}}))}("POST",c,u,{onUploadProgress:function(t){i.callbackMap.onUploadProgress&&i.callbackMap.onUploadProgress(e.url,t)}}).then(a,s):v.post(c,u).then(a,s)}else o()}))}},{key:"process",value:function(e){var t=this,n=t.encodeImage(e),i=t.signatureModule.getSign(),r=Promise.all([i,n]).then((function(n){var i=((n=n||[])[0]||{}).signature;return t.uploadImage(n[1]||e,i).then((function(e){R(t.context,t.callbackMap.onSuccess,e)}),(function(n){R(t.context,t.callbackMap.onFail,e,n)}))}),(function(){R(t.context,t.callbackMap.onFail,e)}));return t.taskMap[e.key]=r,r}},{key:"isAllImageReady",value:function(){for(var e=this.keyList||[],t=0,n=e.length;t<n;t++){var i=this.imageMap[e[t]];if(i&&(i.status!==E.UPLOADED||!i.webURL))return!1}return!0}},{key:"waitForAll",value:function(e){var t=[],n=this;this.keyList.forEach((function(e){n.taskMap[e]&&t.push(n.taskMap[e])})),Promise.all(t).then((function(){"function"==typeof e&&e(!0)}),(function(){"function"==typeof e&&e(!1)})).catch((function(t){"function"==typeof e&&e(!1)}))}}]),e}(),N=D},80558:function(e,t,n){n.d(t,{Z:function(){return w}});var i=n(50008),r=n.n(i),o=n(34575),a=n.n(o),s=n(93913),c=n.n(s),u=n(2205),l=n.n(u),f=n(78585),d=n.n(f),m=n(29754),p=n.n(m),h=n(67294),v=n.n(h),g={buildCtx:function(e,t){e=e||{},t=t||{};var n={};for(var i in t)t.hasOwnProperty(i)&&(n[i]={value:t[i],enumerable:!0,writable:!1});return Object.create(e,n)},pickCtx:function(e){e=e||{};var t={};for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}},y=n(12045),S=n(38533);function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return d()(this,n)}}var I=function(e){l()(n,e);var t=A(n);function n(e){var i;return a()(this,n),(i=t.call(this,e)).ctxUtil=g,i.mountViewID=e.mountViewID,i.viewID=e.viewID,i.setupViewContext(e),i.isServerEnv=!1,i.isClientEnv=!i.isServerEnv,i.platform=i.isClientEnv&&(0,S.Xf)(navigator.userAgent),i.buildViewContext(),i}return c()(n,[{key:"setupViewContext",value:function(e){var t=e.viewCtx||{};"object"!==r()(t)||0===Object.keys(t).length&&!t.isRoot?((t={}).isRoot=!0,this.viewCtx=t):(Object.keys(t).length&&!t.isRoot&&(t.isRoot=!0),this.viewCtx=this.ctxUtil.buildCtx(t))}},{key:"buildViewContext",value:function(){}},{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){}},{key:"track",value:function(e,t){if(this.isClientEnv&&e){var n=g.pickCtx(g.buildCtx(this.viewCtx,e));n.ad&&"object"===r()(n.ad)&&(n.ad=JSON.stringify(n.ad)),n.hasOwnProperty("isRoot")&&delete n.isRoot,(0,y.oP)(n).catch((function(){})).then(t)}}}]),n}(v().Component);I.defaultProps={show:!1};var w=I},30125:function(e,t,n){function i(e){return new Promise((function(t){return setTimeout(t,e)}))}n.d(t,{_:function(){return i}})},90133:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var i,r=n(319),o=n.n(r),a=n(93913),s=n.n(a),c=n(34575),u=n.n(c),l=n(2205),f=n.n(l),d=n(78585),m=n.n(d),p=n(29754),h=n.n(p),v=(n(67294),n(67674)),g=n(32028);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return m()(this,n)}}var S=(0,v.f3)("store")(i=(0,v.Pi)(i=function(e){f()(n,e);var t=y(n);function n(e){var i;return u()(this,n),(i=t.call(this,e)).clearList=function(){i.setState({imageInfoList:[],videoInfoList:[]}),i.videoUploader.clearList()},i.getImageUrlList=function(){return i.state.imageInfoList.filter((function(e){return e.webURL})).map((function(e){return e.webURL}))},i.getVideoAndCoverUrlList=function(){return i.state.videoInfoList.filter((function(e){return e.serverUrl})).map((function(e){return"".concat(e.serverUrl,";;").concat(e.videoCoverUrl)}))},i.getMediaUrlListReady=function(){return!!i.isAllMediaUploaded()&&[].concat(o()(i.getVideoAndCoverUrlList()),o()(i.getImageUrlList()))},i.store=e.store,i.store.mediaUploader={viewID:i.viewID,isAllMediaUploaded:i.isAllMediaUploaded,getMediaUrlListReady:i.getMediaUrlListReady,imageInfoList:i.state.imageInfoList||[],videoInfoList:i.state.videoInfoList||[],canSelectVideo:i.canSelectVideo,clearList:i.clearList},i}return s()(n)}(g.Z))||i)||i},35226:function(e,t,n){n.d(t,{F:function(){return E},Z:function(){return x}});var i=n(34575),r=n.n(i),o=n(93913),a=n.n(o),s=n(2205),c=n.n(s),u=n(78585),l=n.n(u),f=n(29754),d=n.n(f),m=n(67294),p=n.n(m),h=n(45697),v=n.n(h),g=n(29807),y=n.n(g),S=n(99433),A=n(80558),I=n(33945),w=n(79859),b=n(36792);function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=d()(e);if(t){var r=d()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return l()(this,n)}}var C=(0,w.eF)(),P="data:image/jpeg;base64,",E={UNKNOWN:0,IMAGE_FROM_CAMERA:1,VIDEO_FROM_CAMERA:2,FROM_ALBUM:3};function L(e){var t=e.sourceType,n=e.images,i=e.videoPath,r=e.videoCoverImage;this.sourceType=t||E.UNKNOWN,this.images=n||[],this.videoPath=i||"",this.videoCoverImage=r||""}var x=function(e){c()(n,e);var t=k(n);function n(e){var i;r()(this,n),(i=t.call(this,e)).onSelect=function(e){var t=i.props.onSelectStart,n=E.IMAGE_FROM_CAMERA,r=E.VIDEO_FROM_CAMERA,o=E.FROM_ALBUM;switch(i.sourceType=e,t(e),e){case n:return i.selectImageFromCamera();case r:return i.selectVideoFromCamera();case o:return i.selectFromAlbum()}},i.selectImageFromCamera=function(){var e=i.props,t=e.imageParam,n=e.onSelected,r={source:1},o=C.platform===S.iw.PddIOS,a=o?"4.79.0":"4.85.0",s=(0,S.yC)(C.version,a)>=0;t&&o&&(r.option=t);var c=s?"getV2":"get";(0,b.Q6)("JSPhoto",c,r).then((function(e){if((e=e||{}).image_data){var t=e.image_data,r=[];return t&&r.push("".concat(P).concat(t)),void n(new L({sourceType:i.sourceType,images:r}))}e.image_list&&e.image_list.reduce((function(e,t){return e.then((function(){var e=[];return t&&e.push("".concat(P).concat(t)),n(new L({sourceType:i.sourceType,images:e}))}))}),Promise.resolve())})).catch((function(){i.selectFail&&i.selectFail()}))},i.selectVideoFromCamera=function(){var e=i.props,t=e.videoParam,n=e.onSelected;y().callNative("JSMedia","videoCapture",t,(function(e){var t=(e=e||{}).cover_image;n(new L({sourceType:i.sourceType,videoPath:e.video_url,videoCoverImage:t?"".concat(P).concat(t):""}))}),i.selectFail)},i.selectFromAlbum=function(){var e=i.props,t=e.albumParam,n=e.onSelected;y().callNative("JSMedia","gallerySelect",t,(function(e){var t=(e=e||{}).cover_image,r=e.photo?["".concat(P).concat(e.photo)]:[];n(new L({sourceType:i.sourceType,images:r,videoPath:e.video_url,videoCoverImage:t?"".concat(P).concat(t):""}))}),i.selectFail)},i.selectFail=function(){i.props.onSelectCancel(i.sourceType)},i.canSelectVideo=!0;var o=e.options;return i.options=(o&&o.length>0?o:n.defaultProps.options).filter((function(e){return i.canSelectVideo||e.sourceType!==E.VIDEO_FROM_CAMERA})),i.sourceType=E.UNKNOWN,i}return a()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.isShow,i=t.hideSelector,r=p().createElement("div",{className:"as-media-selector"},p().createElement("ul",{className:"selector-options"},this.options.map((function(t){return p().createElement("li",{onClick:e.onSelect.bind(e,t.sourceType),key:t.sourceType},t.text)}))),this.props.enableCancel&&p().createElement("div",{className:"cancel-wrapper",onClick:i},p().createElement("div",{className:"cancel"},"取消")));return this.props.useModal?p().createElement(I.Z,{id:this.viewID,fade:"up",isShow:n,onMaskClick:i},r):r}}]),n}(A.Z);x.defaultProps={isShow:!1,useModal:!0,enableCancel:!0,options:[{text:"拍照",sourceType:E.IMAGE_FROM_CAMERA},{text:"拍视频",sourceType:E.VIDEO_FROM_CAMERA},{text:"从相册选择",sourceType:E.FROM_ALBUM}],imageParam:null,videoParam:{max_duration:15,copy_to_gallery:1},albumParam:{},onSelectStart:function(){},onSelected:function(){},onSelectCancel:function(){}},x.propTypes={useModal:v().bool,enableCancel:v().bool,options:v().arrayOf(v().object)}},9584:function(e,t,n){n.d(t,{Z:function(){return z}});var i=n(67294),r=n.n(i),o=n(36786),a=n(34575),s=n.n(a),c=n(93913),u=n.n(c),l=n(2205),f=n.n(l),d=n(78585),m=n.n(d),p=n(29754),h=n.n(p),v=n(48926),g=n.n(v),y=n(87757),S=n.n(y),A=n(82094),I=n(36792),w=n(38533),b=n(99433);function k(){var e=(0,w.zT)();return e.isNativePlatform&&(0,b.yC)(e.version,"5.31.0")>=0}function C(){var e=(0,w.zT)(),t=e.isNativePlatform,n=e.isLiteNativePlatform,i=e.systemVersion,r=e.platform,o=r===b.iw.PddIOS&&(0,b.yC)(i,"10.0.0")>=0,a=r===b.iw.PddAndroid;return t&&(o||a)&&k()&&!n}var P=n(85912),E=n(26242);function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return m()(this,n)}}var x=function(e){f()(d,e);var t,n,i,o,a,c,l=L(d);function d(e){var t;return s()(this,d),(t=l.call(this,e)).handleClickPlay=function(e){if(e&&e.stopPropagation(),C()){(0,E.g)({op:"click",page_el_sn:4780505});var n=t.props.loadedCheck;n&&!n()||(t.isCreated&&t.isPrepared?t.play():t.createVideo())}},t.videoContainer=r().createRef(),t.video=r().createRef(),t.mid="".concat(e.vid,"-").concat(e.src),t.isPlaying=!1,t.isCreated=!1,t.isPrepared=!1,t.isLoaded=!1,t.creating=!1,t}return u()(d,[{key:"componentDidMount",value:(c=g()(S().mark((function e(){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!C()){e.next=6;break}return(0,E.g)({op:"impr",page_el_sn:4780505}),e.next=4,this.createVideo();case 4:this.observeState(),this.addListener();case 6:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"componentWillReceiveProps",value:function(e){var t=this;e.index!==this.props.index&&setTimeout((function(){(0,I.Q6)("JSNativeVideo","update",{mid:t.mid,rect:t.getRect()})}),200)}},{key:"componentWillUnmount",value:function(){C()&&(this.removeApplicationPause&&this.removeApplicationPause(),this.remove())}},{key:"remove",value:function(){this.isCreated=!1,(0,I.Q6)("JSNativeVideo","remove",{mid:this.mid})}},{key:"show",value:function(){(0,I.Q6)("JSNativeVideo","show",{mid:this.mid})}},{key:"createVideo",value:(a=g()(S().mark((function e(){var t;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.creating){e.next=2;break}return e.abrupt("return");case 2:return this.creating=!0,t=this.playerParams(),e.prev=4,e.next=7,(0,I.Q6)("JSNativeVideo","create",t);case 7:return this.isCreated=!0,e.next=10,(0,I.Q6)("JSNativeVideo","prepare",{mid:this.mid});case 10:this.isPrepared=!0,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),e.t0.data&&"create duplicate"===e.t0.data.msg&&(this.show(),this.isCreated=!0);case 16:this.creating=!1;case 17:case"end":return e.stop()}}),e,this,[[4,13]])}))),function(){return a.apply(this,arguments)})},{key:"addListener",value:(o=g()(S().mark((function e(){var t=this;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.rB)("onApplicationPause",g()(S().mark((function e(){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getStatus();case 2:2!==e.sent&&t.pause();case 4:case"end":return e.stop()}}),e)}))));case 2:this.removeApplicationPause=e.sent;case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"fullScreen",value:(i=g()(S().mark((function e(){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isCreated){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,I.Q6)("JSNativeVideo","fullScreen",{mid:this.mid,fullScreenMode:1});case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"play",value:(n=g()(S().mark((function e(){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isPlaying=!0,!k()){e.next=4;break}return e.next=4,this.fullScreen();case 4:(0,I.Q6)("JSNativeVideo","play",{mid:this.mid});case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"pause",value:function(){this.isCreated&&(this.isPlaying=!1,(0,I.Q6)("JSNativeVideo","pause",{mid:this.mid}))}},{key:"getStatus",value:(t=g()(S().mark((function e(){var t;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isPrepared){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,(0,I.Q6)("JSNativeVideo","status",{mid:this.mid});case 5:if(!((t=e.sent)&&t.status>-1)){e.next=8;break}return e.abrupt("return",t.status);case 8:return e.abrupt("return",3);case 11:return e.prev=11,e.t0=e.catch(2),e.abrupt("return",3);case 14:case"end":return e.stop()}}),e,this,[[2,11]])}))),function(){return t.apply(this,arguments)})},{key:"getLimit",value:function(){return[0,0,0,0].join(",")}},{key:"getRect",value:function(){var e=(0,P.hZ)(this.videoContainer.current),t=(0,P.ys)(this.videoContainer.current),n=this.videoContainer.current.offsetWidth,i=this.videoContainer.current.offsetHeight;return"".concat(e,",").concat(t,",").concat(n,",").concat(i)}},{key:"playerParams",value:function(){var e=this.props,t=e.src,n=e.poster,i=e.showTimeline,r=void 0===i||i,o=(0,P.fM)(),a=(0,P.gp)(),s="".concat(o,",").concat(a),c=this.getLimit(),u=this.getRect(),l={muted:!1,showTimeline:r,volume:50,loop:!0,showControl:!1,poster:n,url:t,limit:c,fullScreenMode:1,showLoadingView:!1,isUseNewVideoPlayer:!0};return{mid:this.mid,rect:u,viewSize:s,props:l,limit:c,devicePixelRatio:window.devicePixelRatio,layer:"below_webview"}}},{key:"observeState",value:function(){var e=this;this.isCreated&&(0,I.Q6)("JSNativeVideo","observeState",{mid:this.mid,receiver:function(t,n){e.loadingState=n.loadingState,e.fullScreenState=n.fullScreenState,0===n.fullScreenState&&e.isPlaying&&e.pause()}})}},{key:"render",value:function(){var e=this.props,t=e.poster,n=e.containerClass,i=e.fullScreen,o="url(".concat(t,")");return r().createElement("div",{className:"pdd-video-wrap ".concat(n),onClick:this.handleClickPlay,ref:this.videoContainer},i&&r().createElement("div",{className:"poster-img",style:{backgroundImage:o}}),r().createElement("div",{className:"video-play-icon"}))}}]),d}(r().Component),U=n(67154),R=n.n(U),D=n(6479),N=n.n(D),O=(n(45697),n(63038)),M=n.n(O),F=n(30125),B=n(79859),T=n(66197);function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return m()(this,n)}}var _=function(e){f()(n,e);var t=V(n);function n(){var e;s()(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).videoRef=r().createRef(),e.isLite=!1,e}return u()(n,[{key:"componentDidMount",value:function(){this.isLite=(0,w.zT)().isLiteNativePlatform,(0,E.g)({op:"impr",lite:this.isLite?1:0,page_el_sn:4780505}),this.observeListener()}},{key:"componentWillUnmount",value:function(){this.unobserveListener()}},{key:"observeListener",value:function(){var e=this,t=this.videoRef.current;t.addEventListener("fullscreenchange",(function(t){e.stopAndClose(t)})),t.addEventListener("webkitfullscreenchange",(function(t){e.stopAndClose(t)}))}},{key:"unobserveListener",value:function(){var e=this,t=this.videoRef.current;t.removeEventListener("fullscreenchange",(function(t){e.stopAndClose(t)})),t.removeEventListener("webkitfullscreenchange",(function(t){e.stopAndClose(t)}))}},{key:"stopAndClose",value:function(){document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||this.videoRef.current.pause()}},{key:"videoSrc",get:function(){var e=this.props,t=e.src,n=e.needCompressSuffix,i=t.replace(/\.f\d+\.mp4/g,""),r=t.match(/\.f\d+\.mp4/)||[],o=M()(r,1)[0];return n?i+(void 0===o?".f30.mp4":o):i}},{key:"fullScreenPlay",value:function(){this.play()}},{key:"play",value:function(){if((0,E.g)({op:"click",lite:this.isLite?1:0,page_el_sn:4780505}),(0,B.aX)()||this.isLite)(0,T.Z)("当前版本过低，暂不支持播放，请升级至最新版本进行播放");else{var e=this.videoRef.current;e.play(),(0,F._)(100).then((function(){e.requestFullScreen?e.requestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.mozRequestFullScreen&&e.mozRequestFullScreen()}))}}},{key:"render",value:function(){var e=this.props.fullScreen;return r().createElement("div",{className:"".concat(e&&"pdd-video-hide")},r().createElement("video",{onClick:function(e){e.stopPropagation()},loop:"loop",controls:"controls",controlsList:"nodownload",src:this.videoSrc,ref:this.videoRef,className:"pdd-video-item","x5-video-player-type":"h5","x5-video-player-fullscreen":"true"},"您的浏览器可能不支持视频播放"))}}]),n}(r().Component);_.defaultProps={trackParams:{},needCompressSuffix:!0};var Q=["poster","containerClass","fullScreen"];function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return m()(this,n)}}var W=function(e){f()(n,e);var t=G(n);function n(){var e;s()(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).videoRef=r().createRef(),e.playVideo=function(t){t&&t.stopPropagation(),e.videoRef.current.fullScreenPlay(t)},e}return u()(n,[{key:"render",value:function(){var e=this.props,t=e.poster,n=e.containerClass,i=e.fullScreen,o=N()(e,Q);return r().createElement("div",{className:"pdd-video-wrap ".concat(n),onClick:this.playVideo},i&&r().createElement("div",{className:"poster-img",style:{backgroundImage:"url(".concat(t,")")}}),r().createElement(_,R()({ref:this.videoRef,poster:t,fullScreen:i},o)),r().createElement("div",{className:"video-play-icon"}))}}]),n}(r().Component);function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return m()(this,n)}}var Z=function(e){f()(n,e);var t=j(n);function n(){var e;s()(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isAppVideo:!0},e}return u()(n,[{key:"componentDidMount",value:function(){this.setState({isAppVideo:C()})}},{key:"render",value:function(){var e=this.state.isAppVideo?x:W;return r().createElement(e,this.props)}}]),n}(r().Component),J=Z,z=function(e){var t=e.vid,n=e.videoInfoList,i=e.onCloseClick,a=e.isShowCloseBtn,s=void 0===a||a,c=e.needCompressSuffix,u=void 0===c||c;return n.map((function(e,n){return r().createElement("div",{key:e.key||n,className:"ium-image-block ium-cube"},e.serverUrl&&r().createElement(J,{index:n,vid:t||e.key||"vid-".concat(n),containerClass:"video-box",src:e.serverUrl,poster:e.videoCoverUrl||e.videoCoverImage,fullScreen:!0,needCompressSuffix:u}),e.status!==o.A.UPLOADED&&r().createElement("div",{className:"ium-tip-block"},"上传中"),s&&r().createElement("div",{className:"ium-delete icon icon-close",onClick:i.bind(null,e)}))}))}},32028:function(e,t,n){n.d(t,{Z:function(){return Z}});var i=n(319),r=n.n(i),o=n(48926),a=n.n(o),s=n(59713),c=n.n(s),u=n(34575),l=n.n(u),f=n(93913),d=n.n(f),m=n(81506),p=n.n(m),h=n(2205),v=n.n(h),g=n(78585),y=n.n(g),S=n(16525),A=n.n(S),I=n(29754),w=n.n(I),b=n(23560),k=n.n(b),C=n(87757),P=n.n(C),E=n(67294),L=n.n(E),x=n(45697),U=n.n(x),R=n(66197),D=n(45976),N=n(99433),O=n(79859),M=n(9584),F=n(35226),B=n(29807),T=n.n(B),V=n(36786),_=function(){function e(t){var n=this;l()(this,e),this.seed=1,this.videoList=[],this.createVideo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.videoPath,i=e.videoCoverImage,r=e.serverUrl,o=e.videoCoverUrl,a=new V.Z({key:"video-".concat(n.seed++),videoPath:t,videoCoverImage:i,serverUrl:r,videoCoverUrl:o});return r&&a.updateStatus(V.A.UPLOADED),n.videoList.push(a),n.onVideoUpdate(),a},this.createAndUploadVideo=function(){var e=a()(P().mark((function e(t){var i,r,o,a;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.videoPath,r=t.videoCoverImage,(o=n.createVideo({videoPath:i,videoCoverImage:r})).updateStatus(V.A.UPLOADING),n.onVideoUpdate(),a={},e.prev=5,e.next=8,n.uploadVideo(i);case 8:a=e.sent,e.next=13;break;case 11:e.prev=11,e.t0=e.catch(5);case 13:return a.serverUrl?(o.serverUrl=a.serverUrl,o.videoCoverUrl=a.videoCoverUrl,o.updateStatus(V.A.UPLOADED)):o.updateStatus(V.A.UPLOAD_FAIL),n.onVideoUpdate(),e.abrupt("return",a);case 16:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(t){return e.apply(this,arguments)}}(),this.onVideoUpdate=function(){n.onVideoListUpdate(n.videoList)},this.isAllVideoUploaded=function(){return!n.videoList.find((function(e){return e.status!==V.A.UPLOADED}))},this.clearList=function(){n.videoList=[]},this.uploadVideo=function(e){return new Promise((function(t,n){T().callNative("JSMedia","videoUpload",{video_url:e,biz_name:"mobile-aftersale",cover_image_bucket:"review_image",need_compress:!0},(function(e){e&&!e.error_code&&e.server_url?t({serverUrl:e.server_url||"",videoCoverUrl:e.cover_url||""}):n({errorCode:e&&e.error_code,data:e})}),n)}))},this.onVideoListUpdate=t.onVideoListUpdate}return d()(e,[{key:"removeVideo",value:function(e){this.videoList=this.videoList.filter((function(t){return t.key!==e.key})),this.onVideoUpdate()}}]),e}();function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var r=w()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return y()(this,n)}}var j=(0,O.eF)(),Z=function(e){v()(n,e);var t=W(n);function n(e){var i,r,o;return l()(this,n),(o=t.call(this,e)).state=G(G({},o.state),{},{imageInfoList:o.props.initImageInfoList||[],videoInfoList:[]}),o.selectMedia=function(){k()(o.props.onClickUpload)&&o.props.onClickUpload(),o.state.useWeixinJsBridge?o.selectImageInWxMiniProgram():o.isNativePlatform&&o.onSelectNativeImage()},o.onNativeSelectStart=function(){o.hideNativeSelector()},o.onNativeSelected=function(){var e=a()(P().mark((function e(t){var n,i,r;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.images,i=t.videoPath,r=t.videoCoverImage,n.length>0&&(n||[]).forEach((function(e){o.core.nativeReceiver.onSelectStart(),o.core.nativeReceiver.onSelected(e)})),i&&o.videoUploader.createAndUploadVideo({videoPath:i,videoCoverImage:r});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o.hideNativeSelector=function(){o.setState({showSelector:!1})},o.updateVideoList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.filter((function(e){return[V.A.UPLOAD_FAIL,V.A.UPLOAD_CANCEL].includes(e.status)}));t.length>0?t.forEach((function(e){e.status===V.A.UPLOAD_FAIL&&(0,R.Z)("上传视频失败，请稍后重试"),o.videoUploader.removeVideo(e)})):(o.setState({videoInfoList:e}),k()(o.props.onVideoUploaded)&&o.props.onVideoUploaded(e))},o.deleteVideo=function(e,t){t&&t.preventDefault(),t&&t.stopPropagation(),o.videoUploader.removeVideo(e)},o.onUploadSuccess=function(e){A()((i=p()(o),w()(n.prototype)),"onUploadSuccess",i).call(i,e),k()(o.props.onUploadSuccess)&&o.props.onUploadSuccess(e)},o.removeImage=function(e){A()((r=p()(o),w()(n.prototype)),"removeImage",r).call(r,e),k()(o.props.onRemoveImage)&&o.props.onRemoveImage(e)},o.isAllVideoUploaded=function(){return o.videoUploader.isAllVideoUploaded()},o.isAllImageUploaded=function(){return o.isAllImageReady()},o.isAllMediaUploaded=function(){return o.isAllVideoUploaded()&&o.isAllImageUploaded()},o.videoUploader=new _({onVideoListUpdate:o.updateVideoList}),o}return d()(n,[{key:"render",value:function(){var e=this.props.uploadRemindChar,t=this.state,n=t.videoInfoList,i=t.imageInfoList,o=t.useWeixinJsBridge,a=[].concat(r()(n),r()(i)),s=this.maximum,c=a.length>=s?{display:"none"}:{};return L().createElement("div",{id:this.viewID,className:"image-uploader-module"},L().createElement(M.Z,{videoInfoList:n,onCloseClick:this.deleteVideo,needCompressSuffix:!1}),this.renderCubes(i),L().createElement("div",{id:"".concat(this.viewID,"-selector"),className:"ium-selector ium-cube ium-cube-last-in-line",style:c,onClick:this.selectMedia},L().createElement("div",{id:"".concat(this.viewID,"-indicator"),className:"ium-indicator"},L().createElement("div",{className:"ium-indicator-icon icon icon-evaluation-camera"}),0===a.length&&L().createElement("div",{className:"ium-indicator-text"},e),a.length>0&&L().createElement("div",{className:"ium-indicator-text"},a.length,L().createElement("i",null,"/"),s)),!this.isNativePlatform&&!o&&L().createElement("input",{id:"".concat(this.viewID,"-input"),accept:"image/*",type:"file",defaultValue:""})),this.renderNativeSelector(s-a.length))}},{key:"renderNativeSelector",value:function(e){var t=this.props,n=t.mediaSelectorOptions,i=t.imageSelectorOption,r=t.videoSelectorOption,o=t.gallerySelectorOption;return this.canSelectVideo?L().createElement(F.Z,{isShow:this.state.showSelector,viewID:"".concat(this.viewID,"-native-selector"),viewCtx:this.viewCtx,maxMediaCount:e,options:n,imageParam:i,videoParam:r,albumParam:o,onSelectStart:this.onNativeSelectStart,onSelected:this.onNativeSelected,onSelectCancel:this.onNativeSelectCancel,hideSelector:this.hideNativeSelector}):this.renderImageSelector(e)}},{key:"componentWillMount",value:function(){var e=this;A()(w()(n.prototype),"componentWillMount",this).call(this),this.props.initVideoInfoList.filter((function(e){return e.serverUrl})).map((function(t){return e.videoUploader.createVideo(t)})),this.isClientEnv&&(this.canSelectVideo=!0===this.props.canSelectVideo&&this.isNativePlatform&&!(j.platform===N.iw.PddIOS&&(0,N.yC)(j.version,"4.46.0")<0)&&!(j.platform===N.iw.PddAndroid&&((0,N.yC)(j.version,"4.53.0")<0||(0,N.yC)(j.systemVersion,"5.0.0")<0))&&!navigator.userAgent.includes("app_type/lite"))}}]),n}(D.Z);Z.defaultProps={canSelectVideo:!0,uploadRemindChar:"上传",initImageInfoList:[],initVideoInfoList:[],uploadClickLogger:function(e){return e}},Z.propTypes={mediaSelectorOptions:U().arrayOf(U().object),imageSelectorOption:U().object,videoSelectorOption:U().object,gallerySelectorOption:U().object,initImageInfoList:U().array,initVideoInfoList:U().array,uploadClickLogger:U().func}},45976:function(e,t,n){n.d(t,{Z:function(){return fe}});var i=n(48926),r=n.n(i),o=n(34575),a=n.n(o),s=n(93913),c=n.n(s),u=n(16525),l=n.n(u),f=n(2205),d=n.n(f),m=n(78585),p=n.n(m),h=n(29754),v=n.n(h),g=n(87757),y=n.n(g),S=n(67294),A=n.n(S),I=n(31783),w=n(9164),b=n(80558),k=n(99433),C=n(36792),P=n(66197);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v()(e);if(t){var r=v()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return p()(this,n)}}n(17964);var L="data:image/jpeg;base64,",x=1,U=2,R=function(e){d()(n,e);var t=E(n);function n(e){var i;return a()(this,n),(i=t.call(this,e)).state={show:!1,isUp:!1},i.animating=!1,i}return c()(n,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.isClientEnv&&!this.animating&&(e.show&&!this.props.show?(this.animating=!0,this.setState({show:!0},(function(){window.setTimeout((function(){t.setState({isUp:!0}),t.animating=!1}),100)}))):!e.show&&this.props.show&&(this.animating=!0,this.setState({isUp:!1}),window.setTimeout((function(){t.setState({show:!1}),t.animating=!1}),100)))}},{key:"render",value:function(){var e=this;return A().createElement("div",{id:this.viewID,style:{display:this.state.show?"":"none"},className:"base-image-selector"},A().createElement("div",{className:this.state.isUp?"bis-select-image-slide-up bis-select-image":"bis-select-image"},A().createElement("div",{className:"bis-select-image-type"},A().createElement("p",{id:"".concat(this.viewID,"-camera"),className:"bis-from-camera",onClick:function(){e.selectImageFromCamera()}},"拍照"),A().createElement("p",{id:"".concat(this.viewID,"-album"),className:"bis-from-album",onClick:function(){e.selectImageFromAlbum()}},"从相册选择")),A().createElement("div",{id:"".concat(this.viewID,"-cancel"),className:"bis-select-cancel",onClick:function(){e.hide()}},"取消")),A().createElement("div",{className:"bis-select-image-mask",onClick:function(){e.hide()}}))}},{key:"hide",value:function(){this.props.onClose&&this.props.onClose()}},{key:"selectImageFromCamera",value:function(){this.selectImage(x),this.hide()}},{key:"selectImageFromAlbum",value:function(){this.selectImage(U),this.hide()}},{key:"selectImage",value:function(e){var t=this,n={source:e},i=this.platform.platform===k.iw.PddIOS,r=i?"4.79.0":"4.85.0",o=(0,k.yC)(this.platform.version,r)>=0;i&&this.props.option&&(n.option=this.props.option),o&&(n.max_images_count=this.props.maxImageCount);var a=o?"getV2":"get";(0,C.Q6)("JSPhoto",a,n).then((function(e){if((e=e||{}).image_data){var n=e.image_data,i="".concat(L).concat(n);return t.props.onSelectStart&&t.props.onSelectStart(),void(t.props.onSelected&&t.props.onSelected(i))}if(e.image_list){if(!e.image_list.length)return t.props.onSelectFail&&t.props.onSelectFail();e.image_list.reduce((function(e,n){return e.then((function(){return t.props.onSelectStart&&t.props.onSelectStart(),t.props.onSelected&&t.props.onSelected("".concat(L).concat(n))}))}),Promise.resolve())}})).catch((function(){t.props.onSelectCancel&&t.props.onSelectCancel()}))}}]),n}(b.Z);R.defaultProps={onSelected:null,onSelectStart:null,onSelectCancel:null,onSelectFail:function(){return(0,P.Z)("图片上传失败")},onClose:null,option:null};var D=R,N=n(5815),O=n(97792),M=n(86951),F=n(11191),B=n(63038),T=n.n(B),V=n(67674),_=n(65077),Q=n(24684),G=n(26242),W=n(59385),j=n(72876),Z=n(38533),J="gR7GvOK9",z="_0t3vde8G",H="BoNl80w0",X="_5DOARM9K",q="mOSWqvE7",K="MOOsVdoK",Y="Gd8Inc3b",$=1,ee=2,te="data:image/jpeg;base64,",ne=(0,Z.zT)(),ie=(0,V.Pi)((function(e){var t=e.onClose,n=e.image,i=e.option,r=e.maxImageCount,o=e.onSelectStart,a=e.onSelectFail,s=e.onSelectCancel,c=e.onSelected,u=e.onSelectImage,l=e.inputId,f=(0,S.useState)(!1),d=T()(f,2),m=d[0],p=d[1],h=(0,S.useRef)(null);(0,S.useEffect)((function(){setTimeout((function(){return p(!0)}),0),h.current&&(0,_.XY)(h.current)}));var v=ne.isNativePlatform,g=function(e){var t={source:e},n=ne.platform===k.iw.PddIOS,u=n?"4.79.0":"4.85.0",l=(0,k.yC)(ne.version,u)>=0;n&&i&&(t.option=i),l&&(t.max_images_count=r);var f=l?"getV2":"get";(0,C.Q6)("JSPhoto",f,t).then((function(e){if((e=e||{}).image_data){var t=e.image_data,n="".concat(te).concat(t);return o&&o(),void(c&&c(n))}if(e.image_list){if(!e.image_list.length)return a&&a();e.image_list.reduce((function(e,t){return e.then((function(){return o&&o(),c&&c("".concat(te).concat(t))}))}),Promise.resolve())}})).catch((function(){s&&s()}))};return A().createElement(j.Z,{disableScroll:!0,contentCls:J,show:m,closePop:t,title:"请参考示例图上传凭证"},A().createElement("div",{ref:h,className:z},A().createElement(W.Z,{className:H,src:n})),A().createElement("div",{className:X},v?A().createElement(A().Fragment,null,A().createElement(Q.Z,{trackingInfo:{page_el_sn:6857791}},A().createElement("div",{className:q,onClick:function(){(0,G.g)({op:"click",page_el_sn:6857791}),g(ee)}},"从相册选择")),A().createElement("div",{className:K,onClick:function(){(0,G.g)({op:"click",page_el_sn:6857792}),g($)}},"拍照")):A().createElement("div",{className:Y,onClick:function(){var e=document.getElementById(l);e?e.click():u&&u()}},"上传凭证")))})),re=(0,S.memo)(ie);function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v()(e);if(t){var r=v()(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return p()(this,n)}}var ae="请选择jpeg、png格式的图片",se="请检查网络，稍候重试",ce="图片上传失败",ue={},le=function(e){d()(n,e);var t=oe(n);function n(e){var i;return a()(this,n),(i=t.call(this,e)).onSelectImage=function(){var e=i.props,t=e.demoImageList;if(e.needProof&&null!=t&&t.length){if(!i.state.showProofPop)return void i.setState({showProofPop:!0});i.setState({showProofPop:!1})}i.state.useWeixinJsBridge?i.selectImageInWxMiniProgram():i.onSelectNativeImage()},i.state=i.state||{},i.state.imageInfoList=Array.isArray(e.imageInfoList)?e.imageInfoList:[],i.state.uploadProgressMap={},i.state.showSelector=!1,i.state.useWeixinJsBridge=!1,i.state.showProofPop=!1,i.core=null,i.maximum=parseInt(e.maximum||5,10),i.imageSelectorOption=i.props.imageSelectorOption||"",i.imageTargetSize=e.imageTargetSize||300,i.imageLimitSize=e.imageLimitSize||null,i.bucketTag=e.bucketTag||null,i.disabled=!1,i.onInputChange=null,i}return c()(n,[{key:"initImageInfoList",value:function(){var e=[],t={},n=this.state.imageInfoList;return n.forEach((function(n,i){var r="img-".concat(i+1);e.push(r),n.key=r,t[r]=n})),{keyList:e,imageMap:t,seed:n.length+1,useXHR:!!this.props.enableUploadProgress}}},{key:"componentWillMount",value:function(){if(l()(v()(n.prototype),"componentWillMount",this).call(this),this.isClientEnv){var e=this.platform,t=e.isNativePlatform,i=e.isWeChatMiniProgram,r=e.version;this.isNativePlatform=t,this.isWeChatMiniProgram=i,this.isPhotoDisabled=this.isNativePlatform&&this.platform.statisfy(["1.2.6","1.2.7","1.2.8"],"","contains");var o=r;this.isNativePlatform&&o.length>0&&(0,k.yC)(o,"1.1.2")>0&&(this.canSelectInNative=!0);var a=this.initImageInfoList();this.core=new N.Z(a)}}},{key:"componentDidMount",value:function(){l()(v()(n.prototype),"componentDidMount",this).call(this),this.core.load({bucketTag:this.bucketTag,context:this,callbackMap:{onLoad:this.onImageLoad,onEncode:this.onImageEncode,onUpload:this.onImageUpload,onUploadProgress:this.onUploadProgress.bind(this),onSuccess:this.onUploadSuccess,onFail:this.onUploadFail},fileHttpsTester:this.props.fileHttps,useXHR:this.props.enableUploadProgress}),this.isWeChatMiniProgram?this.setState({useWeixinJsBridge:!0}):this.resetInput(),this.props.autoImageUploader&&this.onSelectImage()}},{key:"componentDidUpdate",value:function(e,t){t.useWeixinJsBridge&&!this.state.useWeixinJsBridge&&this.resetInput()}},{key:"render",value:function(){var e=this,t=this.state,n=t.imageInfoList,i=void 0===n?[]:n,r=t.useWeixinJsBridge,o=this.props.needProof,a=this.maximum,s=i.length>=a?{display:"none"}:{};return A().createElement("div",{id:this.viewID,className:"image-uploader-module"},this.renderCubes(i),A().createElement("div",{id:"".concat(this.viewID,"-selector"),onClick:function(t){e.onSelectImage()},className:"ium-selector ium-cube ium-cube-last-in-line ".concat(o?"input-hide":""),style:s},A().createElement("div",{id:"".concat(this.viewID,"-indicator"),className:"ium-indicator"},A().createElement("div",{className:"ium-indicator-icon icon icon-evaluation-camera"}),0===i.length&&A().createElement("div",{className:"ium-indicator-text"},this.props.indicatorText?this.props.indicatorText:"上传图片"),i.length>0&&A().createElement("div",{className:"ium-indicator-text"},i.length,A().createElement("i",null,"/"),a)),!this.isNativePlatform&&!r&&A().createElement("input",{onClick:function(e){return e.stopPropagation()},id:"".concat(this.viewID,"-input"),accept:"image/*",type:"file",defaultValue:""})),this.renderImageSelector(a-i.length),this.renderProofPop())}},{key:"renderProofPop",value:function(){var e=this,t=this.props,n=t.demoImageList;if(!t.needProof||!this.state.showProofPop)return null;var i=this.core.nativeReceiver,r=this.state.imageInfoList,o=void 0===r?[]:r;return A().createElement(re,{inputId:"".concat(this.viewID,"-input"),image:n[0],onClose:function(){e.setState({showProofPop:!1})},onSelectImage:this.onSelectImage,option:this.imageSelectorOption,maxImageCount:this.maximum-o.length,onSelected:function(t){return e.setState({showProofPop:!1}),i.onSelected(t)},onSelectStart:function(){i.onSelectStart()},onSelectCancel:function(){i.onSelectCancel()}})}},{key:"renderCubes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this.state.uploadProgressMap,i=this.props.enableUploadProgress;return t.map((function(t,r){return t=t||{},A().createElement("div",{key:r,className:"ium-image-block ium-cube",onClick:function(){e.viewImageList(t)}},!!t.url&&e.renderImgCube(t),!!(i&&t.status<5)&&A().createElement("div",{className:"ium-progress-block"},A().createElement("div",{style:{width:"".concat(n[t.url],"%")}})),!i&&5!==t.status&&A().createElement("div",{className:"ium-tip-block"},"上传中"),A().createElement("div",{className:"ium-delete icon icon-close",onClick:function(n){e.deleteInfo(t,n)}}))}))}},{key:"renderImgCube",value:function(e){var t=this.getRotationDegree(e.exifOrientation);return this.platform.platform===k.iw.PddAndroid||this.isWeChatMiniProgram?A().createElement(w.Z,{src:e.url,style:{WebkitTransform:"rotate(".concat(t,"deg)"),transform:"rotate(".concat(t,"deg)")}}):A().createElement("div",{className:"image-box",style:{backgroundImage:"url(".concat(e.url,")"),backgroundSize:"cover",backgroundPosition:"center",WebkitTransform:"rotate(".concat(t,"deg)"),transform:"rotate(".concat(t,"deg)")}})}},{key:"onSelectNativeImage",value:function(){this.disabled||(this.isPhotoDisabled?alert("请升级软件"):this.selectImageInNative())}},{key:"deleteInfo",value:function(e,t){(t=t||event)&&t.preventDefault(),t&&t.stopPropagation(),this.disabled||this.removeImage(e)}},{key:"viewImageList",value:function(e,t){if((t=t||event)&&t.preventDefault(),t&&t.stopPropagation(),!this.disabled){var n=this.getImageWebURLs()||[];if(n.length>0){var i=(e=e||{}).webURL;i&&(0,I.m)(i||n[0],n,{ViewNotWechatInteraface:this.isNativePlatform})}}}},{key:"getImages",value:function(){return this.core.getImages()}},{key:"getImageCount",value:function(){return this.core.keyList.length}},{key:"getImageWebURLs",value:function(){return this.core.getImageProperties("webURL","")}},{key:"getImageWebInfo",value:function(){return this.core.getImageProperties({url:"webURL",height:"height",width:"width"})}},{key:"isAllImageReady",value:function(){return this.core.isAllImageReady()}},{key:"waitForAll",value:function(e){this.core.waitForAll(e)}},{key:"resetInput",value:function(){var e=this,t=document.getElementById("".concat(this.viewID,"-input"));t&&(t.outerHTML=t.outerHTML.replace(/(value=\").+\"/i,'$1"'),t=document.getElementById("".concat(this.viewID,"-input")),this.isNativePlatform||(this.onInputChange&&(t.removeEventListener("change",this.onInputChange),this.onInputChange=null),this.onInputChange=function(){var n=r()(y().mark((function n(i){var r;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.disabled){n.next=2;break}return n.abrupt("return");case 2:if(t.files&&t.files[0]){n.next=4;break}return n.abrupt("return");case 4:return n.next=6,e.core.loadImageByFile(t.files[0]);case 6:(r=n.sent)?(e.core.process(r),e.resetInput()):(0,P.Z)(ae);case 8:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),t.addEventListener("change",this.onInputChange)))}},{key:"onImageLoad",value:function(e){ue[e.url]?ue[e.url]=void 0:this.setState({imageInfoList:this.state.imageInfoList.concat([e])})}},{key:"onImageEncode",value:function(e){}},{key:"onImageUpload",value:function(e){}},{key:"onUploadSuccess",value:function(e){this.updateImage(e)}},{key:"onUploadFail",value:function(e,t){var n=this,i="";i=!(t=t||{}).errorCode||t instanceof ProgressEvent?se:(0,O.fY)(t.errorCode)||ce,(0,P.Z)(i),ue[e.url]=!0,setTimeout((function(){n.removeImage(e)}),200),(0,M.OO)(new F.Z(90001,e.url),{message:JSON.stringify(t),code:t.errorCode})}},{key:"removeImage",value:function(e){for(var t=this,n=this.state.imageInfoList||[],i=0,r=n.length;i<r;i++)if(n[i].key===e.key)return n.splice(i,1),void this.setState({imageInfoList:n},(function(){t.core.remove(e)}))}},{key:"updateImage",value:function(e){for(var t=this.state.imageInfoList||[],n=0,i=t.length;n<i;n++)if(t[n].key===e.key)return t[n].status=e.status,t[n].webURL=e.webURL,t[n].exifOrientation=e.exifOrientation,void this.setState({imageInfoList:t})}},{key:"disable",value:function(){this.disable=!0}},{key:"enable",value:function(){this.disabled=!1}},{key:"renderImageSelector",value:function(e){var t=this;if(this.canSelectInNative){var n=this.core.nativeReceiver;return A().createElement(D,{viewID:"".concat(this.viewID,"-native-selector"),viewCtx:this.viewCtx,option:this.imageSelectorOption,show:this.state.showSelector,maxImageCount:e,onSelected:function(e){return n.onSelected(e)},onSelectStart:function(){n.onSelectStart()},onSelectCancel:function(){n.onSelectCancel()},onClose:function(){t.setState({showSelector:!1})}})}return!1}},{key:"selectImageInNative",value:function(){this.setState({showSelector:!0})}},{key:"onWxAppUploadFail",value:function(e){this.setState({useWeixinJsBridge:!1})}},{key:"selectImageInWxMiniProgram",value:function(){var e=this,t=this.state.imageInfoList,n=void 0===t?[]:t,i=this.core.nativeReceiver;window.wx&&window.wx.chooseImage({count:this.maximum-n.length,success:function(t){(t.localIds||[]).reduce((function(t,n){return t.then((function(){return i.onSelectStart(),e.getWxMiniProgramImageData(n).then((function(e){return i.onSelected(e)})).catch((function(t){i.onSelectCancel(),e.onWxAppUploadFail(t)}))}))}),Promise.resolve())},fail:function(t){e.onWxAppUploadFail(t)}})}},{key:"getWxMiniProgramImageData",value:function(e){return new Promise((function(t,n){window.wx&&window.wx.getLocalImgData({localId:e,success:function(e){var n=e.localData;/^\s*data:image/.test(n)||(n="data:image/jpeg;base64,".concat(n)),n=n.replace("image/jpg","image/jpeg"),t(n)},fail:function(e){n(e)}})}))}},{key:"getRotationDegree",value:function(e){var t=0;switch(e){case 6:t=90;break;case 8:t=-90;break;case 3:t=180}return t}},{key:"onUploadProgress",value:function(e,t){var n=this.state.uploadProgressMap;n[e]=100*t.loaded/t.total,this.setState({uploadProgressMap:n})}}]),n}(b.Z),fe=le},72876:function(e,t,n){n.d(t,{Z:function(){return b}});var i=n(59713),r=n.n(i),o=n(63038),a=n.n(o),s=n(67294),c=n.n(s),u=n(94184),l=n.n(u),f=n(24684),d=n(65077),m=n(99433),p=n(79859),h="VUohPrkc",v="biqWChg9",g="lDbPSgIz",y="yZOmurwT",S="_379qwrmu",A="_43Zu-x3C",I=(0,p.eF)(),w=function(e){var t,n=e.show,i=e.children,o=e.closePop,u=e.contentCls,p=e.metricInfo,w=e.fixInput,b=e.disableScroll,k=e.title,C=e.noTransform,P=e.noClose,E=(0,s.useState)({}),L=a()(E,2),x=L[0],U=L[1],R=(0,s.useRef)(null);(0,s.useEffect)((function(){if(w&&I.system===m.we.Android){var e=document.body.clientHeight;window.addEventListener("resize",(function(){var t=e-document.body.clientHeight;U(t>0?{bottom:"-".concat(t-100,"px")}:{})}))}if(b&&R.current)return(0,d.XY)(R.current),function(){return(0,d.K9)()}}),[]);return c().createElement(c().Fragment,null,function(){if(n){var e=c().createElement("div",{className:h,onClick:o});return p?c().createElement(f.Z,{trackingInfo:p},e):e}return null}(),c().createElement("div",{ref:R,className:l()(v,u,(t={},r()(t,g,!n),r()(t,y,!C),t)),style:x},!P&&c().createElement("div",{className:S,onClick:o}),k&&c().createElement("div",{className:A},k),i))};w.defaultProps={contentCls:"",metricInfo:null,fixInput:!1,disableScroll:!1,title:"",noTransform:!1,noClose:!1};var b=c().memo(w)},17964:function(e,t,n){n.r(t);var i=n(93379),r=n.n(i),o=n(83039),a={insert:"head",singleton:!1};r()(o.Z,a);t.default=o.Z.locals||{}},83039:function(e,t,n){var i=n(23645),r=n.n(i)()((function(e){return e[1]}));r.push([e.id,".base-image-selector .bis-select-image{background:transparent;bottom:0;color:#0079ff;font-size:.18rem;left:0;max-width:3.75rem;padding:.1rem;position:fixed;transform:translateY(200%);-webkit-transform:translateY(200%);transition:-webkit-transform .3s ease-out;transition:transform .3s ease-out;transition:transform .3s ease-out, -webkit-transform .3s ease-out;-webkit-transition:-webkit-transform .3s ease-out;width:100%;z-index:100002}.base-image-selector .bis-select-image-type{background-color:#fff;border-radius:.03rem;-webkit-border-radius:.03rem;text-align:center;width:100%}.base-image-selector .bis-select-image-type p{padding:.1rem 0}.base-image-selector .bis-select-cancel{background-color:#fff;border-radius:.03rem;-webkit-border-radius:.03rem;margin-top:.1rem;padding:.1rem 0;text-align:center;width:100%}.base-image-selector .bis-select-cancel:active{background-color:#dfdfdf;border-radius:.03rem;-webkit-border-radius:.03rem}.base-image-selector .bis-select-image-mask{background-color:#000;bottom:50%;filter:alpha(opacity=50);height:400%;left:0;opacity:.5;position:fixed;-webkit-transform:translateY(50%);transform:translateY(50%);transition:background .3s ease-out;-webkit-transition:background .3s ease-out;width:100%;z-index:100001}.base-image-selector .bis-select-image-slide-up{transform:translate(0);-webkit-transform:translate(0)}.base-image-selector .bis-from-camera{border-bottom:1px solid #dfdfdf}.base-image-selector .bis-from-camera:active{background-color:#dfdfdf;border-top-left-radius:.03rem;-webkit-border-top-left-radius:.03rem;border-top-right-radius:.03rem;-webkit-border-top-right-radius:.03rem}.base-image-selector .bis-from-album:active{-webkit-bottom-top-left-radius:.03rem;-webkit-bottom-top-right-radius:.03rem;background-color:#dfdfdf;border-bottom-left-radius:.03rem;border-bottom-right-radius:.03rem}",""]),t.Z=r}}]);
//# sourceMappingURL=http://vgunxpkt.com/sourcemaps/mobile-aftersale/js/loadable_ComplaintMediaUploader_75dd87205a18117e7708.js.map