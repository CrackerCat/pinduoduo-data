"use strict";(self.webpackChunkmobile_fun_cashback=self.webpackChunkmobile_fun_cashback||[]).push([[5911],{19306:function(e,t,r){r.r(t),r.d(t,{default:function(){return ht}});var n=r(58701),a=r(68340),i=r(84195),o=r(60112),s=r(73897),u=function(e){return(0,n.getCurrentPlatform)().version},c=60006;function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=u();return(0,n.getCurrentPlatform)().platform===a.iw.PddIOS&&(0,a.yC)(r,e)>=0||(0,n.getCurrentPlatform)().platform===a.iw.PddAndroid&&(0,a.yC)(r,t)>=0||(0,n.getCurrentPlatform)().platform===a.iw.PDDTinyAndorid}var p=function(){var e=u();return(0,n.getCurrentPlatform)().platform===a.iw.PddIOS&&(0,a.yC)(e,"5.80.0")>=0},l=function(){return h("4.74.0","4.74.0","4.80.0")},f=function(){return h("4.85.0","4.85.0")},_=function(){return(0,n.getCurrentPlatform)().platform!==a.iw.PDDTinyAndorid&&h("4.88.0","4.88.0")},S=function(){return h("5.41.0","5.41.0")},y="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAMAAADUivDaAAAAM1BMVEUAAABmZmZmZmZlZWVmZmZmZmZlZWVlZWVoaGhlZWVkZGRmZmZlZWVlZWVlZWVmZmZmZmauFdI/AAAAEHRSTlMAhnjzbtHHEBrfJrGXRzZXUNTSwgAAAPRJREFUWMPt1+sKgzAMBWC71NbLLuf9n3a6sxFYN2vq/gxyEBSFz9pGaLpdOYucuyPJCUtSbheGHo/0Q6swjXhmnNqEqwCYHwfk2iJcFkEuJyDwyi7c+O6V4HhuViFyBkhwVqJNCFwHEq+1CTaB1UCCFWI0BJiXkxJLZkAso2BVK8FaD509SjB/QcQkWBO2iYA1kuLHn5KRbQKvFL8vhT2jUKOs55j3z0WORcUnvVEj9EF6/8JsIzKAd8K6qE444cTviNNBYhrHqZnQOOGEE0444USdyDYhA1Lsfs1dRqrtwTXVPTjTw5y+6EfMwvCtK6pHu6I7B+8m1re+k3UAAAAASUVORK5CYII=",E=r(69870),m=r(1906),d=r(7680),v=r(54466),O=r(82851),I=r(84100),g=r(93556),A=r(43834),T=r(44293),b=r(81666),C="api/flow/audience/share/types";var R=r(32393),P=r(82236),Z=r(80322);function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var N=E.Z.ShareErrorCode,L=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._inited=!1,this._queryShareTypePromise=null,this._rules=null,this._enableShareTypes=[],this.appOptional=null,this._rom=0,this._matchedPkgId=void 0,this._isCipherDowngrade=!1,this._enableSilentMode=!1}var t,r,a;return t=e,r=[{key:"build",value:function(){var e=this;return this._inited?Promise.resolve():(this._queryShareTypePromise||(this._queryShareTypePromise=this.loadRules(),this._queryShareTypePromise.then((function(t){return e._inited=!0,e._processRules(t),R.Z.getInstance().build({magicTrace:t.magic_trace})})).catch((function(t){(0,P.Z)({errorCode:0,message:"分享规则初始化失败",options:{message:t&&t.message,errorCode:t&&t.errorCode}}),e._inited=!0}))),this._queryShareTypePromise)}},{key:"reset",value:function(){this._inited=!1,this._queryShareTypePromise=null,this._rules=null,this._enableShareTypes=[],this.appOptional=null,this._rom=0,this._matchedPkgId=void 0,this._isCipherDowngrade=!1,this._enableSilentMode=!1}},{key:"getAppOptional",value:function(){return this.appOptional}},{key:"getRules",value:function(){var e=this;return this.build().then((function(){return e._rules}),(function(){return Promise.resolve(e._rules)}))}},{key:"loadRules",value:function(){return(0,n.getCurrentPlatform)().isNativePlatform?(0,i.Q6)("JSShare","queryShareTypes",{page_sn:(0,T.kd)()+"",page_info:{page_name:(0,T.j0)(),page_url:location&&location.href}}):function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,b.e)({pageInfo:{pageId:(0,T.e6)()}},{defaultErrorHandler:function(e){}}),n={};return n.page_sn=t.pageSn||"",n.page_info=t.pageInfo||{},n.platform="h5","post"===e.toLowerCase()?r.post(C,n):r.get(C,{params:n})}("post",{pageSn:(0,T.kd)()+"",pageInfo:{page_name:(0,T.j0)(),page_url:location&&location.href}})}},{key:"_processRules",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.share_types||[];this.appOptional=e.app_optional,this._rom=e.rom,this._matchedPkgId=e.matched_pkg_id,this._enableSilentMode=e.is_weird,e.degrade&&this.setCipherDowngrade(!0);var r=[];return this._rules=t.reduce((function(e,t){var n=t.share_type;return n&&(e[n]=t,r.push(parseInt(n,10))),e}),{}),this._innerShareTypes=e.inner_share_types||[],this._innerShareTypes.forEach((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.push(parseInt(e.share_type,10))})),this._enableShareTypes=r,this._rules}},{key:"getRuleByType",value:function(e){return(this._rules||{})[e]}},{key:"checkSync",value:function(e,t){if(!this._rules)return N.SHARE_LIMITER_NOT_INIT;if(this._enableShareTypes.indexOf(e)<0)return N.SHARE_TYPE_DISABLED;var r=t.getShareForm(e),n=(this.getRuleByType(e)||{}).share_methods||[];return[O.Z.COMMAND,O.Z.TEXT].indexOf(r)>=0?(0,Z.Pp)(t.urlWrapType)&&t.marketActivityID&&(t.shortURLApi&&n.indexOf(A.Z.LINK)>=0||t.shortCommandApi&&n.indexOf(A.Z.CIPHER)>=0||t.urlWrapType===Z.ZP.CATEGORY_PROCEDURE||t.urlWrapType===Z.ZP.CATEGORY_PROCEDURE_CUSTOM)||n.indexOf(A.Z.NORMAL)>=0?0:N.SHARE_TYPE_DISABLED:[s.Z.WECHAT_SESSION,s.Z.WECHAT_TIMELINE].indexOf(e)>=0?(0,Z.uW)(t.urlWrapType)&&t.marketActivityID&&n.indexOf(A.Z.DOMAIN)<0?N.SHARE_TYPE_DISABLED:n.indexOf(A.Z.NORMAL)>=0?0:N.SHARE_TYPE_DISABLED:0}},{key:"isCipherDowngrade",get:function(){return this._isCipherDowngrade}},{key:"rom",get:function(){return this._rom}},{key:"matchedPkgId",get:function(){return this._matchedPkgId}},{key:"isSilentMode",get:function(){return this._enableSilentMode}},{key:"setCipherDowngrade",value:function(e){this._isCipherDowngrade=e}}],r&&D(t.prototype,r),a&&D(t,a),e}(),w=null;function k(){return w||(w=new L),w}var H=r(61340),M=r(44893);function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){x(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function x(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var G="api/flow/walrus/inquire/confusion/info",B="api/flow/chron/share/card",Y=0,K=1,Q=2;function F(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(arguments.length>1&&void 0!==arguments[1]||M.X.TP_FIRST,[]),r=[],n=[],a=[];return e.forEach((function(e){if(e)switch(e.dev_type){case K:t.push(e);break;case Q:r.push(e);break;case Y:n.push(e);break;default:a.push(e)}})),f()||(t=r=[]),r[0]||t[0]||n[0]}function V(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=(0,b.e)({pageInfo:{pageId:(0,T.e6)()}},{defaultErrorHandler:function(e){}}),n=W({scene_id:e.activitySceneSn,long_url:e.shareURL||"",rom:e.rom||0,matched_pkg_id:e.matchedPkgId,param:{},page_sn:(0,T.kd)()},(0,H.O$)(e));e.payloadMixin&&"object"===j(e.payloadMixin)&&(n=Object.assign({},e.payloadMixin.param_map,n)),"string"!=typeof n.param&&(n.param=JSON.stringify(n.param));var a=r.post(B,{param_map:n});return a.then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(e.infos||[]).filter((function(e){return Object.keys(e).length>0})),n=F(r,t);return{raw:e,info:n,tpInfos:r,tpDowngrade:r.length<=0}}))}function J(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=(0,b.e)({pageInfo:{pageId:(0,T.e6)()}},{defaultErrorHandler:function(e){}}),n={long_url:e.shareURL||"",activity_code:(e.marketActivityID||0)+"",scene_sn:e.activitySceneSn||"",rom:e.rom||0,matched_pkg_id:e.matchedPkgId,params:{}};e.payloadMixin&&"object"===j(e.payloadMixin)&&(n=Object.assign(n,e.payloadMixin)),"string"!=typeof n.params&&(n.params=JSON.stringify(n.params));var a=r.post(G,n);return a.then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(e.infos||[]).filter((function(e){return Object.keys(e).length>0})),n=F(r,t);return{raw:e,info:n,tpInfos:r,tpDowngrade:r.length<=0}}))}var q=r(55525),z=r(31790),X=r(90608),$=r(76181);function ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return te(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return te(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var re=0,ne=1,ae=2;function ie(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.replace(/%s/g,t)}var oe={};function se(e){var t=e.consumeMode,r=e.scene;if("number"!=typeof t||[$.J.CONSUME_RAW,$.J.RECYCLE_RAW].indexOf(t)>=0)return Promise.resolve();var n=function(e){if(e&&!(e.length<=0)){if([$.J.CONSUME_TIME_DIVIDE,$.J.RECYCLE_TIME_DIVIDE].indexOf(t)>=0){var r=new Date,n=r.getMinutes(),a=r.getSeconds();return e[Math.floor(e.length*(60*n+a)/3600)]}if($.J.RECYCLE_TIME_DIVIDE_MULTI===t){var i=e.length,o=Math.min(Math.max(parseInt(window.__SHARE_CIPHER_PARALLEL_SIZE__,10)||0,2),i),s=Math.max(Math.floor(i/o),1),u=Math.floor(Math.random()*o),c=new Date,h=c.getMinutes(),p=c.getSeconds(),l=Math.floor(s*(60*h+p)/3600);return e[Math.max(u*s+l,i-1)]}return e[0]}},o=(oe[r]||{}).texts;return o?Promise.resolve(n(o)):function(e){return(0,i.Q6)("JSShare","getLocalCipherInfo",{action:ne,page_sn:(0,T.kd)()+"",scene:e}).then((function(){var t=((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).texts||[]).map((function(e){if(e)return e.version&&(0,a.yC)(e.version,window.__SHARE_CIPHER_VER__||"0.0.1")>=0?e.text:e.version?void 0:e.text})).filter((function(e){return!!e}));return oe[e]=oe[e]||{},oe[e].texts=t,t}),(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,P.Z)({errorCode:e.errorCode,message:"本地获取口令文本失败",options:e.data}),null}))}(r).then(n)}function ue(e){var t=e.consumeMode,r=e.scene;return"number"!=typeof t?Promise.resolve():[$.J.CONSUME,$.J.CONSUME_TIME_DIVIDE,$.J.CONSUME_RAW].indexOf(t)>=0?function(e){return(0,i.Q6)("JSShare","getLocalCipherInfo",{action:ae,page_sn:(0,T.kd)()+"",scene:e}).then((function(e){return e.cipher}),(function(e){return(0,P.Z)({errorCode:e.errorCode,message:"本地消费口令码失败",options:e.data}),null}))}(r):function(e){return(0,i.Q6)("JSShare","getLocalCipherInfo",{action:re,page_sn:(0,T.kd)()+"",scene:e}).then((function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).ciphers||[]}),(function(e){return(0,P.Z)({errorCode:e.errorCode,message:"本地获取口令码失败",options:e.data}),null}))}(r).then((function(e){if(e&&!(e.length<=0))return e[0]}))}function ce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scene,r=e.consumeMode;return(0,n.getCurrentPlatform)().isNativePlatform&&S()&&t&&"number"==typeof r?Promise.all([ue(e),se(e)]).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=ee(e,2),n=t[0],a=t[1];return n&&[$.J.CONSUME_RAW,$.J.RECYCLE_RAW].indexOf(r)>=0?n:n&&a?Object.assign({text:ie(a,n.cipher)},n):void 0})):Promise.resolve()}var he=r(94075);function pe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.getCurrentPlatform)().isNativePlatform?le.apply(void 0,t).then((function(e){return e.missed?g.Yy.apply(void 0,t):e})):g.Yy.apply(void 0,t)}var le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.shareURL||"",r=e.urlWrapType;if(e.marketActivityID&&e.activitySceneSn&&r===Z.ZP.CATEGORY_PROCEDURE){var n=k().matchedPkgId;return V(Object.assign({rom:k().rom,matchedPkgId:n},e),e.tpSelectCategory).then((function(e){var r=e.info,n=e.tpInfos,a=e.tpDowngrade,i={raw:e.raw,tpDowngrade:a,tpInfo:r,tpInfos:n,realShareURL:(r||n[0]||{}).link_url||t,targetShareURL:t},o=new Error("category procedure");return o.data=i,Promise.reject(o)}))}if(e.marketActivityID&&r===Z.ZP.CATEGORY_PROCEDURE_CUSTOM){var a=(0,Z.uW)(r)?he.v3.WEIXIN_TINY_DOMAIN:he.v3.SHORT_LINK,i=t.replace(/^(\w+:)?\/\//,""),o=(0,he.ZP)(e.requestUsePost?"post":"get",{shareURL:i,marketActivityID:e.marketActivityID,platform:(0,g.Ep)(),shareDomainType:a,shortURLApi:e.shortURLApi,shortCommandApi:e.shortCommandApi,domainURLApi:e.domainURLApi,payloadMixin:e.payloadMixin});return o.then((function(e){var t=new Error("category procedure custom");return t.data=e,Promise.reject(t)}))}if(e.marketActivityID&&e.activitySceneSn&&r===Z.ZP.SERVER_TP_APP){var s=k().matchedPkgId;return J(Object.assign({rom:k().rom,matchedPkgId:s},e),e.tpSelectCategory).then((function(e){var r=e.info,n=e.tpInfos;return{tpInfo:r,tpDowngrade:e.tpDowngrade,tpInfos:n,realShareURL:(r||n[0]||{}).link_url||t,targetShareURL:t}}),(function(e){return Promise.resolve({tpDowngrade:!0,realShareURL:t,targetShareURL:t})}))}if(e.marketActivityID&&(0,Z.vD)(r)){var u=(0,Z.uW)(r)?he.v3.WEIXIN_TINY_DOMAIN:he.v3.SHORT_LINK,c=t.replace(/^(\w+:)?\/\//,""),h=(0,q.Z)(e),p=e.cipherScene,l=e.consumeMode,f=(0,z.s)(),_=function(){var n=new Promise((function(n,a){(0,he.ZP)(e.requestUsePost?"post":"get",{shareURL:c,marketActivityID:e.marketActivityID,platform:(0,g.Ep)(),shareDomainType:u,shortURLApi:e.shortURLApi,shortCommandApi:e.shortCommandApi,domainURLApi:e.domainURLApi,payloadMixin:e.payloadMixin}).then((function(e){if(e){var i=e.domain,o=void 0===i?"":i,s=e.shortURL,c=e.shareText,h=e.raw;if(u===he.v3.WEIXIN_TINY_DOMAIN)r===Z.ZP.DOMAIN_REPLACE&&n((0,g.CU)(t,o));else if(u===he.v3.SHORT_LINK){if(!s&&!c){var p=new Error("empty short_url with empty share_text");return p.data=h,void a(p)}return void n({useShortURL:!0,realShareURL:s||t,targetShareURL:t,shareText:c,rawResponse:h})}}n({realShareURL:t,targetShareURL:t})})).catch((function(e){a(e)}))}));return u===he.v3.SHORT_LINK&&n.then((function(e){e&&e.useShortURL&&(f.cacheResponseByHash(h,e),f.setShareID(h,(new X.Z(t).query||{}).refer_share_id))})),n};if(r===Z.ZP.SERVER_SHORT_URL_WITH_CACHE){var S=f.getResponseByHash(p);return S?(f.increaseCount(p),Promise.resolve(S)):(S=f.getResponseByHash(h))?(f.increaseCount(h),Promise.resolve(S)):p&&k().isCipherDowngrade?ce({scene:p,consumeMode:l}).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e&&e.share_id){var t={cipher:e.cipher,shareText:e.text,shareID:e.share_id};return f.cacheResponseByHash(p,t),f.setShareID(p,e.shareID),t}return _()}),(function(e){return _()})):_()}return _()}if(e.activitySceneSn&&r===Z.ZP.SERVER_TP_APP_CARD){var y=k().matchedPkgId;return V(Object.assign({rom:k().rom,matchedPkgId:y},e),e.tpSelectCategory).then((function(e){var r=e.info,n=e.tpInfos;return{tpInfo:r,tpDowngrade:e.tpDowngrade,tpInfos:n,realShareURL:(r||n[0]||{}).link_url||t,categoryShareInfo:{thumbnailURL:(r||n[0]||{}).thumb_img_url},targetShareURL:t}}),(function(e){return Promise.resolve({tpDowngrade:!0,realShareURL:t,targetShareURL:t})}))}return Promise.resolve({missed:!0,realShareURL:t,targetShareURL:t})},fe=r(84973),_e=r(65232);function Se(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function ye(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){Se(i,n,a,o,s,"next",e)}function s(e){Se(i,n,a,o,s,"throw",e)}o(void 0)}))}}function Ee(){return me.apply(this,arguments)}function me(){return me=ye(regeneratorRuntime.mark((function e(){var t,r,n,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:{},"function"==typeof(r=a.length>1?a[1]:void 0).cipherProcessor){e.next=4;break}return e.abrupt("return",t);case 4:return e.prev=4,e.next=7,r.cipherProcessor({cipherText:t.title,cipherCode:t.cipher,shareEntity:r});case 7:"string"==typeof(n=e.sent)&&(t.title=t.desc=n),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,null,[[4,11]])}))),me.apply(this,arguments)}function de(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?de(Object(r),!0).forEach((function(t){Oe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ie(e){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ie(e)}var ge="static",Ae="dynamic",Te=function(e){return e?Array.isArray(e)&&e.length>0?e[0]:"object"===Ie(e)?e:null:null},be=function(e){return e?Array.isArray(e)&&e.length>0?e.map((function(e,t){return e?"string"==typeof e?{type:ge,data:e}:"object"===Ie(e)?e.type?e:{type:Ae,options:e}:void 0:null})).filter((function(e){return!!e})):"object"===Ie(e)?[{type:Ae,options:e}]:[]:[]};function Ce(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=e.drawImageOptions;return"function"==typeof n?n(r=ve({shareRefer:(0,H.O$)(e)},r||{})):"object"===Ie(n)?t?Promise.resolve(be(n)):Promise.resolve(Te(n)):Promise.resolve({})}var Re=r(9389),Pe=["share_rec_mask"];function Ze(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function De(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(r),!0).forEach((function(t){Ne(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ze(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Le(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function we(e){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}function ke(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function He(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){ke(i,n,a,o,s,"next",e)}function s(e){ke(i,n,a,o,s,"throw",e)}o(void 0)}))}}function Me(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function je(e,t){return je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},je(e,t)}function Ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=xe(e);if(t){var a=xe(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return We(this,r)}}function We(e,t){if(t&&("object"===we(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function xe(e){return xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},xe(e)}var Ge=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)}(o,e);var t,r,n,a,i=Ue(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).drawImageOptions=e.drawImageOptions,t.redirectURI=e.redirectURI||"",t.miniObjectPath=e.miniObjectPath||"",t.miniObjectID=e.miniObjectID,t.useWxAppShare=e.useWxAppShare||!1,t.forceDowngrade=e.forceDowngrade||!1,t.excludeShareChoices=e.excludeShareChoices||[],t.thirdPartyOpenType=e.thirdPartyOpenType,t.drawImageClass=e.drawImageClass,t.needSharedAmount=e.needSharedAmount||!1,t.cipherScene=e.cipherScene,t.consumeMode=e.consumeMode,t.activitySceneSn=e.activitySceneSn,t.tpSelectCategory=e.tpSelectCategory,t.pinTimelineParams=e.pinTimelineParams,t.withShareTicket=e.withShareTicket,t.systemShareMode=e.systemShareMode||Re.q.DEFAULT,t.wechatMaskConfig=e.wechatMaskConfig,t}return t=o,r=[{key:"normalize",value:(a=He(regeneratorRuntime.mark((function e(t){var r,n,a,i,o,u,c,h,p,l,f,_,S=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==s.Z.COPY_CIPHER){e.next=2;break}return e.abrupt("return",this.processCipher());case 2:if(r=Object.assign({},this),t!==s.Z.PIN_TIMELINE){e.next=5;break}return e.abrupt("return",r.pinTimelineParams);case 5:n={title:r.title,desc:r.message,thumbnail:r.thumbnailURL,share_url:r.shareURL,share_id:r.shareID,with_share_ticket:!!r.withShareTicket,system_share_mode:r.systemShareMode},(a=r.wechatMaskConfig)&&"object"===we(a)&&(i=a.share_rec_mask,o=Le(a,Pe),u=De({},o),i&&(u.share_rec_mask=De({share_type:t,activity_code:r.marketActivityID,share_id:r.shareID},i)),n.wechat_mask_config=u),r.payloadMixin&&"object"===we(c=r.payloadMixin.extra)&&void 0!==c.share_prefer&&(n.share_prefer=c.share_prefer),h=!1,e.t0=t,e.next=e.t0===s.Z.WECHAT_SESSION?13:e.t0===s.Z.WECHAT_TIMELINE_IMAGE||e.t0===s.Z.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK||e.t0===s.Z.WECHAT_SESSION_IMAGE||e.t0===s.Z.QQ_CHAT_SESSION_IMAGE||e.t0===s.Z.QQ_ZONE_IMAGE||e.t0===s.Z.WEIBO_IMAGE||e.t0===s.Z.WECHAT_SESSION_IMAGE_WITH_NO_SDK?16:e.t0===s.Z.WECHAT_SESSION_IMAGES_WITH_NO_SDK?21:e.t0===s.Z.SHARE_IMAGE_PASSIVELY?26:e.t0===s.Z.IOS_SYSTEM_SHARE_CARD||e.t0===s.Z.WECHAT_SESSION_CARD_WITH_NO_SDK||e.t0===s.Z.WECHAT_TIMELINE_CARD_WITH_NO_SDK?32:34;break;case 13:if(r.miniObjectPath&&"string"==typeof r.miniObjectPath)n.mini_object_path=(0,H.ZP)(r);else if("function"==typeof r.miniObjectPath)try{n.mini_object_path=r.miniObjectPath(r.shareURL)}catch(e){}return r.miniObjectID&&(n.mini_object_id=r.miniObjectID),e.abrupt("break",35);case 16:return h=!0,e.next=19,Ce(r);case 19:return n.options=e.sent,e.abrupt("break",35);case 21:return h=!0,e.next=24,Ce(r,!0);case 24:return n.multi_image_options=e.sent,e.abrupt("break",35);case 26:return h=!0,e.next=29,Ce(r);case 29:return n.options=e.sent,r.thirdPartyOpenType&&(n.open_type=r.thirdPartyOpenType),e.abrupt("break",35);case 32:return n.excluded_types=r.excludeShareChoices,e.abrupt("break",35);case 34:return e.abrupt("break",35);case 35:if(p=this.getShareForm.call(r,t),l=[O.Z.COMMAND,O.Z.TEXT].indexOf(p)>=0,this.targetShareURL=r.shareURL,this.realShareURL=r.shareURL,this.useShortURL=!1,t===s.Z.WECHAT_SESSION&&n.mini_object_path&&(this.realShareURL=n.mini_object_path),(0,_e.i)(t)&&(f=(0,g.ls)(t,r.shareURL),n.share_url=f,this.shareURL=f,this.realShareURL=f,this.targetShareURL=f),t===s.Z.WECHAT_SESSION&&n.mini_object_path&&(this.realShareURL=this.targetShareURL=n.mini_object_path),p!==O.Z.CARD&&p!==O.Z.WXAPP_CARD||!r.urlWrapType){e.next=47;break}return e.abrupt("return",pe(r).then((function(e){var t=e.realShareURL,a=e.targetShareURL,i=e.useShortURL,o=e.tpDowngrade,s=e.tpInfo,u=e.tpInfos,c=e.appendQuery,h=e.categoryShareInfo,p=e.useCipher,l=e.missed;return p?Promise.reject(new Error("operation refused")):(l||(S.useShortURL=i,S.realShareURL=t,S.targetShareURL=a),n.share_url=t,s&&(n.title=s.title||n.title,n.desc=s.message||n.desc),h&&(n.title=h.title||n.title,n.thumbnail=h.thumbnailURL||n.thumbnail),n.tpInfo=s,n.tpInfos=u,n.tpDowngrade=o,r.urlWrapType===Z.ZP.SERVER_QUERY_APPEND&&"string"==typeof n.mini_object_path&&n.mini_object_path&&(n.mini_object_path=(0,H.ZP)({miniObjectPath:n.mini_object_path,shareURL:t},{appendQuery:c}),S.realShareURL=n.mini_object_path),n)})));case 47:if(!h||!(0,Z.Pp)(r.urlWrapType)&&r.urlWrapType!==Z.ZP.MAGIC_TRACE&&r.urlWrapType!==Z.ZP.MAGIC_TRACE_DYNAMIC){e.next=51;break}return e.abrupt("return",pe(r).then(He(regeneratorRuntime.mark((function e(){var t,a,i,o,s,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]?u[0]:{},a=t.realShareURL,i=t.targetShareURL,o=t.useShortURL,s=t.shareText,S.targetShareURL=i,r.shortCommandApi?(S.pcode=s,n.share_url=s):(S.useShortURL=o,S.realShareURL=a,n.share_url=o?(0,fe.Z)(a):a),!o){e.next=16;break}if(!n.multi_image_options){e.next=11;break}return e.next=8,Ce(r,!0,t);case 8:n.multi_image_options=e.sent,e.next=16;break;case 11:if(!n.options){e.next=16;break}return e.next=14,Ce(r,!1,t);case 14:n.options=e.sent,n.options&&"object"===we(n.options)&&n.options.$params&&(Object.assign(n,n.options.$params),delete n.options.$params);case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e)})))));case 51:if(!l){e.next=62;break}if(_=n.title||"",!(0,Z.Pp)(r.urlWrapType)){e.next=57;break}return e.abrupt("return",pe(r).then((function(e){var t=e.realShareURL,a=e.targetShareURL,i=e.useShortURL,o=e.shareText,s=e.shareID,u=e.cipher,c=e.tpInfo,h=e.tpInfos,p=e.tpDowngrade,l=e.rawResponse,f=void 0===l?{}:l;if(s&&(n.shareID=s),u&&(n.cipher=u),c&&(n.title=c.link_url||n.title,n.desc=c.link_url||n.desc,_=n.title),n.tpInfo=c,n.tpInfos=h,n.tpDowngrade=p,n.rawResponse=f,S.targetShareURL=a,r.shortCommandApi){var y=i||u?o:"",E=y||a;_=(0,I.W)(_,E,a,y),n.title=n.desc=_,S.pcode=_}else{var m=i?t:"",d=m||a;_=(0,I.W)(_,d,a,m),n.title=n.desc=_,S.useShortURL=i,S.realShareURL=d}return Ee(n,r)})));case 57:return _=(0,I.W)(_,r.shareURL),n.title=n.desc=_,e.abrupt("return",Ee(n,r));case 60:e.next=63;break;case 62:return e.abrupt("return",Promise.resolve(n));case 63:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getShareForm",value:function(e){return e===s.Z.WECHAT_SESSION?this.miniObjectPath||this.useWxAppShare?O.Z.WXAPP_CARD:O.Z.CARD:[4,2,5,6,24,25,18,9996,9997].includes(e)?O.Z.CARD:[8,9,10,11,12,13,15,19,20,22].includes(e)?O.Z.IMAGE:[3,16,17,21,s.Z.COPY_CIPHER].includes(e)?this.shortCommandApi?O.Z.COMMAND:O.Z.TEXT:e===s.Z.COPY_LINK?O.Z.COPY_LINK:O.Z.DEFAULT}},{key:"getShareMethod",value:function(e){return[9,16,19,20,18,9996,9997].includes(e)?v.Z.SYSTEM:[1,2,3,4,5,8,10,11,12,13,15,17,21,24,25].includes(e)?v.Z.SDK:e===s.Z.SHARE_IMAGE_PASSIVELY?this.thirdPartyOpenType?v.Z.MANUAL:v.Z.DEFAULT:e===s.Z.COPY_CIPHER?v.Z.MANUAL:v.Z.DEFAULT}}],r&&Me(t.prototype,r),n&&Me(t,n),o}(I.Z),Be=Ge,Ye=r(24778),Ke=r(2002);function Qe(e){return"string"!=typeof e?Promise.reject():(0,n.getCurrentPlatform)().isNativePlatform?(0,i.Q6)("AMStorage","setPasteboard",{text:e}):Promise.reject()}var Fe=r(71975);function Ve(e){return Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ve(e)}var Je=["tpInfo","tpInfos","tpDowngrade","wechat_mask_config"],qe=["share_code","system_share_mode","wechat_mask_config"],ze=["tpInfo","tpInfos","tpDowngrade","wechat_mask_config"];function Xe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $e(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(r),!0).forEach((function(t){et(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function et(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tt(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function rt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nt(e,t,r){return nt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=st(e)););return e}(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(r):a.value}},nt(e,t,r||e)}function at(e,t){return at=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},at(e,t)}function it(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=st(e);if(t){var a=st(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return ot(this,r)}}function ot(e,t){if(t&&("object"===Ve(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function st(e){return st=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},st(e)}var ut=Object.keys(s.Z).map((function(e){return s.Z[e]})).filter((function(e){return[s.Z.WECHAT_BIG_IMAGE].indexOf(e)<=0})),ct=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&at(e,t)}(f,e);var t,r,o,u=it(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=u.call(this,e)).ShareEntityClass=Be,t._enableShareTypes=ut.concat(),t.shareLimiter=k(),t._isEnableShareCheck=!1,t.setShareCheck(!0),t}return t=f,r=[{key:"setShareCheck",value:function(e){(0,n.getCurrentPlatform)().isTinyNativePlatform?this._isEnableShareCheck=!0:this._isEnableShareCheck=!!e&&h("4.51.0","4.51.0")}},{key:"checkShareTypeEnable",value:function(e){var t=this.getShareEntityByShareType(e);if(!this.validateShareParams(e,t))return E.D.SHARE_PARAMS_NOT_VALID;if(!function(e){var t=!1;if("number"!=typeof e)return!1;switch(e){case s.Z.WECHAT_SESSION:case s.Z.WECHAT_TIMELINE:case s.Z.WECHAT_SESSION_APP:case s.Z.QQ_CHAT_SESSION:case s.Z.QQ_ZONE:case s.Z.WECHAT_TIMELINE_IMAGE:case s.Z.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK:case s.Z.WECHAT_SESSION_IMAGE:case s.Z.QQ_CHAT_SESSION_IMAGE:case s.Z.QQ_ZONE_IMAGE:case s.Z.WECHAT_SESSION_TEXT_WITH_NO_SDK:case s.Z.WECHAT_SESSION_TEXT:t=!0;break;case s.Z.WEIBO:case s.Z.WEIBO_IMAGE:t=h("4.81.0","4.81.0");break;case s.Z.WECHAT_SESSION_IMAGE_WITH_NO_SDK:case s.Z.WECHAT_SESSION_IMAGES_WITH_NO_SDK:t=h("4.37.0","4.36.0");break;case s.Z.WECHAT_TIMELINE_TEXT:t=h("4.39.0","4.39.0");break;case s.Z.IOS_SYSTEM_SHARE_CARD:case s.Z.WECHAT_SESSION_CARD_WITH_NO_SDK:case s.Z.WECHAT_TIMELINE_CARD_WITH_NO_SDK:t=p();break;case s.Z.SHARE_IMAGE_PASSIVELY:t=h("4.49.0","4.49.0");break;case s.Z.COPY_LINK:case s.Z.COPY_CIPHER:t=!0;break;case s.Z.WECHAT_SESSION_MUSIC:case s.Z.WECHAT_SESSION_VIDEO:t=h("4.86.0","4.86.0");break;case s.Z.FRIENDS:case s.Z.WECHAT_BIG_IMAGE:t=!0;break;case s.Z.PIN_TIMELINE:t=h("5.6.0","5.6.0")}return t}(e)||this._enableShareTypes.indexOf(e)<0)return E.D.SHARE_TYPE_DISABLED;if(this._isEnableShareCheck&&[s.Z.COPY_LINK,s.Z.COPY_CIPHER].indexOf(e)<0){var r=this.shareLimiter.checkSync(e,t);if(r)return r}return 0}},{key:"share",value:function(e){var t=this.checkShareTypeEnable(e);return t||(e===s.Z.PIN_TIMELINE?this._sharePinTimeline(e):e===s.Z.WECHAT_BIG_IMAGE?this._nativeShareBigImage(e):[s.Z.WECHAT_SESSION,s.Z.WECHAT_TIMELINE,s.Z.WEIBO,s.Z.QQ_CHAT_SESSION,s.Z.QQ_ZONE,s.Z.TENCENT_WEIBO,s.Z.WECHAT_SESSION_APP,s.Z.FRIENDS,s.Z.WECHAT_SESSION_MUSIC,s.Z.WECHAT_SESSION_VIDEO].indexOf(e)>=0?this._nativeShareCard(e):[s.Z.IOS_SYSTEM_SHARE_CARD,s.Z.WECHAT_SESSION_CARD_WITH_NO_SDK,s.Z.WECHAT_TIMELINE_CARD_WITH_NO_SDK].indexOf(e)>=0?this._nativeShareCardSpecial(e):[s.Z.WECHAT_TIMELINE_IMAGE,s.Z.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK,s.Z.WECHAT_SESSION_IMAGE,s.Z.QQ_CHAT_SESSION_IMAGE,s.Z.QQ_ZONE_IMAGE,s.Z.WEIBO_IMAGE,s.Z.WECHAT_SESSION_IMAGE_WITH_NO_SDK,s.Z.WECHAT_SESSION_IMAGES_WITH_NO_SDK,s.Z.SHARE_IMAGE_PASSIVELY].indexOf(e)>=0?this._nativeShareImage(e):[s.Z.WECHAT_SESSION_TEXT_WITH_NO_SDK,s.Z.WECHAT_SESSION_TEXT,s.Z.WECHAT_TIMELINE_TEXT].indexOf(e)>=0?this._nativeShareText(e):s.Z.COPY_LINK===e?this._nativeShareClipboard(e):s.Z.COPY_CIPHER===e?this.copyCipher():E.D.SHARE_TYPE_NOT_FOUND)}},{key:"validateShareParams",value:function(e){return!0}},{key:"_setupShareTypes",value:function(){}},{key:"resetLimiter",value:function(){return this.shareLimiter.reset(),this._queryShareTypePromise=null,this.waitShareLimiter()}},{key:"refreshShare",value:function(e,t){var r=nt(st(f.prototype),"refreshShare",this).call(this,e,t);return this.emit(m.Z.ON_SHARE_PREPARE,{shareType:t}),r}},{key:"_setupPlatformShareSDK",value:function(){return this.waitShareLimiter()}},{key:"waitShareLimiter",value:function(){var e=this;return this._isEnableShareCheck?(this._queryShareTypePromise||(this._queryShareTypePromise=this.shareLimiter.build().catch((function(t){return e.emit(m.Z.SHARE_LIMIT_LOAD_FAIL),Promise.resolve()}))),this._queryShareTypePromise):Promise.resolve()}},{key:"_nativeShareCard",value:function(e){var t=this;this.emit(m.Z.ON_SHARE_TRIGGER,{shareType:e});var r=this.getShareEntityByShareType(e);return r.normalize(e).then((function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=n.tpInfo,i=n.tpInfos,o=n.tpDowngrade,s=n.wechat_mask_config,u=tt(n,Je);if(o)t.emit(m.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:d.Z.FAIL,tpDowngrade:!0,tpInfo:a});else{var h=Object.assign({type:e,redirect_uri:r.redirectURI||"",share_params:u,share_method:(0,Ke.w)(r,e)});r.needSharedAmount&&(h.show_check_detail=1),s&&(h.wechat_mask_config=s),a&&a.dev_type&&(h.dev_app=a.dev_app,h.dev_type=a.dev_type),i&&(h.dev_infos=i),t._invokeNativeShare(h,(function(r){t.emit(m.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:d.Z.SUCCESS,responseData:r,tpInfo:a})}),(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=parseInt(r.errorCode,10)||0,i=n===c?d.Z.CANCEL:d.Z.FAIL;t.emit(m.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:i,nativeShareErrorCode:n,responseData:r.data,tpInfo:a})}))}}),this.getNormalizeErrorHandler(e)),0}},{key:"_nativeShareCardSpecial",value:function(e){var t=this;this.emit(m.Z.ON_SHARE_TRIGGER,{shareType:e});var r=this.getShareEntityByShareType(e);return r.normalize(e).then((function(n){var a=Object.assign({type:s.Z.IOS_SYSTEM_SHARE_CARD,share_params:n,share_method:(0,Ke.w)(r,e)});t._invokeNativeShare(a,(function(r){t.emit(m.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:d.Z.SUCCESS,responseData:r})}),(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=parseInt(r.errorCode,10)||0,a=n===c?d.Z.CANCEL:d.Z.FAIL;t.emit(m.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:a,nativeShareErrorCode:n,responseData:r.data})}))}),this.getNormalizeErrorHandler(e)),0}},{key:"_nativeShareImage",value:function(e){var t=this;this.emit(m.Z.ON_SHARE_TRIGGER,{shareType:e});var r=this.getShareEntityByShareType(e),n=e;return r.normalize(e).then((function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=a.share_code,o=a.system_share_mode,s=a.wechat_mask_config,u=tt(a,qe),h={type:n,share_params:u,share_method:(0,Ke.w)(r,e),share_code:i,system_share_mode:o};s&&(h.wechat_mask_config=s);var p=!1;t._invokeNativeShare(h,(function(r){!p&&t.emit(m.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:d.Z.SUCCESS,responseData:r})}),(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=parseInt(r.errorCode,10),a=n===c?d.Z.CANCEL:d.Z.FAIL;!p&&t.emit(m.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:a,nativeShareErrorCode:n,responseData:r.data})}))}),this.getNormalizeErrorHandler(e)),0}},{key:"_nativeShareText",value:function(e){var t=this,r=this.getShareEntityByShareType(e),i=r.cipherScene&&"string"==typeof r.cipher;!i&&this.emit(m.Z.ON_SHARE_TRIGGER,{shareType:e});var o=e;return r.normalize(e).then((function(u){var h=u.tpInfo,p=u.tpInfos,l=u.tpDowngrade,f=u.wechat_mask_config,_=tt(u,ze);if(i&&(t.emit(m.Z.ON_SHARE_TRIGGER,{shareType:e,shareID:_.shareID}),delete _.shareID),l)t.emit(m.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:d.Z.FAIL,tpDowngrade:!0,tpInfo:h});else{var S=Object.assign({type:o,share_params:_,share_method:(0,Ke.w)(r,e)});if(h&&h.dev_type&&(S.dev_app=h.dev_app,S.dev_type=h.dev_type),p&&(S.dev_infos=p),f&&(S.wechat_mask_config=f),r.forceDowngrade||(0,n.getCurrentPlatform)().system===a.we.IOS&&o===s.Z.WECHAT_SESSION_TEXT_WITH_NO_SDK)return t.emit(m.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:d.Z.FAIL,shareParams:u}),0;t._invokeNativeShare(S,(function(r){t.emit(m.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:d.Z.SUCCESS,responseData:r})}),(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=parseInt(r.errorCode,10)||0,a=n===c?d.Z.CANCEL:d.Z.FAIL;t.emit(m.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:a,nativeShareErrorCode:n,responseData:r.data})}))}}),this.getNormalizeErrorHandler(e)),0}},{key:"_nativeShareBigImage",value:function(e){return E.D.SHARE_TYPE_DISABLED}},{key:"_nativeShareClipboard",value:function(e){var t=this;this.emit(m.Z.ON_SHARE_TRIGGER,{shareType:e});var r=this.getShareEntityByShareType(e);return r.normalize(e).then((function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=n.share_url||r.shareURL;Qe(a).then((function(){t.emit(m.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:d.Z.SUCCESS,content:a,originContent:""})}),(function(){t.emit(m.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:d.Z.FAIL,content:a,originContent:""})}))}),this.getNormalizeErrorHandler(e)),0}},{key:"_sharePinTimeline",value:function(e){var t=this;return this.emit(m.Z.ON_SHARE_TRIGGER,{shareType:e}),this.getShareEntityByShareType(e).normalize(e).then((function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({type:e,share_params:r});t._invokeNativeShare(n,(function(r){t.emit(m.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:d.Z.SUCCESS,responseData:r})}),(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=parseInt(r.errorCode,10)||0;t.emit(m.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:d.Z.FAIL,nativeShareErrorCode:n,responseData:r.data})}))}),this.getNormalizeErrorHandler(e)),0}},{key:"setupNativeShareButton",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.shareIcon,n=void 0===r?y:r,a=t.shareIconSize,o=void 0===a?22:a;return"string"!=typeof n||"number"!=typeof o?E.D.SHARE_PARAMS_NOT_VALID:((0,i.Q6)("JSUIControl","setRightBarButtons",{buttons:[{icons:{normal:n},callback:function(){e.emit(m.Z.ON_SHARE_BUTTON_CLICKED)},size:o}]}).catch((function(e){})),0)}},{key:"_invokeNativeShare",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n="JSShare",a="share",o=(0,T.kd)()+"";this._isEnableShareCheck?(e=Object.assign({origin:"h5",page_sn:o,page_info:{page_name:(0,T.j0)(),page_url:location&&location.href}},e),this.shareLimiter.getAppOptional()&&(e.app_optional=this.shareLimiter.getAppOptional()),a="performShare"):e.page_sn=o,(0,i.Q6)(n,a,e).then(t,r)}},{key:"shareCipherManually",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ye.Z.OPEN_WECHAT,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Fe.a.DEFAULT,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return e&&"string"==typeof e?l()?(t!==Ye.Z.OPEN_WECHAT&&t!==Ye.Z.OPEN_WECHAT_IOS_SILENT&&t!==Ye.Z.OPEN_WECHAT_ANDROID_SILENT||(t=_()&&this.shareLimiter.isSilentMode?(0,n.getCurrentPlatform)().system===a.we.IOS?Ye.Z.OPEN_WECHAT_IOS_SILENT:Ye.Z.OPEN_WECHAT_ANDROID_SILENT:Ye.Z.OPEN_WECHAT),(0,i.Q6)("JSShare","shareCipher",$e({cipher:e,open_type:t,paste_type:r,share_code:o},s))):Promise.reject(new Error("not support")):Promise.reject(new Error("invalid cipher"))}}],r&&rt(t.prototype,r),o&&rt(t,o),f}(o.Z),ht=ct}}]);
//# sourceMappingURL=http://vgunxpkt.com/sourcemaps/mobile-fun-cashback/js/ms_native_c_ac76a4c97eff21715bab.js.map