(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{"KnyY":function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return z}));var n,c,s,r,o,l=t("JqEv"),i=t("p5LO"),b=t("wzp5"),u=t("kRu4"),d=t.n(u),m=t("RgDV"),h=t("w9YI"),k=t("QjaO"),w=t("cJQI"),p=t("ZsPb"),g=t("JsaZ"),O=t("Rp4V"),_=t("MQ17"),j=t("q1tI"),C=t.n(j),v=t("2oo6"),f=t("TyAF"),E=t("TSYQ"),S=t.n(E),N=t("gpDe"),I=t("phI5"),T=t.n(I),y=t("7Qib"),L=t("ygAv"),R=t("ABVw"),B=t("bmJN"),D=t("ktSw"),A=t("0S3Q"),x=t("TRXh"),P=t("hn0O"),M=t("4r5b"),F=t("M3Mi"),V=t("2vnA"),W=t("3uR/"),Q=(n={},Object(_.a)(n,A.b.bus,6494732),Object(_.a)(n,A.b.walk,6494731),Object(_.a)(n,A.b.light,6494733),n),z=(c=Object(f.inject)(N.b.POPUP_QUEUE,N.b.LOW_CARBON,N.b.GLOBAL),s=Object(D.e)(50),c(r=Object(f.observer)((o=function(e){Object(p.a)(LowCarbonProcess,e);var a=Object(g.a)(LowCarbonProcess);function LowCarbonProcess(e){var t;return Object(h.a)(this,LowCarbonProcess),t=a.call(this,e),Object(_.a)(Object(w.a)(t),"imprReport",(function(){var e,a,n;Object(F.b)(Q[A.b.bus]),Object(F.b)(Q[A.b.light]),Object(F.b)(Q[A.b.walk]),null!==(e=t.store)&&void 0!==e&&null!==(a=e.info)&&void 0!==a&&null!==(n=a.energyStageVolist)&&void 0!==n&&n.find((function(e){return[A.a.canDraw,A.a.unFinish].includes(e.status)}))&&Object(F.b)(6494730)})),Object(_.a)(Object(w.a)(t),"getNormalRewardImg",(function(e,a){return a?"low_carbon_sm_redpacket_has_draw":e?"low_carbon_last_redpacket":"not_enough_tip_redpacket_icon"})),Object(_.a)(Object(w.a)(t),"checkStatus",(function(e){return{"canDraw":e===A.a.canDraw,"hasDraw":e===A.a.hasDraw,"unFinish":e===A.a.unFinish,"process":e===A.a.process}})),Object(_.a)(Object(w.a)(t),"getItemStatus",(function(e){var a,n=((null===(a=t.store)||void 0===a?void 0:a.info)||{}).energyStageVolist,c=(null==n?void 0:n[e-1])||{},s=c.status,r=c.needClockCount,o=c.currentClockCount;return{"canDraw":s===A.a.canDraw,"hasDraw":s===A.a.hasDraw,"unFinish":s===A.a.unFinish,"process":s===A.a.process,"remainTime":r-o}})),Object(_.a)(Object(w.a)(t),"getTaskStatus",(function(e){var a,n=(null===(a=t.store)||void 0===a?void 0:a[A.d[e]])||{},c=n.finishCount,s=n.maxCount,r=n.nextCompleteTime;return{"cooling":1e3*r>t.globalStore.serverTime&&c<s,"done":c>=s,"canCheckIn":1e3*r<=t.globalStore.serverTime&&c<s}})),Object(_.a)(Object(w.a)(t),"checkAnchor",(function(){var e=document.querySelector("#lowCarbonScrollView");e&&(e.scrollLeft=t.innerBarWidth-80)})),Object(_.a)(Object(w.a)(t),"getTaskBtnText",(function(e){var a=t.getTaskStatus(e),n=a.canCheckIn,c=a.cooling;return n?"立即打卡":c?Object(L.g)(t.store[A.c[e]]):"明日继续"})),Object(_.a)(Object(w.a)(t),"onClose",(function(){t.popupQueueStore.close("showLowCarbonProcess")})),Object(_.a)(Object(w.a)(t),"handleTaskClick",(function(e){Object(F.a)(Q[e]);var a=t.getTaskStatus(e),n=a.cooling,c=a.done,s=a.canCheckIn;return n?x.a.showToast("倒计时结束，即可打卡哦"):c?x.a.showToast("此项打卡已完成，明日可继续"):void(s&&t.handleTaskCheckIn(e))})),Object(_.a)(Object(w.a)(t),"handleTaskCheckIn",Object(D.a)(function(){var e=Object(m.a)(d.a.mark((function _callee(e){var a,n,c;return d.a.wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(M.a)(P.c.LOW_CARBON,null===(a=t.store[A.d[e]])||void 0===a?void 0:a.missionType,{"globalStore":t.globalStore});case 2:c=s.sent,t.store.init(c),t.store.initTaskCoolTime(A.c[e],null===(n=t.store[A.d[e]])||void 0===n?void 0:n.nextCompleteTime),x.a.showToast("节能打卡成功");case 6:case"end":return s.stop()}}),_callee)})));return function(a){return e.apply(this,arguments)}}())),Object(_.a)(Object(w.a)(t),"handleRewardClick",(function(){var e,a,n;null!==(e=t.store)&&void 0!==e&&null!==(a=e.info)&&void 0!==a&&null!==(n=a.energyStageVolist)&&void 0!==n&&n.find((function(e){return[A.a.canDraw,A.a.unFinish].includes(e.status)}))&&(Object(F.a)(6494730),t.popupQueueStore.instantShow("showLowCarbonReward"),t.onClose())})),Object(_.a)(Object(w.a)(t),"generateLabel",(function(e){var a=t.checkStatus(e.status),n=a.canDraw,c=a.hasDraw,s=a.process,r=a.unFinish,o=e||{},l=o.needClockCount,i=o.currentClockCount,b=o.stageOrder;return c?"已领":b>t.store.activeIndex?"待开启":s?"差".concat(l-i,"次可领"):n||r?"可领取":void 0})),Object(_.a)(Object(w.a)(t),"renderRedpacketItem",(function(e,a){var n,c=e||{},s=c.status,r=c.needRewardIcon,o=t.checkStatus(s)||{},l=o.hasDraw,u=o.canDraw,d=o.unFinish;return C.a.createElement(i.a,{"className":S()(T.a.redpacket,Object(_.a)({},T.a.redpacketHasDraw,l)),"key":a},C.a.createElement(b.a,{"src":Object(y.a)(t.getNormalRewardImg(r,l)),"className":S()(T.a.redpacketBg,(n={},Object(_.a)(n,T.a.redpacketShake,u||d),Object(_.a)(n,T.a.isBigRedpacket,r&&!l),n))}),l?C.a.createElement(b.a,{"className":T.a.hasDrawTag,"src":Object(y.a)("low_carbon_has_draw_tag")}):null,C.a.createElement(i.a,{"className":S()(T.a.redpacketLabel,Object(_.a)({},T.a.laeblCanDraw,u||d))},t.generateLabel(e)))})),Object(_.a)(Object(w.a)(t),"renderLastRedpacket",(function(e){var a,n=t.state.showEndMask,c=t.checkStatus(e.status)||{},s=c.canDraw,r=c.unFinish,o=c.process;return C.a.createElement(i.a,{"className":T.a.lastRedpacket},n?C.a.createElement(b.a,{"className":T.a.lastRedpacketShadow,"src":Object(y.a)("low_carbon_shadow")}):null,n?C.a.createElement(i.a,{"className":T.a.lastRedpacketBg}):null,C.a.createElement(b.a,{"className":T.a.lastRedpacketImg,"src":Object(y.a)("not_enough_tip_redpacket_new_icon")}),C.a.createElement(i.a,{"className":T.a.lastAmount},Object(W.o)((e.rewardAmount||0)/100)),C.a.createElement(i.a,{"className":S()(T.a.lastLabel,(a={},Object(_.a)(a,T.a.lastLabelCanDraw,s||r),Object(_.a)(a,T.a.lastLbelProcess,o),a))},t.generateLabel(e)))})),Object(_.a)(Object(w.a)(t),"renderProcess",(function(){var e,a=(t.store.info||{}).energyStageVolist,n=t.state,c=n.showStartMask,s=n.showFlash;return C.a.createElement(i.a,{"className":T.a.processContainer},c?C.a.createElement(b.a,{"className":T.a.startShadow,"src":Object(y.a)("low_carbon_start_new_shadow")}):null,c?C.a.createElement(i.a,{"className":T.a.startShadowBg}):null,C.a.createElement(l.a,{"className":T.a.bar,"onScroll":t.handleScroll,"id":"lowCarbonScrollView"},C.a.createElement(i.a,{"className":T.a.innerBar,"id":"low-carbon-inner-bar"},C.a.createElement(b.a,{"className":T.a.barImg,"src":Object(y.a)("low_carbon_inner_bottom_bar"),"style":{"transform":"translateX(".concat(Object(B.a)(2*(t.innerBarWidth||10)),")")}}),C.a.createElement(b.a,{"className":S()(T.a.barImg,T.a.midBarImg,Object(_.a)({},T.a.flash,s)),"src":Object(y.a)("low_carbon_inner_mid_bar"),"style":{"transform":"translateX(".concat(Object(B.a)(2*(t.innerBarWidth||10)),")")}}),C.a.createElement(b.a,{"className":T.a.barImg,"src":Object(y.a)("low_carbon_inner_top_bar"),"style":{"transform":"translateX(".concat(Object(B.a)(2*(t.innerBarWidth||10)),")")}}),C.a.createElement(b.a,{"className":T.a.fakeStart,"src":Object(y.a)("low_carbon_innerbar_start")}),C.a.createElement(i.a,{"className":T.a.list},null==a||null===(e=a.slice(0,-1))||void 0===e?void 0:e.map((function(e,a){return t.renderRedpacketItem(e||{},a)}))))),t.renderLastRedpacket((null==a?void 0:a[(null==a?void 0:a.length)-1])||{}))})),t.handleScroll=t.handleScroll.bind(Object(w.a)(t)),t.state={"showEndMask":!0,"showStartMask":!1,"showFlash":!1},t}return Object(k.a)(LowCarbonProcess,[{"key":"componentDidMount","value":function componentDidMount(){var e=this;setTimeout(this.checkAnchor,50),this.imprReport(),Object(V.reaction)((function(){return e.innerBarWidth}),(function(){e.setState({"showFlash":!0},(function(){setTimeout((function(){e.setState({"showFlash":!1})}),600)}))}))}},{"key":"handleScroll","value":function handleScroll(e){var a=(null==e?void 0:e.target)||{},t=a.scrollLeft,n=a.scrollWidth,c=a.clientWidth,s=this.state.showEndMask;if(t>=10?this.setState({"showStartMask":!0}):this.setState({"showStartMask":!1}),n-t<=c+22&&s)return this.setState({"showEndMask":!1});!s&&n-t>c+22&&this.setState({"showEndMask":!0})}},{"key":"render","value":function render(){var e=this,a=this.store,t=a.cumulativeAarbonReduction,n=a.remainTime,c=a.walkMission,s=a.busMission,r=a.lightMission;return C.a.createElement(v.a,{"disableContentBg":!0,"showClose":!0,"onClose":this.onClose,"closeIconStyle":{"top":0}},C.a.createElement(b.a,{"className":T.a.header,"src":Object(y.a)("low_carbon_process_header")}),C.a.createElement(i.a,{"className":T.a.container},C.a.createElement(i.a,{"className":T.a.bgBox},C.a.createElement(i.a,{"className":T.a.containerBg})),C.a.createElement(i.a,{"className":T.a.content},C.a.createElement(i.a,{"className":T.a.top},C.a.createElement(i.a,{"className":T.a.desc},this.desc),C.a.createElement(i.a,{"className":T.a.countdown},"仅剩",Object(L.g)(n))),C.a.createElement(i.a,{"className":T.a.barBox,"onClick":this.handleRewardClick},this.renderProcess()),C.a.createElement(i.a,{"className":T.a.task},C.a.createElement(i.a,{"className":T.a.taskItem,"onClick":function onClick(){return e.handleTaskClick(A.b.walk)}},C.a.createElement(b.a,{"className":T.a.taskImg,"enablewebp":0,"src":Object(y.a)("low_carbon_task_walk")}),C.a.createElement(i.a,{"className":T.a.label},"走路100步"),C.a.createElement(i.a,{"className":T.a.decCarbonAmount},"可减碳",this.store.getMissionCarbonAmount(c),"克"),C.a.createElement(i.a,{"className":T.a.btn},C.a.createElement(R.b,{"type":R.a.Prize,"size":"small","style":{"width":Object(B.a)(152),"opacity":this.getTaskStatus(A.b.walk).canCheckIn?"":"50%"},"text":this.getTaskBtnText(A.b.walk)}))),C.a.createElement(i.a,{"className":T.a.taskItem,"onClick":function onClick(){return e.handleTaskClick(A.b.bus)}},C.a.createElement(b.a,{"className":T.a.taskImg,"enablewebp":0,"src":Object(y.a)("low_carbon_task_bus")}),C.a.createElement(i.a,{"className":T.a.label},"公交出行"),C.a.createElement(i.a,{"className":T.a.decCarbonAmount},"可减碳",this.store.getMissionCarbonAmount(s),"克"),C.a.createElement(i.a,{"className":T.a.btn},C.a.createElement(R.b,{"type":R.a.Prize,"size":"small","style":{"width":Object(B.a)(152),"opacity":this.getTaskStatus(A.b.bus).canCheckIn?"":"50%"},"text":this.getTaskBtnText(A.b.bus)}))),C.a.createElement(i.a,{"className":T.a.taskItem,"onClick":function onClick(){return e.handleTaskClick(A.b.light)}},C.a.createElement(b.a,{"className":T.a.taskImg,"enablewebp":0,"src":Object(y.a)("low_carbon_task_light")}),C.a.createElement(i.a,{"className":T.a.label},"关灯1小时"),C.a.createElement(i.a,{"className":T.a.decCarbonAmount},"可减碳",this.store.getMissionCarbonAmount(r),"克"),C.a.createElement(i.a,{"className":T.a.btn},C.a.createElement(R.b,{"type":R.a.Prize,"size":"small","style":{"width":Object(B.a)(152),"opacity":this.getTaskStatus(A.b.light).canCheckIn?"":"50%"},"text":this.getTaskBtnText(A.b.light)}))))),C.a.createElement(i.a,{"className":T.a.comment},"你已减碳",t,"克，共建绿色家园")))}},{"key":"activeIndex","get":function get(){return this.store.activeIndex}},{"key":"desc","get":function get(){var e=this.getItemStatus(this.activeIndex),a=e.process,t=e.canDraw,n=this.store,c=n.activeIndex,s=(n.info||{}).energyStageVolist,r=(null==s?void 0:s[c-1])||{},o=r.needClockCount,l=r.currentClockCount;return t?"已完成".concat(o,"次打卡，可领现金"):a?"再节能打卡".concat(o-l,"次，可领现金"):void 0}},{"key":"store","get":function get(){return this.props[N.b.LOW_CARBON]}},{"key":"globalStore","get":function get(){return this.props[N.b.GLOBAL]}},{"key":"popupQueueStore","get":function get(){return this.props[N.b.POPUP_QUEUE]}},{"key":"innerBarWidth","get":function get(){var e,a,t=((null===(e=this.store)||void 0===e?void 0:e.info)||{}).energyStageVolist,n=void 0===t?[]:t,c=(null==n||null===(a=n.filter((function(e){return[A.a.canDraw,A.a.hasDraw,A.a.unFinish].includes(e.status)})))||void 0===a?void 0:a.length)||0,s=(null==n?void 0:n[c])||{},r=s.needClockCount,o=void 0===r?0:r,l=s.currentClockCount,i=void 0===l?0:l,b=((null==n?void 0:n[c-1])||{}).needClockCount,u=void 0===b?0:b,d=(i-u)/(o-u);return c>=(null==n?void 0:n.length)?80*(c-1)+37:c>=1?80*(c-1)+58*d+37:15*d}}]),LowCarbonProcess}(j.Component),Object(O.a)(o.prototype,"handleScroll",[s],Object.getOwnPropertyDescriptor(o.prototype,"handleScroll"),o.prototype),r=o))||r)||r)},"phI5":function(e,a,t){e.exports={"header":"_1x6Tgfl","container":"pSc3fpL","bgBox":"iPr9az-","containerBg":"_3vF05AJ","content":"ODjb97L","top":"_3vFrEqR","desc":"_3iVPIEn","countdown":"_2lKa_NX","barBox":"_38VTdcF","comment":"_1jvwwYe","task":"_3apyzrS","taskItem":"_3_NKLXC","taskImg":"T12MwiC","label":"_2EYuOjy","btn":"_1-ahcNo","processContainer":"_1V4zTdB","bar":"agxfEqy","innerBar":"_2XWr69R","flash":"_2lO6b5I","midBarImg":"_1NNcLRc","list":"_3a9EWYf","barImg":"_1D2unWV","fakeStart":"_3GNMfg3","startShadow":"_2YSPrbf","startShadowBg":"_1Fz0Vr3","redpacket":"dgEraZU","test":"_2DnUt1o","redpacketBg":"_1QxkjpT","isBigRedpacket":"_2kuv4kI","redpacketLabel":"_1O6QrQs","hasDrawTag":"_1-tRpIw","laeblCanDraw":"_2USLRME","lastRedpacket":"_2Mq9AgX","lastRedpacketImg":"_1liubhZ","lastRedpacketBg":"DWjKNUl","lastRedpacketShadow":"_2AiveiA","lastLabel":"GIRnTX6","lastLbelProcess":"_1NhtFaG","lastAmount":"_3Ys13Hn","lastLabelCanDraw":"_2w5LwX8","decCarbonAmount":"_2NLLd4v","redpacketShake":"_3dbpNHR","dotShake":"CoTpNO1"}}}]);
//# sourceMappingURL=http://vgunxpkt.com/sourcemaps/mobile-fit/js/FitV2Popups-LowCarbonProcess_270f6372508dbf8874d0.js.map