(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[4],{"3Wbp":function(e,t,r){"use strict";r.r(t);var a=r("lwsE"),n=r.n(a),i=r("W8MJ"),s=r.n(i),h=r("iWIM"),o=r.n(h),u=r("7W2i"),c=r.n(u),_=r("a1gu"),p=r.n(_),S=r("Nsbk"),l=r.n(S),E=r("KoDT"),f=r("h3qu"),T=r("MpJ2"),O=r("dKgK"),y=r("a/1V"),d=r("qxQD"),I=r("/bZk"),A=r("chhR"),m=r("EECB"),v=r("o0o1"),C=r.n(v),R=r("cDf5"),g=r.n(R),b=r("yXPU"),L=r.n(b),N=r("YSLc"),P=r("W9H9"),D=r("gfNA"),H=r("Ne86"),j=r("7sJ8"),M=r("uf4C"),k=r("rIj9"),U="api/flow/audience/share/types",W=r("v1av"),w=r("z4CT"),x=r("dp2P"),G=I.b.ShareErrorCode,B=function(){function e(){n()(this,e),this._inited=!1,this._queryShareTypePromise=null,this._rules=null,this._enableShareTypes=[],this.appOptional=null,this._rom=0,this._isCipherDowngrade=!1,this._enableSilentMode=!1}return s()(e,[{key:"build",value:function(){var e=this;return this._inited?Promise.resolve():(this._queryShareTypePromise||(this._queryShareTypePromise=this.loadRules(),this._queryShareTypePromise.then(function(t){return e._inited=!0,e._processRules(t),W.a.getInstance().build({magicTrace:t.magic_trace})}).catch(function(t){Object(w.a)({errorCode:0,message:"分享规则初始化失败",options:{message:t&&t.message,errorCode:t&&t.errorCode}}),e._inited=!0})),this._queryShareTypePromise)}},{key:"reset",value:function(){this._inited=!1,this._queryShareTypePromise=null,this._rules=null,this._enableShareTypes=[],this.appOptional=null,this._rom=0,this._isCipherDowngrade=!1,this._enableSilentMode=!1}},{key:"getAppOptional",value:function(){return this.appOptional}},{key:"getRules",value:function(){var e=this;return this.build().then(function(){return e._rules},function(){return Promise.resolve(e._rules)})}},{key:"loadRules",value:function(){return Object(E.a)().isNativePlatform?Object(T.g)(Object(d.g)(),"queryShareTypes",{page_sn:Object(M.f)()+"",page_info:{page_name:Object(M.e)(),page_url:location&&location.href}}):function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object(k.a)({pageInfo:{pageId:Object(M.d)()}},{defaultErrorHandler:function(e){}}),a={};return a.page_sn=t.pageSn||"",a.page_info=t.pageInfo||{},a.platform="h5","post"===e.toLowerCase()?r.post(U,a):r.get(U,{params:a})}("post",{pageSn:Object(M.f)()+"",pageInfo:{page_name:Object(M.e)(),page_url:location&&location.href}})}},{key:"_processRules",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.share_types||[];this.appOptional=e.app_optional,this._rom=e.rom,this._enableSilentMode=e.is_weird,e.degrade&&this.setCipherDowngrade(!0);var r=[];return this._rules=t.reduce(function(e,t){var a=t.share_type;return a&&(e[a]=t,r.push(parseInt(a,10))),e},{}),this._innerShareTypes=e.inner_share_types||[],this._innerShareTypes.forEach(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.push(parseInt(e.share_type,10))}),this._enableShareTypes=r,this._rules}},{key:"getRuleByType",value:function(e){return(this._rules||{})[e]}},{key:"checkSync",value:function(e,t){if(!this._rules)return G.SHARE_LIMITER_NOT_INIT;if(this._enableShareTypes.indexOf(e)<0)return G.SHARE_TYPE_DISABLED;var r=t.getShareForm(e),a=(this.getRuleByType(e)||{}).share_methods||[];return[P.a.COMMAND,P.a.TEXT].indexOf(r)>=0?Object(x.c)(t.urlWrapType)&&t.marketActivityID&&(t.shortURLApi&&a.indexOf(j.a.LINK)>=0||t.shortCommandApi&&a.indexOf(j.a.CIPHER)>=0)?0:a.indexOf(j.a.NORMAL)>=0?0:G.SHARE_TYPE_DISABLED:[y.a.WECHAT_SESSION,y.a.WECHAT_TIMELINE].indexOf(e)>=0?Object(x.d)(t.urlWrapType)&&t.marketActivityID&&a.indexOf(j.a.DOMAIN)<0?G.SHARE_TYPE_DISABLED:a.indexOf(j.a.NORMAL)>=0?0:G.SHARE_TYPE_DISABLED:0}},{key:"setCipherDowngrade",value:function(e){this._isCipherDowngrade=e}},{key:"isCipherDowngrade",get:function(){return this._isCipherDowngrade}},{key:"rom",get:function(){return this._rom}},{key:"isSilentMode",get:function(){return this._enableSilentMode}}]),e}(),K=null;function Y(){return K||(K=new B),K}var F=r("NLvu");function Q(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Object(E.a)().isNativePlatform?z.apply(void 0,t).then(function(e){return e.missed?H.b.apply(void 0,t):e}):H.b.apply(void 0,t)}var z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.shareURL||"",r=e.urlWrapType;return e.marketActivityID&&e.activitySceneSn&&r===x.a.SERVER_TP_APP?Object(F.b)(Object.assign({rom:Y().rom},e),e.tpSelectCategory).then(function(e){return{tpInfo:e,tpDowngrade:!e,realShareURL:(e||{}).link_url||t,targetShareURL:t}},function(e){return Promise.resolve({tpDowngrade:!0,realShareURL:t,targetShareURL:t})}):e.activitySceneSn&&r===x.a.SERVER_TP_APP_CARD?Object(F.c)(Object.assign({rom:Y().rom},e),e.tpSelectCategory).then(function(e){return{tpInfo:e,tpDowngrade:!e,realShareURL:(e||{}).link_url||t,targetShareURL:t}},function(e){return Promise.resolve({tpDowngrade:!0,realShareURL:t,targetShareURL:t})}):Promise.resolve({missed:!0,realShareURL:t,targetShareURL:t})},q=r("XfDS"),X=r("Upw4"),V=r("bbLm");function J(){return Z.apply(this,arguments)}function Z(){return(Z=L()(C.a.mark(function e(){var t,r,a,n=arguments;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:{},"function"==typeof(r=n.length>1?n[1]:void 0).cipherProcessor){e.next=4;break}return e.abrupt("return",t);case 4:return e.prev=4,e.next=7,r.cipherProcessor({cipherText:t.title,cipherCode:t.cipher,shareEntity:r});case 7:"string"==typeof(a=e.sent)&&(t.title=t.desc=a),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}},e,null,[[4,11]])}))).apply(this,arguments)}function $(e){return function(){var t,r=l()(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=l()(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return p()(this,t)}}var ee=function(e){c()(r,e);var t=$(r);function r(e){var a;return n()(this,r),(a=t.call(this,e)).drawImageOptions=e.drawImageOptions,a.redirectURI=e.redirectURI||"",a.miniObjectPath=e.miniObjectPath||"",a.miniObjectID=e.miniObjectID,a.useWxAppShare=e.useWxAppShare||!1,a.forceDowngrade=e.forceDowngrade||!1,a.excludeShareChoices=e.excludeShareChoices||[],a.thirdPartyOpenType=e.thirdPartyOpenType,a.drawImageClass=e.drawImageClass,a.needSharedAmount=e.needSharedAmount||!1,a.cipherScene=e.cipherScene,a.activitySceneSn=e.activitySceneSn,a.tpSelectCategory=e.tpSelectCategory,a.pinTimelineParams=e.pinTimelineParams,a}return s()(r,[{key:"normalize",value:function(){var e=L()(C.a.mark(function e(t){var r,a,n,i,s,h,o,u,c=this;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==y.a.COPY_CIPHER){e.next=2;break}return e.abrupt("return",this.processCipher());case 2:if(r=Object.assign({},this),t!==y.a.PIN_TIMELINE){e.next=5;break}return e.abrupt("return",r.pinTimelineParams);case 5:a={title:r.title,desc:r.message,thumbnail:r.thumbnailURL,share_url:r.shareURL,share_id:r.shareID},r.payloadMixin&&(n=r.payloadMixin.extra,"object"===g()(n)&&void 0!==n.share_prefer&&(a.share_prefer=n.share_prefer)),i=!1,e.t0=t,e.next=e.t0===y.a.WECHAT_SESSION?11:e.t0===y.a.WECHAT_TIMELINE_IMAGE?14:e.t0===y.a.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK?14:e.t0===y.a.WECHAT_SESSION_IMAGE?14:e.t0===y.a.QQ_CHAT_SESSION_IMAGE?14:e.t0===y.a.QQ_ZONE_IMAGE?14:e.t0===y.a.WEIBO_IMAGE?14:e.t0===y.a.WECHAT_SESSION_IMAGE_WITH_NO_SDK?14:e.t0===y.a.WECHAT_SESSION_IMAGES_WITH_NO_SDK?17:e.t0===y.a.SHARE_IMAGE_PASSIVELY?20:e.t0===y.a.IOS_SYSTEM_SHARE_CARD?24:e.t0===y.a.WECHAT_SESSION_CARD_WITH_NO_SDK?24:e.t0===y.a.WECHAT_TIMELINE_CARD_WITH_NO_SDK?24:26;break;case 11:if(r.miniObjectPath&&"string"==typeof r.miniObjectPath)a.mini_object_path=Object(V.a)(r);else if("function"==typeof r.miniObjectPath)try{a.mini_object_path=r.miniObjectPath(r.shareURL)}catch(e){}return r.miniObjectID&&(a.mini_object_id=r.miniObjectID),e.abrupt("break",27);case 14:return i=!0,a.options=r.drawImageOptions,e.abrupt("break",27);case 17:return i=!0,a.multi_image_options=r.drawImageOptions,e.abrupt("break",27);case 20:return i=!0,a.options=r.drawImageOptions,r.thirdPartyOpenType&&(a.open_type=r.thirdPartyOpenType),e.abrupt("break",27);case 24:return a.excluded_types=r.excludeShareChoices,e.abrupt("break",27);case 26:return e.abrupt("break",27);case 27:if(s=this.getShareForm.call(r,t),h=[P.a.COMMAND,P.a.TEXT].indexOf(s)>=0,this.targetShareURL=r.shareURL,this.realShareURL=r.shareURL,this.useShortURL=!1,t===y.a.WECHAT_SESSION&&a.mini_object_path&&(this.realShareURL=a.mini_object_path),Object(X.a)(t)&&(o=Object(H.a)(t,r.shareURL),a.share_url=o,this.shareURL=o,this.realShareURL=o,this.targetShareURL=o),t===y.a.WECHAT_SESSION&&a.mini_object_path&&(this.realShareURL=this.targetShareURL=a.mini_object_path),s!==P.a.CARD&&s!==P.a.WXAPP_CARD){e.next=39;break}return e.abrupt("return",Q(r).then(function(e){var t=e.realShareURL,n=e.targetShareURL,i=e.useShortURL,s=e.tpDowngrade,h=e.tpInfo,o=e.appendQuery;return e.useCipher?Promise.reject(new Error("operation refused")):(c.useShortURL=i,c.realShareURL=t,c.targetShareURL=n,a.share_url=t,h&&(a.title=h.title||a.title,a.desc=h.message||a.desc),a.tpInfo=h,a.tpDowngrade=s,r.urlWrapType===x.a.SERVER_QUERY_APPEND&&"string"==typeof a.mini_object_path&&a.mini_object_path&&(a.mini_object_path=Object(V.a)({miniObjectPath:a.mini_object_path,shareURL:t},{appendQuery:o})),a)}));case 39:if(!i||!Object(x.c)(r.urlWrapType)&&r.urlWrapType!==x.a.MAGIC_TRACE&&r.urlWrapType!==x.a.MAGIC_TRACE_DYNAMIC){e.next=43;break}return e.abrupt("return",Q(r).then(function(e){var t=e.realShareURL,n=e.targetShareURL,i=e.useShortURL,s=e.shareText;return c.targetShareURL=n,r.shortCommandApi?(c.pcode=s,a.share_url=s):(c.useShortURL=i,c.realShareURL=t,a.share_url=i?Object(q.a)(t):t),a}));case 43:if(!h){e.next=54;break}if(u=a.title||"",!Object(x.c)(r.urlWrapType)){e.next=49;break}return e.abrupt("return",Q(r).then(function(e){var t=e.realShareURL,n=e.targetShareURL,i=e.useShortURL,s=e.shareText,h=e.shareID,o=e.cipher;if(h&&(a.shareID=h),o&&(a.cipher=o),c.targetShareURL=n,r.shortCommandApi){var _=i||o?s:"",p=_||n;u=Object(D.b)(u,p,n,_),a.title=a.desc=u,c.pcode=u}else{var S=i?t:"",l=S||n;u=Object(D.b)(u,l,n,S),a.title=a.desc=u,c.useShortURL=i,c.realShareURL=l}return J(a,r)}));case 49:return u=Object(D.b)(u,r.shareURL),a.title=a.desc=u,e.abrupt("return",J(a,r));case 52:e.next=55;break;case 54:return e.abrupt("return",Promise.resolve(a));case 55:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getShareForm",value:function(e){return e===y.a.WECHAT_SESSION?this.miniObjectPath||this.useWxAppShare?P.a.WXAPP_CARD:P.a.CARD:[4,2,5,6,24,25].includes(e)?P.a.CARD:[8,9,10,11,12,13,15,19,20,22].includes(e)?P.a.IMAGE:[3,16,17,21,y.a.COPY_CIPHER].includes(e)?this.shortCommandApi?P.a.COMMAND:P.a.TEXT:e===y.a.COPY_LINK?P.a.COPY_LINK:P.a.DEFAULT}},{key:"getShareMethod",value:function(e){return[9,16,19,20].includes(e)?N.a.SYSTEM:[1,2,3,4,5,8,10,11,12,13,15,17,21,24,25].includes(e)?N.a.SDK:e===y.a.SHARE_IMAGE_PASSIVELY?this.thirdPartyOpenType?N.a.MANUAL:N.a.DEFAULT:e===y.a.COPY_CIPHER?N.a.MANUAL:N.a.DEFAULT}}]),r}(D.a),te=r("A4fa"),re=r("WiBJ");function ae(e){return function(){var t,r=l()(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=l()(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return p()(this,t)}}var ne=Object.keys(y.a).map(function(e){return y.a[e]}).filter(function(e){return[y.a.WECHAT_BIG_IMAGE].indexOf(e)<=0}),ie=function(e){c()(r,e);var t=ae(r);function r(e){var a;return n()(this,r),(a=t.call(this,e)).ShareEntityClass=ee,a._enableShareTypes=ne.concat(),a.shareLimiter=Y(),a._isEnableShareCheck=!1,a.setShareCheck(!0),a}return s()(r,[{key:"setShareCheck",value:function(e){Object(E.a)().isTinyNativePlatform?this._isEnableShareCheck=!0:this._isEnableShareCheck=!!e&&Object(d.h)()}},{key:"checkShareTypeEnable",value:function(e){var t=this.getShareEntityByShareType(e);if(!this.validateShareParams(e,t))return I.a.SHARE_PARAMS_NOT_VALID;if(!Object(d.d)(e)||this._enableShareTypes.indexOf(e)<0)return I.a.SHARE_TYPE_DISABLED;if(this._isEnableShareCheck&&[y.a.COPY_LINK,y.a.COPY_CIPHER].indexOf(e)<0){var r=this.shareLimiter.checkSync(e,t);if(r)return r}return 0}},{key:"share",value:function(e){var t=this.checkShareTypeEnable(e);return t||(e===y.a.PIN_TIMELINE?this._sharePinTimeline(e):e===y.a.WECHAT_BIG_IMAGE?this._nativeShareBigImage(e):[y.a.WECHAT_SESSION,y.a.WECHAT_TIMELINE,y.a.WEIBO,y.a.QQ_CHAT_SESSION,y.a.QQ_ZONE,y.a.TENCENT_WEIBO,y.a.WECHAT_SESSION_APP,y.a.FRIENDS,y.a.WECHAT_SESSION_MUSIC,y.a.WECHAT_SESSION_VIDEO].indexOf(e)>=0?this._nativeShareCard(e):[y.a.WECHAT_TIMELINE_IMAGE,y.a.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK,y.a.WECHAT_SESSION_IMAGE,y.a.QQ_CHAT_SESSION_IMAGE,y.a.QQ_ZONE_IMAGE,y.a.WEIBO_IMAGE,y.a.WECHAT_SESSION_IMAGE_WITH_NO_SDK,y.a.SHARE_IMAGE_PASSIVELY].indexOf(e)>=0?this._nativeShareImage(e):[y.a.WECHAT_SESSION_TEXT_WITH_NO_SDK,y.a.WECHAT_SESSION_TEXT,y.a.WECHAT_TIMELINE_TEXT].indexOf(e)>=0?this._nativeShareText(e):y.a.COPY_LINK===e?this._nativeShareClipboard(e):y.a.COPY_CIPHER===e?this.copyCipher():I.a.SHARE_TYPE_NOT_FOUND)}},{key:"validateShareParams",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!0}},{key:"_setupShareTypes",value:function(){}},{key:"resetLimiter",value:function(){return this.shareLimiter.reset(),this._queryShareTypePromise=null,this.waitShareLimiter()}},{key:"refreshShare",value:function(e,t){var a=o()(l()(r.prototype),"refreshShare",this).call(this,e,t);return this.emit(A.a.ON_SHARE_PREPARE,{shareType:t}),a}},{key:"_setupPlatformShareSDK",value:function(){return this.waitShareLimiter()}},{key:"waitShareLimiter",value:function(){var e=this;return this._isEnableShareCheck?(this._queryShareTypePromise||(this._queryShareTypePromise=this.shareLimiter.build().catch(function(t){return e.emit(A.a.SHARE_LIMIT_LOAD_FAIL),Promise.resolve()})),this._queryShareTypePromise):Promise.resolve()}},{key:"_nativeShareCard",value:function(e){var t=this;this.emit(A.a.ON_SHARE_TRIGGER,{shareType:e});var r=this.getShareEntityByShareType(e);return r.normalize(e).then(function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=a.tpInfo,i=a.tpDowngrade;if(delete a.tpInfo,delete a.tpDowngrade,i||n&&!n.dev_app)t.emit(A.a.ON_SHARE_COMPLETED,{shareType:e,shareResultType:m.a.FAIL,tpDowngrade:!0,tpInfo:n});else{var s=Object.assign({type:e,redirect_uri:r.redirectURI||"",share_params:a,share_method:Object(re.a)(r,e)});r.needSharedAmount&&(s.show_check_detail=1),n&&n.dev_type&&(s.dev_app=n.dev_app,s.dev_type=n.dev_type),t._invokeNativeShare(s,function(r){t.emit(A.a.ON_SHARE_COMPLETED,{shareType:e,shareResultType:m.a.SUCCESS,responseData:r,tpInfo:n})},function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=parseInt(r.errorCode,10)||0,i=a===d.c.USER_CANCEL?m.a.CANCEL:m.a.FAIL;t.emit(A.a.ON_SHARE_COMPLETED,{shareType:e,shareResultType:i,nativeShareErrorCode:a,responseData:r.data,tpInfo:n})})}},this.getNormalizeErrorHandler(e)),0}},{key:"_nativeShareImage",value:function(e){var t=this;this.emit(A.a.ON_SHARE_TRIGGER,{shareType:e});var r=this.getShareEntityByShareType(e),a=e;return r.normalize(e).then(function(n){var i={type:a,share_params:n,share_method:Object(re.a)(r,e)},s=!1;a===y.a.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK&&(i.complete=function(){t.emit(A.a.ON_SHARE_COMPLETED,{shareType:e,useComplete:!0,shareResultType:m.a.SUCCESS})},s=!0),t._invokeNativeShare(i,function(r){!s&&t.emit(A.a.ON_SHARE_COMPLETED,{shareType:e,shareResultType:m.a.SUCCESS,responseData:r})},function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=parseInt(r.errorCode,10),n=a===d.c.USER_CANCEL?m.a.CANCEL:m.a.FAIL;!s&&t.emit(A.a.ON_SHARE_COMPLETED,{shareType:e,shareResultType:n,nativeShareErrorCode:a,responseData:r.data})})},this.getNormalizeErrorHandler(e)),0}},{key:"_nativeShareText",value:function(e){var t=this,r=this.getShareEntityByShareType(e),a=r.cipherScene&&"string"==typeof r.cipher;!a&&this.emit(A.a.ON_SHARE_TRIGGER,{shareType:e});var n=e;return r.normalize(e).then(function(i){a&&(t.emit(A.a.ON_SHARE_TRIGGER,{shareType:e,shareID:i.shareID}),delete i.shareID);var s=Object.assign({type:n,share_params:i,share_method:Object(re.a)(r,e)}),h=!1;if(r.forceDowngrade||Object(E.a)().system===f.b.IOS&&n===y.a.WECHAT_SESSION_TEXT_WITH_NO_SDK)return t.emit(A.a.ON_SHARE_COMPLETED,{shareType:e,shareResultType:m.a.FAIL,shareParams:i}),0;Object(E.a)().system===f.b.Android&&n===y.a.WECHAT_SESSION_TEXT_WITH_NO_SDK&&(s.complete=function(){t.emit(A.a.ON_SHARE_COMPLETED,{shareType:e,useComplete:!0,shareResultType:m.a.SUCCESS})},h=!0),t._invokeNativeShare(s,function(r){!h&&t.emit(A.a.ON_SHARE_COMPLETED,{shareType:e,shareResultType:m.a.SUCCESS,responseData:r})},function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=parseInt(r.errorCode,10)||0,n=a===d.c.USER_CANCEL?m.a.CANCEL:m.a.FAIL;!h&&t.emit(A.a.ON_SHARE_COMPLETED,{shareType:e,shareResultType:n,nativeShareErrorCode:a,responseData:r.data})})},this.getNormalizeErrorHandler(e)),0}},{key:"_nativeShareBigImage",value:function(e){return I.a.SHARE_TYPE_DISABLED}},{key:"_nativeShareClipboard",value:function(e){var t=this;this.emit(A.a.ON_SHARE_TRIGGER,{shareType:e});var r=this.getShareEntityByShareType(e);return r.normalize(e).then(function(){var a=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).share_url||r.shareURL;(Object(E.a)().isNativePlatform?new Promise(function(e,t){Object(T.g)("JSStorage","getPasteboard",null).then(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(t.text)})}):Promise.reject()).then(null,function(){return Promise.resolve("")}).then(function(r){(function(e){return"string"!=typeof e?Promise.reject():Object(E.a)().isNativePlatform?Object(T.g)("JSStorage","setPasteboard",{text:e}):Promise.reject()})(a).then(function(){t.emit(A.a.ON_SHARE_COMPLETED,{shareType:e,shareResultType:m.a.SUCCESS,content:a,originContent:r})},function(){t.emit(A.a.ON_SHARE_COMPLETED,{shareType:e,shareResultType:m.a.FAIL,content:a,originContent:r})})})},this.getNormalizeErrorHandler(e)),0}},{key:"_sharePinTimeline",value:function(e){var t=this;return this.emit(A.a.ON_SHARE_TRIGGER,{shareType:e}),this.getShareEntityByShareType(e).normalize(e).then(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=Object.assign({type:e,share_params:r});t._invokeNativeShare(a,function(r){t.emit(A.a.ON_SHARE_COMPLETED,{shareType:e,shareResultType:m.a.SUCCESS,responseData:r})},function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=parseInt(r.errorCode,10)||0;t.emit(A.a.ON_SHARE_COMPLETED,{shareType:e,shareResultType:m.a.FAIL,nativeShareErrorCode:a,responseData:r.data})})},this.getNormalizeErrorHandler(e)),0}},{key:"setupNativeShareButton",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.shareIcon,a=void 0===r?d.a:r,n=t.shareIconSize,i=void 0===n?d.b:n;return"string"!=typeof a||"number"!=typeof i?I.a.SHARE_PARAMS_NOT_VALID:(Object(T.g)("JSUIControl","setRightBarButtons",{buttons:[{icons:{normal:a},callback:function(){e.emit(A.a.ON_SHARE_BUTTON_CLICKED)},size:i}]}).catch(function(e){}),0)}},{key:"_invokeNativeShare",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,a=Object(d.g)(),n="share",i=Object(M.f)()+"";this._isEnableShareCheck?(e=Object.assign({origin:"h5",page_sn:i,page_info:{page_name:Object(M.e)(),page_url:location&&location.href}},e),this.shareLimiter.getAppOptional()&&(e.app_optional=this.shareLimiter.getAppOptional()),n="performShare"):e.page_sn=i,Object(T.g)(a,n,e).then(t,r)}},{key:"shareCipherManually",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:te.a.OPEN_WECHAT;return e&&"string"==typeof e?Object(d.e)()?(t!==te.a.OPEN_WECHAT&&t!==te.a.OPEN_WECHAT_IOS_SILENT&&t!==te.a.OPEN_WECHAT_ANDROID_SILENT||(t=Object(d.f)()&&this.shareLimiter.isSilentMode?Object(E.a)().system===f.b.IOS?te.a.OPEN_WECHAT_IOS_SILENT:te.a.OPEN_WECHAT_ANDROID_SILENT:te.a.OPEN_WECHAT),Object(T.g)(Object(d.g)(),"shareCipher",{cipher:e,open_type:t})):Promise.reject(new Error("not support")):Promise.reject(new Error("invalid cipher"))}}]),r}(O.a);t.default=ie}}]);
//# sourceMappingURL=http://vgunxpkt.com/sourcemaps/mobile-expert/js/ms_native_c_de4db7ccf7da527bc396.js.map