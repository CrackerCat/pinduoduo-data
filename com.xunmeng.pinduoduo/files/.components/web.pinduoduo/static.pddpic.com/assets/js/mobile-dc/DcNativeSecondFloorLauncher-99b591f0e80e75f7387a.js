(self.webpackChunk_name_mobile_dc=self.webpackChunk_name_mobile_dc||[]).push([["9365"],{"2RIe":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return z}});var n,o,i,u=r("lrCg"),c=r.n(u),a=r("xeO4"),s=r.n(a),l=r("U5BY"),f=r.n(l),d=r("hwDT"),h=r.n(d),p=r("f6/u"),v=r.n(p),y=r("f17R"),S=r.n(y),m=r("Vl5s"),b=r.n(m),g=r("T6n4"),k=r.n(g),w=r("KdYu"),R=r("iuwq"),x=r("H9sm"),L=r("VCAa"),D=r("jNwH"),F=r("9vur"),C=r("7eD0"),P=r("A3+/"),O=r("L0qb"),_=1,E=2,K=3,T=5,U=r("0Qln"),j=r.n(U),q=r("i/Q6"),A=r.n(q),W=r("jXLS"),G=r.n(W),I=(r("XC3m"),r("UK90"));function M(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var V,X,Y,B=(n=function(e){v()(n,e);var t,r=(t=n,function(){var e,r=b()(t);if(M()){var n=b()(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return S()(this,e)});function n(){var e;f()(this,n);for(var t=arguments.length,u=new Array(t),c=0;c<t;c++)u[c]=arguments[c];return e=r.call.apply(r,[this].concat(u)),j()(e,"url",o,A()(e)),j()(e,"enablePullDown",i,A()(e)),e}return h()(n)}(r("wfOt").Z),o=G()(n.prototype,"url",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),i=G()(n.prototype,"enablePullDown",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),n);function Q(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var z=(0,P.G)(!0)(V=(0,w.inject)("store")(V=(0,w.observer)((Y=X=function(e){v()(i,e);var t,r,n,o=(t=i,function(){var e,r=b()(t);if(Q()){var n=b()(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return S()(this,e)});function i(){var e;f()(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call.apply(o,[this].concat(r))).successfullyLoaded=!1,e.currentState=_,e.inited=!1,e.removeRedPocketRainListener=void 0,e.removeShakeListener=void 0,e.removeOnSecondFloorOpenListener=void 0,e.removeSecondFloorCloseListener=void 0,e.removeOnSecondFloorReadyListener=void 0,e.removeTimeoutDetection=void 0,e.destroySecondFloor=void 0,e.logError=function(t){-999!==t&&e.store.logError(t)},e.onShake=s()(k().mark((function t(){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.base){t.next=2;break}return t.abrupt("return");case 2:return e.toggleCurrentState(K),t.next=5,(0,D.Kx)();case 5:return t.next=7,(0,F._)(100);case 7:return t.next=9,e.showSecondFloor(!0);case 9:t.sent?(0,O.Ed)():e.toggleCurrentState(_);case 11:case"end":return t.stop()}}),t)}))),e.onSecondFloorClose=function(){e.toggleCurrentState(_)},e.onSecondFloorOpen=function(t){t||e.store.logError(t),t.isGuideLayerOpen===O.tg.secondFloor&&e.toggleCurrentState(T)},e.onSecondFloorReady=function(){e.successfullyLoaded=!0,e.store.enablePullDown&&e.showGuide()},e.init=s()(k().mark((function t(){var r,n,o,i,u,a;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.inited){t.next=2;break}return t.abrupt("return");case 2:return e.inited=!0,t.prev=3,t.next=6,Promise.all([(0,O.Wm)(e.onShake),(0,O.qV)(e.onSecondFloorOpen),(0,O.WB)(e.onSecondFloorClose),(0,O.Ew)(e.onSecondFloorReady)]);case 6:return r=t.sent,n=c()(r,4),o=n[0],i=n[1],u=n[2],a=n[3],e.removeShakeListener=o,e.removeOnSecondFloorOpenListener=i,e.removeSecondFloorCloseListener=u,e.removeOnSecondFloorReadyListener=a,t.next=18,(0,O.JL)({url:e.store.url,disablePullToEnterSecondFloor:!e.store.enablePullDown,onSecondFloorReady:e.onSecondFloorReady});case 18:e.destroySecondFloor=t.sent,t.next=24;break;case 21:t.prev=21,t.t0=t.catch(3),6e4!==t.t0&&e.store.logError(t.t0);case 24:case"end":return t.stop()}}),t,null,[[3,21]])}))),e}return h()(i,[{key:"guideKey",get:function(){return"dc_second_floor_guide_".concat(this.rootStore.promotion_id)}},{key:"hasPDDPopupManager",get:function(){var e,t,r=null===(e=this.rootStore.getComponentByKeyReg(/(Dc)?PDDPopupManager/))||void 0===e||null===(t=e[0])||void 0===t?void 0:t.store;return!!r&&(!((void 0===r.needLogin||r.needLogin)&&!this.rootStore.userHasLogin())&&!r.$redPocketRainEnd)}},{key:"isIdleState",get:function(){return this.currentState===_}},{key:"base",get:function(){return this.successfullyLoaded&&this.isIdleState&&(0,C.Lu)()}},{key:"toggleCurrentState",value:function(e){this.currentState=e}},{key:"showSecondFloor",value:(n=s()(k().mark((function e(){var t=arguments;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.rR.apply(void 0,t);case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e.catch(0),this.logError(e.t0),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return n.apply(this,arguments)})},{key:"showGuide",value:(r=s()(k().mark((function e(){var t,r;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.scrollY,r=(0,L.S3)().height,!(!x.me.getRecord(this.guideKey)&&this.base&&t<r/2)){e.next=19;break}return this.toggleCurrentState(E),e.next=7,(0,D.Kx)();case 7:return e.next=9,(0,F._)(200);case 9:return e.prev=9,e.next=12,(0,O.t$)();case 12:x.me.saveRecord(this.guideKey),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(9),this.toggleCurrentState(_),this.logError(e.t0);case 19:case"end":return e.stop()}}),e,this,[[9,15]])}))),function(){return r.apply(this,arguments)})},{key:"timeoutDetection",value:function(){var e=this,t=setTimeout((function(){e.successfullyLoaded||e.store.logError("二楼加载超时，可能是未配置二楼展示组件")}),3e4);this.removeTimeoutDetection=function(){clearTimeout(t)}}},{key:"onInit",value:function(e){var t=this;this.hasPDDPopupManager?this.removeRedPocketRainListener=(0,O.a$)(e,(function(e){t.store.logError(e)})):e()}},{key:"componentDidMount",value:function(){this.onInit(this.init)}},{key:"componentWillUnmount",value:function(){var e,t,r,n,o,i,u;null===(e=this.removeRedPocketRainListener)||void 0===e||e.call(this),null===(t=this.removeShakeListener)||void 0===t||t.call(this),null===(r=this.removeOnSecondFloorOpenListener)||void 0===r||r.call(this),null===(n=this.removeSecondFloorCloseListener)||void 0===n||n.call(this),null===(o=this.removeOnSecondFloorReadyListener)||void 0===o||o.call(this),null===(i=this.removeTimeoutDetection)||void 0===i||i.call(this),null===(u=this.destroySecondFloor)||void 0===u||u.call(this)}},{key:"render",value:function(){return null}}]),i}(R.Z),X.Store=B,V=Y))||V)||V)||V},"A3+/":function(e,t,r){"use strict";r.d(t,{G:function(){return K}});var n=r("0Qln"),o=r.n(n),i=r("U5BY"),u=r.n(i),c=r("hwDT"),a=r.n(c),s=r("i/Q6"),l=r.n(s),f=r("f6/u"),d=r.n(f),h=r("f17R"),p=r.n(h),v=r("Vl5s"),y=r.n(v),S=r("jXLS"),m=r.n(S),b=(r("XC3m"),r("xeO4")),g=r.n(b),k=r("T6n4"),w=r.n(k),R=r("9bdW"),x=r.n(R),L=r("KdYu"),D=r("UK90"),F=r("CLTR"),C=r("L0qb"),P=r("KVD2"),O=r.n(P);function _(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var E=function(){var e=g()(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,F.b4)("getUnoContext");case 3:return t=e.sent,e.abrupt("return",1===(null==t?void 0:t.is_second_floor_container));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),K=function(e){return function(t){var r,n,i,c,s,f=(0,L.inject)("store")(r=(0,L.observer)((s=c=function(r){d()(f,r);var n,c,s=(n=f,function(){var e,t=y()(n);if(_()){var r=y()(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return p()(this,e)});function f(){var e;u()(this,f);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=s.call.apply(s,[this].concat(r))).inited=!1,o()(e,"show",i,l()(e)),e}return a()(f,[{key:"rootStore",get:function(){return this.props.store}},{key:"setShow",value:function(e){this.show=e}},{key:"componentDidMount",value:(c=g()(w().mark((function t(){var r;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.rootStore.requestContext,(0,C.Xs)(r.platform)){t.next=3;break}return t.abrupt("return");case 3:if(!e){t.next=10;break}if((0,C.WC)(r.queries)){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,E();case 8:if(t.sent){t.next=10;break}return t.abrupt("return");case 10:if(!f.hasLoadSecondFloor){t.next=12;break}return t.abrupt("return");case 12:f.hasLoadSecondFloor=!0,this.inited=!0,this.setShow(!0);case 15:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"render",value:function(){return this.show?x().createElement(t,this.props):null}},{key:"componentWillUnmount",value:function(){this.inited&&(f.hasLoadSecondFloor=!1)}}]),f}(x().Component),c.hasLoadSecondFloor=!1,n=s,i=m()(n.prototype,"show",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m()(n.prototype,"setShow",[D.action],Object.getOwnPropertyDescriptor(n.prototype,"setShow"),n.prototype),r=n))||r)||r;return O()(f,t)}}}}]);
//# sourceMappingURL=http://vgunxpkt.com/sourcemaps/assets/js/mobile-dc/DcNativeSecondFloorLauncher-99b591f0e80e75f7387a.js.map