(self.webpackChunk_name_mobile_dc=self.webpackChunk_name_mobile_dc||[]).push([["4388"],{v005:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return te}});var r,o,i,a=n("/4JS"),c=n.n(a),s=n("xeO4"),u=n.n(s),l=n("U5BY"),p=n.n(l),f=n("hwDT"),d=n.n(f),h=n("f6/u"),g=n.n(h),v=n("f17R"),m=n.n(v),w=n("Vl5s"),b=n.n(w),P=n("T6n4"),S=n.n(P),y=n("9bdW"),k=n.n(y),L=n("0Qln"),x=n.n(L),_=n("i/Q6"),O=n.n(_),I=n("jXLS"),C=n.n(I),E=(n("XC3m"),n("wfOt")),R=n("UK90");function T(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var D,N=(r=function(e){g()(r,e);var t,n=(t=r,function(){var e,n=b()(t);if(T()){var r=b()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return m()(this,e)});function r(){var e;p()(this,r);for(var t=arguments.length,a=new Array(t),c=0;c<t;c++)a[c]=arguments[c];return e=n.call.apply(n,[this].concat(a)),x()(e,"needLogin",o,O()(e)),x()(e,"isInline",i,O()(e)),e}return d()(r)}(E.Z),o=C()(r.prototype,"needLogin",[R.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),i=C()(r.prototype,"isInline",[R.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),r),j=N,H=n("VCAa"),F=n("KdYu"),B=n("brkN"),M=n.n(B),W=n("pQHD"),q=n.n(W),A=n("ot0u"),J=n("iOT4"),K=n("iuwq"),Q=n("CLTR"),z=n("cp0F"),U=n.n(z);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Z="p-Zkb7NnkK8",$=!1,G=!1,ee=(0,F.inject)("store")(D=function(e){g()(o,e);var t,n,r=(t=o,function(){var e,n=b()(t);if(Y()){var r=b()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return m()(this,e)});function o(){var e;p()(this,o);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=r.call.apply(r,[this].concat(n))).dealAfterCallPddPopup=function(t){e.isMissionPage=(e.rootStore.requestContext.queries||{})._x_popup_mission_id,e.hasPopup=1==+(null==t?void 0:t.result),null!=t&&t.result&&!e.isMissionPage||(e.store.$redPocketRainEnd=!0),(0,Q.lW)("DCHighlayerShowNotification",{result:e.hasPopup?1:0,type:e.isMissionPage?"browse_mission":"red_pocket_rain"}),e.registerNotification(),e.isMissionPage&&e.openScrollInform()},e.callPopup=u()(S().mark((function t(){var n;return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,J.Dt)()){t.next=5;break}(0,Q.Hv)({}),e.toShowFloatWindow(),t.next=10;break;case 5:return t.next=7,(0,Q.Hv)({});case 7:n=t.sent,!(n&&n.result)&&e.toShowFloatWindow();case 10:case"end":return t.stop()}}),t)}))),e.toShowFloatWindow=u()(S().mark((function t(){var n,r,o;return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,J.Dt)()){t.next=17;break}return t.next=3,(0,Q.Vb)({});case 3:if(n=t.sent,r=(n||{}).popupInfo,o=r,"string"!=typeof r){t.next=14;break}t.prev=7,o=JSON.parse(r),t.next=14;break;case 11:return t.prev=11,t.t0=t.catch(7),t.abrupt("return");case 14:o&&99==+o.global_id&&(0,Q.kI)({}),t.next=19;break;case 17:localStorage.getItem("fullbackFloatQualification")&&((0,Q.kI)({}),e.pageShowListener=(0,Q.Q)((function(){return(0,Q.kI)({})})));case 19:case"end":return t.stop()}}),t,null,[[7,11]])}))),e.openScrollInform=function(){document.addEventListener("scroll",e.handleScroll),document.addEventListener("touchend",e.handleScrollEnd)},e.handleScroll=M()((function(){e.sendScrollInform("touchmove"),e.isScrollEnd(),e.t1=document.documentElement.scrollTop||document.body.scrollTop}),100),e.handleScrollEnd=function(){e.sendScrollInform("touchend")},e.isScrollEnd=q()((function(){e.t2=document.documentElement.scrollTop||document.body.scrollTop,+e.t2==+e.t1&&e.sendScrollInform("touchend")}),500),e.sendScrollInform=M()((function(t){(0,Q.lW)("onPageTouchEvent",{pageSn:e.rootStore.trackingBase.pageSn,eventType:t})}),800),e.registerNotification=function(){36705==+e.rootStore.trackingBase.pageSn&&!e.lotCompleteListener&&(e.lotCompleteListener=(0,Q.sK)((function(){(0,H.X5)(Z)}))),e.hasPopup&&!e.hideListener&&(e.hideListener=(0,Q.nx)(e.hidePromotion)),e.hasPopup&&!e.showListener&&(e.showListener=(0,Q.aq)(e.showPromotion)),(0,J.zh)()&&!e.callFloatListener&&(e.callFloatListener=(0,Q.x2)(e.toShowFloatWindow))},e.trackingLogger=function(t){e.store.logCMTC(X({groupId:"10654",url:"attendance.html"},t))},e.heartbeatsHandler=function(){clearTimeout(e.heartbeatsTimer),e.heartbeatsTimer=setTimeout((function(){e.trackingLogger({stage:"heartbeats_stop"}),e.showPromotion()}),1500)},e.clearRPRHeartbeatsListener=function(){var t,n;null===(t=(n=e).removeHbListener)||void 0===t||t.call(n),e.removeHbListener=null,clearTimeout(e.heartbeatsTimer)},e.hidePromotion=function(){$||($=!0,e.trackingLogger({stage:"dc_hide_promotion"}),(0,J.Dt)()&&(e.removeHbListener=(0,Q.KY)(e.heartbeatsHandler)));var t=document.getElementById("app");t&&(t.style.display="none")},e.showPromotion=function(){!G&&$&&(e.clearRPRHeartbeatsListener(),G=!0,e.trackingLogger({stage:"dc_show_promotion"}));var t=document.getElementById("app");t&&(t.style.display="block")},e}return d()(o,[{key:"shouldSkip",value:function(){return!(!this.store.needLogin||this.rootStore.userHasLogin())||(!this.rootStore.requestContext.platform.isNativePlatform||(!this.rootStore.trackingBase||void 0))}},{key:"getNativePageContext",value:function(){var e={},t=this.rootStore.query;for(var n in t)n.startsWith("refer")||(e[n]=t[n]);return Object.assign(e,{page_name:this.rootStore.trackingBase.pageName,page_id:this.rootStore.trackingBase.page_id,page_sn:this.rootStore.trackingBase.pageSn})}},{key:"invokePddPopup",value:function(){var e=this;return new Promise((function(t){(0,A.callNative)("JSNavigation","setPageContext",e.getNativePageContext(),u()(S().mark((function e(){var n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Q.Hv)({});case 2:n=e.sent,t(n);case 4:case"end":return e.stop()}}),e)}))))}))}},{key:"componentDidMount",value:(n=u()(S().mark((function e(){var t;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.shouldSkip()){e.next=2;break}return e.abrupt("return");case 2:return window._dcPopupShowPromise=window._dcPopupShowPromise||this.invokePddPopup(),e.next=5,window._dcPopupShowPromise;case 5:t=e.sent,this.dealAfterCallPddPopup(t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){var e,t,n,r,o;null===(e=this.hideListener)||void 0===e||e.call(this),null===(t=this.showListener)||void 0===t||t.call(this),null===(n=this.pageShowListener)||void 0===n||n.call(this),null===(r=this.callFloatListener)||void 0===r||r.call(this),null===(o=this.lotCompleteListener)||void 0===o||o.call(this),this.isMissionPage&&(document.removeEventListener("scroll",this.handleScroll),document.removeEventListener("touchend",this.handleScrollEnd)),this.clearRPRHeartbeatsListener()}},{key:"render",value:function(){return k().createElement("div",{id:this.componentId},this.store.isInline&&!this.shouldSkip()&&k().createElement("script",{dangerouslySetInnerHTML:{__html:(e=this.getNativePageContext(),"\n(function(window) {\n    try {\n        if (typeof window === 'undefined' || !window.pinbridge || window._dcPopupShowPromise) return;\n        window._dcPopupShowPromise = new Promise(function(resolve, reject) {\n            pinbridge.callNative('JSNavigation', 'setPageContext', ".concat(U()(e),", function() {\n                pinbridge.callNative('PDDPopupManager', 'requestPopupAndShow', {}, function(popupInfo) {\n                    resolve(popupInfo);\n                });\n            });\n        });\n    } catch (e) {\n    }\n})(window)\n"))}}));var e}}]),o}(K.Z))||D;ee.Store=j;var te=ee},cp0F:function(e){"use strict";var t={"&":"\\u0026",">":"\\u003e","<":"\\u003c","\u2028":"\\u2028","\u2029":"\\u2029"},n=/[&><\u2028\u2029]/g;function r(e){return t[e]}e.exports=function(e){return JSON.stringify(e).replace(n,r)};var o={"\u2028":"\\u2028","\u2029":"\\u2029"},i=/[\u2028\u2029]/g;function a(e){return o[e]}e.exports.sanitize=function(e){return e.replace(i,a)}}}]);
//# sourceMappingURL=http://vgunxpkt.com/sourcemaps/assets/js/mobile-dc/PDDPopupManager-6e0d029177392ef39195.js.map