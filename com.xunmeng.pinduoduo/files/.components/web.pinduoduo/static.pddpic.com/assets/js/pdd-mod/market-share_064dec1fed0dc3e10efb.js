"use strict";(self.webpackChunkmobile_fun_cashback=self.webpackChunkmobile_fun_cashback||[]).push([[485],{49984:function(e,r,t){t.d(r,{H:function(){return i}});var n="funimg.pddpic.com",a="https://";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;return"".concat(a).concat(r).concat(e)}},76181:function(e,r,t){t.d(r,{J:function(){return n}});var n={CONSUME:0,CONSUME_TIME_DIVIDE:1,CONSUME_RAW:2,RECYCLE:3,RECYCLE_TIME_DIVIDE:4,RECYCLE_RAW:5,RECYCLE_TIME_DIVIDE_MULTI:6}},71975:function(e,r,t){t.d(r,{a:function(){return n}});var n={DEFAULT:0,SPECIAL:1}},60112:function(e,r,t){var n=t(71232),a=t(69870),i=t(84100),o=t(73897),s=t(1906),u=t(7680);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function c(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function l(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,r){return f=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},f(e,r)}function p(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=v(e);if(r){var a=v(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return _(this,t)}}function _(e,r){if(r&&("object"===h(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var y=a.Z.ShareErrorCode,d=function(e){!function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&f(e,r)}(h,e);var r,t,n,a=p(h);function h(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c(this,h),(e=a.call(this,r)).ShareEntityClass=i.Z,e._hasInited=!1,e.shareEntity=r.shareEntity,e.shareEntityMap=r.shareEntityMap||{},e.disableShareTypes=r.disableShareTypes||[],e}return r=h,t=[{key:"initShare",value:function(){this._hasInited||(this._hasInited=!0,this.setMaxListeners(0),this._setupShareTypes(),this._setupPlatformShareSDK())}},{key:"isInited",value:function(){return this._hasInited}},{key:"share",value:function(e){return y.SHARE_ACTION_DISABLE}},{key:"setShareCheck",value:function(e){}},{key:"checkShareTypeEnable",value:function(e){return 0}},{key:"_setupShareTypes",value:function(){return!0}},{key:"_setupPlatformShareSDK",value:function(){return Promise.resolve()}},{key:"getShareEntityByShareType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return e?this.shareEntityMap[e]||(r?null:this.shareEntity):this.shareEntity}},{key:"refreshShare",value:function(e,r){return e?(r?this.shareEntityMap[r]=e:this.shareEntity=e,this._setupPlatformShareSDK()):Promise.resolve()}},{key:"disableShare",value:function(e){var r=this;if(e&&"number"==typeof e)this.disableShareTypes.indexOf(e)<0&&this.disableShareTypes.push(e);else{if("[object Array]"!==Object.prototype.toString.call(e))return;this.disableShareTypes=this.disableShareTypes.concat(e.filter((function(e){return(r.disableShareTypes||[]).indexOf(e)<0})))}!this._setupShareTypes()&&this._adjustMenu()}},{key:"_adjustMenu",value:function(){}},{key:"createShareEntity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0,n=this.ShareEntityClass||i.Z;if(t)return new n(e);var a={};if(r){var o=this.shareEntityMap[r];a=o?Object.assign({},o,e):Object.assign({},this.shareEntity,e)}else a=Object.assign({},this.shareEntity,e);return new n(a)}},{key:"setupNativeShareButton",value:function(e){return y.SHARE_NOT_SUPPORTED}},{key:"copyCipher",value:function(){var e=this,r=o.Z.COPY_CIPHER,t=this.getShareEntityByShareType(r),n=t.cipherScene&&"string"==typeof t.cipher;return!n&&this.emit(s.Z.ON_SHARE_TRIGGER,{shareType:r}),t?(t.normalize(r).then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n&&(e.emit(s.Z.ON_SHARE_TRIGGER,{shareType:r,shareID:t.shareID}),delete t.shareID),e.emit(s.Z.ON_SHARE_COMPLETED,{shareType:r,shareResultType:u.Z.SUCCESS,content:t.title,rawResponse:t.rawResponse},e.getNormalizeErrorHandler(r))})),0):y.SHARE_PARAMS_NOT_VALID}},{key:"getNormalizeErrorHandler",value:function(e){var r=this;return function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];r.emit(s.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:u.Z.FAIL,errorPayload:n})}}},{key:"resetLimiter",value:function(){}}],t&&l(r.prototype,t),n&&l(r,n),h}(n.EventEmitter);r.Z=d},84100:function(e,r,t){t.d(r,{W:function(){return l}});var n=t(71538),a=t(80322),i=t(82851),o=t(54466),s=t(93556);function u(e,r,t,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void t(e)}s.done?r(u):Promise.resolve(u).then(n,a)}function h(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function c(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e){for(var r=[],t=1;t<arguments.length;++t)r.push(arguments[t]);return e.replace(/{(\d+)}/g,(function(e,t){return 0===r[t]?0:r[t]||""}))}var f=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};h(this,e),this.title=r.title||"",this.message=r.message||"",this.shareURL=r.shareURL||"",this.targetShareURL="",this.realShareURL="",this.shareDomain=r.shareDomain||"",this.thumbnailURL=r.thumbnailURL||"",this.timelineDomain=r.timelineDomain||"",this.timelineAppId=r.timelineAppId||"",this.marketActivityID=r.marketActivityID||0,this.urlWrapType=r.urlWrapType||a.ZP.DEFAULT,this.shortURLApi=r.shortURLApi||"",this.domainURLApi=r.domainURLApi||"",this.payloadMixin=r.payloadMixin||null,this.requestUsePost=r.requestUsePost||!1,this.shortCommandApi=r.shortCommandApi||"",this.cipherProcessor=r.cipherProcessor}var r,t,f,p,_;return r=e,t=[{key:"normalize",value:(p=regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({}));case 1:case"end":return e.stop()}}),e)})),_=function(){var e=this,r=arguments;return new Promise((function(t,n){var a=p.apply(e,r);function i(e){u(a,t,n,i,o,"next",e)}function o(e){u(a,t,n,i,o,"throw",e)}i(void 0)}))},function(e){return _.apply(this,arguments)})},{key:"setShareURLQueries",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.urlWrapType!==a.ZP.RAW&&(this.shareID=e.refer_share_id,this.shareURL=(0,n.Z)(e,this.shareURL))}},{key:"getShareForm",value:function(e){return i.Z.DEFAULT}},{key:"getShareMethod",value:function(e){return o.Z.DEFAULT}},{key:"processCipher",value:function(){var e=this,r=Object.assign({},this),t={title:r.title},n=t.title||"";return(0,s.Yy)(r).then((function(r){var a=r.targetShareURL,i=r.useShortURL,o=r.shareText,s=r.cipher;s&&(t.cipher=s),e.targetShareURL=a;var u=i||s?o:"";return n=l(n,u||a,a,u),t.title=n,e.pcode=n,t}))}}],t&&c(r.prototype,t),f&&c(r,f),e}();r.Z=f},69870:function(e,r,t){function n(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}t.d(r,{D:function(){return a}});var a={DEFAULT:0,SHARE_PARAMS_NOT_VALID:1,SHARE_TYPE_DISABLED:2,SHARE_TYPE_NOT_FOUND:3,SHARE_ACTION_DISABLE:4,SHARE_STATUS_ILLEGAL:5,SHARE_NOT_SUPPORTED:6,SHARE_LIMITER_NOT_INIT:7},i=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),this.errorCode=r.errorCode||a.DEFAULT,this.message=r.message||""};i.create=function(e){return new i({errorCode:e})},i.ShareErrorCode=a,r.Z=i},1906:function(e,r){r.Z={DEFAULT:0,ON_SHARE_TRIGGER:1,ON_SHARE_COMPLETED:2,SDK_INIT_FAILED:3,ON_SHARE_BUTTON_CLICKED:4,ON_SHARE_PREPARE:5,ON_SDK_READY:6,ON_SHARE_INTERRUPT:7,SHARE_LIMIT_LOAD_FAIL:8,PERFORM_LOG_FAILED:9,SHARE_REACH_LIMIT:10}},82851:function(e,r){r.Z={DEFAULT:"",COMMAND:"kouling",IMAGE:"image",TEXT:"text",CARD:"card",WXAPP_CARD:"custom_card",COPY_LINK:"text"}},43834:function(e,r){r.Z={CIPHER:"CIPHER_TEXT",LINK:"LINK",DOMAIN:"DOMAIN",NORMAL:"NORMAL",IMAGE:"IMAGE",COPY:"COPY"}},84691:function(e,r,t){t.d(r,{Z:function(){return a}});var n=t(58701);function a(){var e=(0,n.getCurrentPlatform)();return e.isWeChatMiniProgram?e.WxApp:e.isWeChatPlatform?e.WeChat:e.isQQPlatform?e.QQ:e.isNativePlatform||e.isTinyNativePlatform?"h5":""}},2002:function(e,r,t){t.d(r,{I:function(){return o},w:function(){return s}});var n=t(80322),a=t(82851),i=t(43834);function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{title:e.title,message:e.message,thumb_url:e.thumbnailURL,share_url:e.shareURL}}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return(0,n.Pp)(e.urlWrapType)&&e.marketActivityID&&e.getShareForm(r)===a.Z.COMMAND?i.Z.CIPHER:(0,n.Pp)(e.urlWrapType)&&e.marketActivityID&&e.getShareForm(r)===a.Z.TEXT?i.Z.LINK:(0,n.uW)(e.urlWrapType)&&e.marketActivityID&&e.getShareForm(r)===a.Z.CARD?i.Z.DOMAIN:e.getShareForm(r)===a.Z.IMAGE?i.Z.IMAGE:i.Z.NORMAL}},54466:function(e,r){r.Z={DEFAULT:"",SYSTEM:"system",SDK:"sdk",MANUAL:"manual",EXTENSION:"extension",STAND:"stand"}},7680:function(e,r){r.Z={COMPLETE:0,SUCCESS:1,FAIL:2,CANCEL:3,ERROR:4}},82236:function(e,r,t){t.d(r,{Z:function(){return a}});var n=t(38231);function a(e){var r=e.errorCode,t=void 0===r?0:r,a=e.message,i=void 0===a?"":a,o=e.options,s=void 0===o?{}:o;(0,n.K2)(new Error("share error"),{share_error_code:t,share_error_message:i,params:JSON.stringify(s)})}},73897:function(e,r){r.Z={DEFAULT:0,WECHAT_SESSION:1,WECHAT_TIMELINE:2,WEIBO:3,QQ_CHAT_SESSION:4,QQ_ZONE:5,TENCENT_WEIBO:6,WECHAT_SESSION_APP:7,WECHAT_TIMELINE_IMAGE:8,WECHAT_TIMELINE_IMAGE_WITH_NO_SDK:9,WECHAT_SESSION_IMAGE:10,QQ_CHAT_SESSION_IMAGE:11,QQ_ZONE_IMAGE:12,WEIBO_IMAGE:13,WECHAT_TIMELINE_IMAGES:15,WECHAT_SESSION_TEXT_WITH_NO_SDK:16,WECHAT_SESSION_TEXT:17,IOS_SYSTEM_SHARE_CARD:18,WECHAT_SESSION_IMAGE_WITH_NO_SDK:19,WECHAT_SESSION_IMAGES_WITH_NO_SDK:20,WECHAT_TIMELINE_TEXT:21,SHARE_IMAGE_PASSIVELY:22,COPY_LINK:23,WECHAT_SESSION_MUSIC:24,WECHAT_SESSION_VIDEO:25,COPY_CIPHER:9995,WECHAT_SESSION_CARD_WITH_NO_SDK:9996,WECHAT_TIMELINE_CARD_WITH_NO_SDK:9997,FRIENDS:9998,WECHAT_BIG_IMAGE:9999,PIN_TIMELINE:1e4}},9389:function(e,r,t){t.d(r,{q:function(){return n}});var n={DEFAULT:0,ANDROID_SP:1}},44893:function(e,r,t){t.d(r,{X:function(){return n}});var n={TP_FIRST:0,GENERAL_FIRST:1,GENERAL_ONLY:2}},24778:function(e,r){r.Z={DEFAULT:0,OPEN_WECHAT:1,OPEN_QQ:2,OPEN_WEIBO:3,OPEN_WECHAT_IOS_SILENT:101,OPEN_WECHAT_ANDROID_SILENT:201}},64703:function(e,r,t){t.r(r),t.d(r,{CipherConsumeMode:function(){return rr.J},CipherPasteType:function(){return nr.a},ShareChannel:function(){return T},ShareErrorCode:function(){return ir},ShareEventType:function(){return s.Z},ShareForm:function(){return v.Z},ShareMethod:function(){return l.Z},ShareResult:function(){return f},ShareResultType:function(){return p.Z},ShareType:function(){return o.Z},ShareWaterMark:function(){return He},SystemShareMode:function(){return ar.q},TPSelectCategory:function(){return tr.X},ThirdPartyOpenType:function(){return er.Z},URLWrapType:function(){return V.ZP},default:function(){return or},setPageContext:function(){return z.I8}});var n=t(49984),a=t(97684),i=t(39569),o=t(73897),s=t(1906),u=t(58701),h=t(24441),c=t(68340),l=t(54466),f={SUCCESS:"success",FAIL:"fail",CANCEL:"cancel",COMPLETE:"complete",ERROR:"error"},p=t(7680),_=t(69870),v=t(82851),y=t(60112);function d(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function E(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var m="event",S={SHARE:"share",SHARE_RESULT:"share_result"},g=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,e),this.userID=r.userID||"",this.uin=r.uin||"",this.shareID=r.shareID||"",this.op=r.op||m,this.subOP=r.subOP||"",this.shareChannel=r.shareChannel||"",this.shareResult=r.shareResult||"",this.shareURL=r.shareURL||"",this.shareDomain=r.shareDomain||"",this.shareForm=r.shareForm||"",this.shareMethod=r.shareMethod||"",this.shareAppID=r.shareAppID,this.pcode=r.pcode,this.wxShareCount=r.wxShareCount,this.cipherScene=r.cipherScene}var r,t,n;return r=e,(t=[{key:"normalize",value:function(e){if(this.subOP===S.SHARE)return{op:this.op,sub_op:this.subOP,share_id:this.shareID,share_channel:this.shareChannel,share_url:this.shareURL,share_domain:this.shareDomain,share_form:this.shareForm,share_method:this.shareMethod,share_app_id:this.shareAppID,pcode:this.pcode,pcode_scene:this.cipherScene};if(this.subOP===S.SHARE_RESULT){var r={op:this.op,sub_op:this.subOP,event:"share_result",share_id:this.shareID,share_channel:this.shareChannel,share_url:this.shareURL,share_domain:this.shareDomain,share_result:this.shareResult,share_form:this.shareForm,share_method:this.shareMethod,share_app_id:this.shareAppID,wx_share_count:this.wxShareCount,pcode:this.pcode,pcode_scene:this.cipherScene};return this.walrusID&&(r.walrus_id=this.walrusID,r.walrus_type=this.walrusType),r}return{}}},{key:"getShareURLTrackingQueries",value:function(){return e.getTrackingQueries(this)}}])&&E(r.prototype,t),n&&E(r,n),e}();g.TRACKING_SUB_OP=S,g.getTrackingQueries=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{refer_share_id:e.shareID,refer_share_uin:e.uin,refer_share_channel:e.shareChannel}};var R=g,I=t(18414);function C(e){return e=e||32,(0,I.x)(e)}var A,T={UNKNOWN:"unknown",APP_MESSAGE:"message",TIMELINE:"timeline",QQ:"qq",QQ_ZONE:"qzone",QQ_WEIBO:"qq_weibo",SINA_WEIBO:"weibo",CLIPBOARD:"copy_link"};function O(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var P=(O(A={1:T.APP_MESSAGE,2:T.TIMELINE,3:T.SINA_WEIBO,4:T.QQ,5:T.QQ_ZONE,8:T.TIMELINE,9:T.TIMELINE,10:T.APP_MESSAGE,11:T.QQ,12:T.QQ_ZONE,13:T.SINA_WEIBO,16:T.APP_MESSAGE,17:T.APP_MESSAGE,18:T.APP_MESSAGE,19:T.APP_MESSAGE,20:T.APP_MESSAGE,21:T.TIMELINE,23:T.CLIPBOARD,24:T.APP_MESSAGE,25:T.APP_MESSAGE},o.Z.COPY_CIPHER,T.CLIPBOARD),O(A,o.Z.WECHAT_SESSION_CARD_WITH_NO_SDK,T.APP_MESSAGE),O(A,o.Z.WECHAT_TIMELINE_CARD_WITH_NO_SDK,T.TIMELINE),A);function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return P[e]||T.UNKNOWN}var L=t(90608),D=t(689),k="",w="";function N(){return Promise.all([(0,D.sq)().then((function(e){k=e})).catch((function(e){})),(0,D.A8)().then((function(e){w=e})).catch((function(e){}))])}function M(){return w}function U(){return k}var Z,H=t(84195);function x(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var j=0,W=1,F=(x(Z={},T.UNKNOWN,0),x(Z,T.APP_MESSAGE,1),x(Z,T.TIMELINE,1),x(Z,T.QQ,2),x(Z,T.QQ_ZONE,2),x(Z,T.QQ_WEIBO,2),x(Z,T.SINA_WEIBO,3),Z);var B=function(e){return F[e]||j};function Q(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var G=function(){function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this._venderAppIDs={},this._isInited=!1}var r,t,n;return r=e,t=[{key:"build",value:function(e){var r=e.wechatAppID;return this._isInited?Promise.resolve():(this._isInited=!0,(0,u.getCurrentPlatform)().isNativePlatform?this._buildNativeCache():(0,u.getCurrentPlatform)().isWeChatPlatform?this._buildWeChatCache(r):Promise.resolve())}},{key:"isInited",value:function(){return this._isInited}},{key:"_buildNativeCache",value:function(){var e,r=this;return(e=[W],(0,u.getCurrentPlatform)().statisfy("4.49.0","4.49.0","greaterThan")?Array.isArray(e)?(0,H.Q6)("JSShare","venderAppIds",{channels:e}):Promise.reject({message:"invalid params"}):Promise.reject({message:"not support"})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r._venderAppIDs=Object.assign(r._venderAppIDs,e)})).catch((function(){return Promise.resolve()}))}},{key:"_buildWeChatCache",value:function(e){return this._venderAppIDs[W]=e,Promise.resolve()}},{key:"getAppIDSync",value:function(e){var r=B(e);return this._venderAppIDs[r]}}],t&&Q(r.prototype,t),n&&Q(r,n),e}(),K=null;G.getInstance=function(e){return K||(K=new G(e)),K};var Y=G,q=t(31790),V=t(80322),X=t(55525),z=t(44293);function $(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function J(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?$(Object(t),!0).forEach((function(r){ee(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function ee(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function re(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function te(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}var ae=_.Z.ShareErrorCode,ie=R.TRACKING_SUB_OP;var oe=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};re(this,e),this.transparentTransmission=r.transparentTransmission||{},this.trackingEntity=null,this.onTriggerListener=null,this.onCompletedListener=null,this.shareController=null,this._cachePrepareInfo={}}var r,t,n;return r=e,t=[{key:"listen",value:function(e){e&&e instanceof y.Z&&(this.disconnect(),this.shareController=e,this._setupDefaultTrackListener(e))}},{key:"disconnect",value:function(){this.shareController&&this._removeDefaultTrackListener(this.shareController)}},{key:"updateTrackerTrans",value:function(e){this.transparentTransmission=Object.assign({},this.transparentTransmission,e)}},{key:"_setupDefaultTrackListener",value:function(e){this._removeDefaultTrackListener(e),this.onPrepareListener=this._onDefaultSharePrepare.bind(this),this.onTriggerListener=this._onDefaultShareTrigger.bind(this),this.onCompletedListener=this._onDefaultShareCompleted.bind(this),e.on(s.Z.ON_SHARE_PREPARE,this.onPrepareListener),e.on(s.Z.ON_SHARE_TRIGGER,this.onTriggerListener),e.on(s.Z.ON_SHARE_COMPLETED,this.onCompletedListener)}},{key:"_removeDefaultTrackListener",value:function(e){this.onPrepareListener&&e.removeListener(s.Z.ON_SHARE_PREPARE,this.onPrepareListener),this.onTriggerListener&&e.removeListener(s.Z.ON_SHARE_TRIGGER,this.onTriggerListener),this.onCompletedListener&&e.removeListener(s.Z.ON_SHARE_COMPLETED,this.onCompletedListener)}},{key:"_sendLog",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=Object.assign(e,this.transparentTransmission);(0,h.oP)(J({page_id:(0,z.e6)(),page_name:(0,z.j0)(),page_sn:(0,z.kd)()},r))}},{key:"_onDefaultSharePrepare",value:function(e){var r=e.shareType;if(this._cachePrepareInfo[r]){var t=this.shareController.getShareEntityByShareType(r)||{},n=this._cachePrepareInfo[r];return n.userID=U(),n.uin=M(),void t.setShareURLQueries(R.getTrackingQueries(n))}var a=this.shareController.getShareEntityByShareType(r),i={userID:U(),uin:M(),shareID:this._getCachedShareID(a)||C(),shareChannel:b(r)};a&&a.setShareURLQueries(R.getTrackingQueries(i)),this._cachePrepareInfo[r]=i}},{key:"_onDefaultShareTrigger",value:function(e){var r=e.shareType,t=e.shareID;if(r===o.Z.PIN_TIMELINE||(0,u.getCurrentPlatform)().isWeChatMiniProgram&&r===o.Z.WECHAT_SESSION)return 0;var n=this.shareController.getShareEntityByShareType(r)||{},a=this._cachePrepareInfo[r];this._cachePrepareInfo[r]=null;var i=b(r),s=Y.getInstance();if(this.trackingEntity=new R(Object.assign({userID:U(),uin:M(),shareID:this._getCachedShareID(n)||C(),subOP:ie.SHARE,shareChannel:i,timelineDomain:n.timelineDomain,cipherScene:n.cipherScene,shareForm:n.getShareForm&&n.getShareForm(r),shareMethod:n.getShareMethod&&n.getShareMethod(r),shareAppID:s.getAppIDSync(i)},a,t?{shareID:t}:null)),!a&&n.setShareURLQueries(R.getTrackingQueries(this.trackingEntity)),n.getShareForm(r)!==v.Z.COMMAND){var h=n.targetShareURL||n.shareURL;this.trackingEntity.shareURL=h,this.trackingEntity.shareDomain=new L.Z(h).origin}this._sendLog(this.trackingEntity.normalize(r))}},{key:"_onDefaultShareCompleted",value:function(e){var r=e.shareType,t=e.shareResultType,n=e.useComplete,a=e.responseData,i=void 0===a?{}:a,s=e.tpInfo,h=(0,u.getCurrentPlatform)();if(r===o.Z.PIN_TIMELINE||h.isWeChatMiniProgram&&r===o.Z.WECHAT_SESSION)return 0;if(!this.trackingEntity)return ae.SHARE_STATUS_ILLEGAL;var l=this.shareController.getShareEntityByShareType(r)||{},p=this.getShareResultByType(t);if(n&&(p=f.COMPLETE),l.getShareForm(r)!==v.Z.COMMAND){var _=l.realShareURL||l.shareURL;this.trackingEntity.shareURL=_,this.trackingEntity.shareDomain=new L.Z(_).origin}else this.trackingEntity.pcode=l.pcode;var y,d=(y=i)&&"object"===ne(y)?"string"!=typeof y.wx_app_id?null:y.wx_app_id:null;d&&(this.trackingEntity.shareAppID=d),i.hasOwnProperty("wx_share_count")&&(this.trackingEntity.wxShareCount=i.wx_share_count,delete i.wx_share_count),this.trackingEntity.subOP=ie.SHARE_RESULT,this.trackingEntity.shareResult=p,s&&(this.trackingEntity.walrusID=s.group_id,this.trackingEntity.walrusType=s.dev_type),l.forceDowngrade||h.platform===c.iw.PddIOS&&r===o.Z.WECHAT_SESSION_TEXT_WITH_NO_SDK||o.Z.COPY_LINK===r&&!h.isNativePlatform&&!h.isTinyNativePlatform||o.Z.COPY_CIPHER===r||(this._sendLog(this.trackingEntity.normalize(r)),this.trackingEntity=null)}},{key:"trackProlongation",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0;if(!this.trackingEntity)return!1;this.trackingEntity.shareMethod=l.Z.MANUAL,this.trackingEntity.shareResult=f.COMPLETE;var n=Object.assign(this.trackingEntity.normalize(e),r);return this.trackingEntity=null,"function"==typeof t?t(n):this._sendLog(n),!0}},{key:"getShareResultByType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case p.Z.COMPLETE:return f.COMPLETE;case p.Z.SUCCESS:return f.SUCCESS;case p.Z.FAIL:return f.FAIL;case p.Z.CANCEL:return f.CANCEL;default:return f.ERROR}}},{key:"_getCachedShareID",value:function(e){if(e.urlWrapType===V.ZP.SERVER_SHORT_URL_WITH_CACHE){var r=(0,q.s)(),t=(0,X.Z)(e);return r.getShareID(t)}}}],t&&te(r.prototype,t),n&&te(r,n),e}(),se=oe,ue=t(81666),he="api/flow/audience/share/content";function ce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=(0,ue.e)({pageInfo:{pageId:(0,z.e6)()}},{defaultErrorHandler:function(e){}}),n={};return n.share_params=r.shareParams||{},n.origin=r.platform||"",n.page_sn=r.pageSn||(0,z.kd)()+"",n.page_info=r.pageInfo||{page_name:(0,z.j0)(),page_url:location&&location.href},"post"===e.toLowerCase()?t.post(he,n):t.get(he,{params:n})}var le="api/flow/audience/share/perform";function fe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=(0,ue.e)({pageInfo:{pageId:(0,z.e6)()}},{defaultErrorHandler:function(e){}}),n={};return n.share_params=r.shareParams||{},n.share_type=r.shareType||0,n.share_method=r.shareMethod||"",n.origin=r.platform||"",n.page_sn=r.pageSn||(0,z.kd)(),n.page_info=r.pageInfo||{page_name:(0,z.j0)(),page_url:location&&location.href},n.extra=r.extra||{},"post"===e.toLowerCase()?t.post(le,n):t.get(le,{params:n})}var pe={REACH_HOUR_LIMIT:43367,REACH_DAY_LIMIT:43368};function _e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function ve(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ye=function(){function e(){_e(this,e),this._shareController=null,this._onPerformShareErrorHandler=null}var r,t,n;return r=e,t=[{key:"listen",value:function(e){e&&e instanceof y.Z&&(this.disconnect(),this._shareController=e,this._setupListener(e))}},{key:"disconnect",value:function(){this.removeListener()}},{key:"_setupListener",value:function(e){this.removeListener(),this._onPerformShareErrorHandler=this._onPerformShareError.bind(this),e.on(s.Z.PERFORM_LOG_FAILED,this._onPerformShareErrorHandler)}},{key:"removeListener",value:function(){this._shareController&&this._onPerformShareErrorHandler&&this._shareController.removeListener(s.Z.PERFORM_LOG_FAILED,this._onPerformShareErrorHandler)}},{key:"_onPerformShareError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.error||{},t=e.shareType,n=parseInt(r.errorCode,10)||0;[pe.REACH_DAY_LIMIT,pe.REACH_HOUR_LIMIT].indexOf(n)>=0&&(this._shareController.emit(s.Z.SHARE_REACH_LIMIT,{shareType:t,errorCode:n}),this.hideShareMenuOption(t))}},{key:"hideShareMenuOption",value:function(e){var r=this._shareController;e&&r&&r.disableShare(e)}}],t&&ve(r.prototype,t),n&&ve(r,n),e}(),de=ye,Ee=t(82236),me=t(2002),Se=t(84691);function ge(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Re(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ie(e,r,t,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void t(e)}s.done?r(u):Promise.resolve(u).then(n,a)}function Ce(e){return function(){var r=this,t=arguments;return new Promise((function(n,a){var i=e.apply(r,t);function o(e){Ie(i,n,a,o,s,"next",e)}function s(e){Ie(i,n,a,o,s,"throw",e)}o(void 0)}))}}var Ae="undefined"!=typeof window;function Te(){return(Te=Ce(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=(0,u.getCurrentPlatform)()).isWeChatMiniProgram){e.next=7;break}return e.next=4,t.e(3400).then(t.bind(t,48306));case 4:case 10:case 16:case 22:case 27:return e.abrupt("return",e.sent.default);case 7:if(!r.isWeChatPlatform){e.next=13;break}return e.next=10,t.e(2840).then(t.bind(t,69843));case 13:if(!r.isQQPlatform){e.next=19;break}return e.next=16,t.e(6795).then(t.bind(t,573));case 19:if(!r.isNativePlatform&&!r.isTinyNativePlatform){e.next=25;break}return e.next=22,t.e(5911).then(t.bind(t,19306));case 25:return e.next=27,t.e(699).then(t.bind(t,32841));case 28:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Oe=function(){return Te.apply(this,arguments)},Pe=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ge(this,e),this.shareController=null,this.shareTracker=null,this.menuWatcher=null,this.platform=(0,Se.Z)(),this._disableContentCheck=!0,this._disablePerformShareLog=!1,this.controllerOptions=r.controllerOptions||{},this.noDefaultShare=r.noDefaultShare||!1,this.disableShare=r.disableShare||!1,this._initControllerPromise=null,this.loadErrorRetry=r.loadErrorRetry||0,this.enableInfiniteRetry=r.enableInfiniteRetry||!1,this._loadControllerFailed=!1}var r,t,n,a,i,h,c,l;return r=e,t=[{key:"setup",value:(l=Ce(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ae&&!this.shareController){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:if(!this._loadControllerFailed||this.enableInfiniteRetry){e.next=4;break}return e.abrupt("return",Promise.reject(new Error("load controller failed")));case 4:return this._setupShareTracker(),this._setupMenuWatcher(),this._initControllerPromise=this._initControllerPromise||this._setupController(),r=!1,e.prev=8,e.next=11,this._initControllerPromise;case 11:e.next=25;break;case 13:if(e.prev=13,e.t0=e.catch(8),this._initControllerPromise=null,!(this.loadErrorRetry>0)){e.next=22;break}(0,Ee.Z)({errorCode:0,message:"加载分享控制器失败, 剩余重试次数".concat(this.loadErrorRetry),options:{message:e.t0&&e.t0.message}}),this.loadErrorRetry--,r=!0,e.next=25;break;case 22:throw this._loadControllerFailed=!0,(0,Ee.Z)({errorCode:0,message:"加载分享控制器失败",options:{message:e.t0&&e.t0.message}}),e.t0;case 25:if(!r){e.next=27;break}return e.abrupt("return",this.setup());case 27:case"end":return e.stop()}}),e,this,[[8,13]])}))),function(){return l.apply(this,arguments)})},{key:"_setupController",value:(c=Ce(regeneratorRuntime.mark((function e(){var r,t,n,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.shareController){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return r=this.controllerOptions,t=(0,u.getCurrentPlatform)(),e.next=6,Oe();case 6:n=e.sent,this.shareController=new n(r),t.isWeChatPlatform||t.isQQPlatform?this.noDefaultShare||this._prepareShareController():(t.isNativePlatform||t.isTinyNativePlatform)&&this.shareController.on(s.Z.ON_SHARE_COMPLETED,(function(e){var r=e.shareType,t=e.shareResultType,n=e.nativeShareErrorCode;t===p.Z.FAIL&&[pe.REACH_HOUR_LIMIT,pe.REACH_DAY_LIMIT].indexOf(n)>=0&&(a.shareController.emit(s.Z.SHARE_REACH_LIMIT,{shareType:r,errorCode:n}),(0,Ee.Z)({errorCode:n,message:"分享达到上限"}))})),this.shareTracker.listen(this.shareController),this.menuWatcher.listen(this.shareController),this._setupPerformShareLog();case 12:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"_prepareShareController",value:function(){this.shareController&&!this.shareController.isInited()&&this.shareController.initShare()}},{key:"_setupMenuWatcher",value:function(){this.menuWatcher||(this.menuWatcher=new de)}},{key:"_setupShareTracker",value:function(){this.disableTracker||this.shareTracker||(this.shareTracker=new se({transparentTransmission:this.trackerTrans}))}},{key:"_setupPerformShareLog",value:function(){var e=this;this.shareController&&!(0,u.getCurrentPlatform)().isNativePlatform&&this.shareController.on(s.Z.ON_SHARE_COMPLETED,(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e._disablePerformShareLog&&r.shareResultType===p.Z.SUCCESS&&r.shareType!==o.Z.COPY_CIPHER){var t=r.shareType,n=e.getShareEntity(t);fe("post",{platform:e.platform,shareType:t,shareParams:(0,me.I)(n),shareMethod:(0,me.w)(n,t),extra:n.payloadMixin&&n.payloadMixin.extra}).catch((function(r){e.shareController.emit(s.Z.PERFORM_LOG_FAILED,{shareType:t,error:r})}))}}))}},{key:"share",value:(h=Ce(regeneratorRuntime.mark((function e(r){var t,n,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.shareController&&!this.disableShare){e.next=4;break}return(t=new Error("no controller exists")).shareType=r,e.abrupt("return",Promise.reject(t));case 4:return e.next=6,N();case 6:if(this._prepareShareController(),n=function(){return new Promise((function(e,t){var n=a,i=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.shareResultType;if(o(),p.Z.SUCCESS===n)e(r);else{var a=new Error("分享失败");Object.assign(a,r),t(a)}};function o(){n.shareController.removeListener(s.Z.ON_SHARE_COMPLETED,i)}a.shareController.on(s.Z.ON_SHARE_COMPLETED,i);var u=a.shareController.share(r);if(u){o(),a.shareController.emit(s.Z.ON_SHARE_INTERRUPT,{shareType:r,shareErrorType:u}),(0,Ee.Z)({errorCode:u,message:"分享前置流程异常",options:{shareType:r}});var h=new Error("分享前置流程异常");Object.assign(h,{shareType:r,shareErrorType:u}),t(h)}}))},!(0,u.getCurrentPlatform)().isNativePlatform){e.next=12;break}return e.abrupt("return",this.shareController.waitShareLimiter().then((function(e){return n()}),(function(e){return n()})));case 12:return e.abrupt("return",n());case 13:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"checkShareContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ce("post",{platform:this.platform,shareParams:(0,me.I)(e)})}},{key:"setContentCheck",value:function(e){this._disableContentCheck=!e}},{key:"setPerformShareLog",value:function(e){this._disablePerformShareLog=!e}},{key:"prepareShare",value:(i=Ce(regeneratorRuntime.mark((function e(){var r,t,n,a,i,o,s=this,h=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=h.length>0&&void 0!==h[0]?h[0]:{},t=h.length>1?h[1]:void 0,n=h.length>2&&void 0!==h[2]?h[2]:{},this.shareController){e.next=5;break}return e.abrupt("return",Promise.reject(new Error("no controller exists")));case 5:return e.next=7,N();case 7:if(this._prepareShareController(),a=r.entityConfig,i=void 0===a?{}:a,o=this.shareController.createShareEntity(i,t),!(n.skipShareContentCheck||this._disableContentCheck||(0,u.getCurrentPlatform)().isNativePlatform)){e.next=12;break}return e.abrupt("return",this.shareController.refreshShare(o,t));case 12:return e.abrupt("return",this.checkShareContent(o).then((function(){return s.shareController.refreshShare(o,t)})));case 13:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getShareController",value:function(){return this.shareController}},{key:"getShareControllerAsync",value:(a=Ce(regeneratorRuntime.mark((function e(){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.shareController){e.next=2;break}return e.abrupt("return",this.shareController);case 2:if(!this._initControllerPromise){e.next=4;break}return e.abrupt("return",this._initControllerPromise.then((function(e){return r.shareController})).catch((function(e){return null})));case 4:return e.abrupt("return",this.setup().then((function(e){return r.shareController})).catch((function(e){return null})));case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getShareTracker",value:function(){return this.shareTracker}},{key:"getShareEntity",value:function(e,r){return this.shareController?this.shareController.getShareEntityByShareType(e,r):null}},{key:"setupNativeShareButton",value:function(e,r){this.shareController&&(this.shareController.removeAllListeners(s.Z.ON_SHARE_BUTTON_CLICKED),"function"==typeof r&&this.shareController.on(s.Z.ON_SHARE_BUTTON_CLICKED,r),this.shareController.setupNativeShareButton(e))}}],t&&Re(r.prototype,t),n&&Re(r,n),e}(),be=Pe,Le={title:0,message:0,thumbnailURL:0,shareURL:0,shareDomain:0,waterMark:0,urlWrapType:0,drawImageOptions:0,drawImageClass:0,marketActivityID:0,miniObjectPath:0,miniObjectID:0,useWxAppShare:0,shortURLApi:0,shortCommandApi:0,domainURLApi:0,forceDowngrade:0,payloadMixin:0,requestUsePost:0,excludeShareChoices:0,thirdPartyOpenType:0,needSharedAmount:0,cipherScene:0,consumeMode:0,activitySceneSn:0,tpSelectCategory:0,pinTimelineParams:0,wxAppRequestPayload:0,cipherProcessor:0,wxAppNavigatePayload:0,withShareTicket:0,systemShareMode:0,wechatMaskConfig:0},De={noDefaultShare:0,isSDKPrepare:0,disableShare:0},ke={wechatAppID:0,magicTrace:0,shareTypeEnable:0};function we(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Ne(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Me={USELESS:-1,DEFAULT:0,OUT_OF_DATE:1,FORBIDDEN:2,ABANDONED:3},Ue=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};we(this,e),this.cacheRaw=r.cacheRaw||!1,this.deleteAfterCollect=r.deleteAfterCollect||!1}var r,t,n;return r=e,t=[{key:"filter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this._filterShareEntity(e),t=this._filterShareConfigFlag(e),n=this._filterShareOther(e),a={};return{_rawShareInfo:this.cacheRaw?e:null,entityConfig:r,flowControllConfig:t,otherConfig:n,compatibleShareConfig:a}}},{key:"_filterByItems",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.keys(t)||[],a={};return n.forEach((function(n,i){var o=t[n];o===Me.FORBIDDEN||o===Me.ABANDONED?delete r[n]:void 0!==r[n]&&(a[n]=r[n],e.deleteAfterCollect&&delete r[n])})),a}},{key:"_filterShareEntity",value:function(e){return this._filterByItems(e,Le)}},{key:"_filterShareConfigFlag",value:function(e){return this._filterByItems(e,De)}},{key:"_filterShareOther",value:function(e){return this._filterByItems(e,ke)}}],t&&Ne(r.prototype,t),n&&Ne(r,n),e}(),Ze=Ue,He={DEFAULT:"!share_v2",WE_CHAT_MSG:"!share_v3",SHARE:"!share",TRANSPARENT:"!transparent",NONE:"",NO_LOGO:"!share_v4"},xe=t(68647),je=t(71538),We=t(32393);function Fe(e){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fe(e)}function Be(e,r,t,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void t(e)}s.done?r(u):Promise.resolve(u).then(n,a)}function Qe(e){return function(){var r=this,t=arguments;return new Promise((function(n,a){var i=e.apply(r,t);function o(e){Be(i,n,a,o,s,"next",e)}function s(e){Be(i,n,a,o,s,"throw",e)}o(void 0)}))}}function Ge(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Ke(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ye={};"undefined"!=typeof window&&(Ye=xe.Z.get(location.host)||{});var qe={code:null,from:null,isappinstalled:null,at:null,share_id:null,is_back:null,page_id:null,list_id:null},Ve=["refer_page_name","refer_page_section","refer_page_element","refer_page_id","refer_page_sn","refer_page_el_sn","refer_mid","refer_adg","refer_cam","refer_ced"];function Xe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(e=e||"").indexOf("!")>=0&&!t?e:(e=e.split("!")[0],e+=r)}var ze=null,$e=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ge(this,e),this._hasInited=!1,this.opts=r||{},this.shopConfig=r.shopConfig,this.defaultShareEntityConfig={},this.shareManager=null,this.shareInfoFilter=null,this._sdkPrepared=!1}var r,t,h,c,l,f,p,_,v;return r=e,t=[{key:"setup",value:function(){this._hasInited||(this._hasInited=!0,this._setupShareInfoFilter(),this._setupShareManager(),!(this.opts.shareManagerConfig||{}).noDefaultShare&&this._prepareDefaultShare(),this.waitAppIDCacheBuild())}},{key:"_setupShareInfoFilter",value:function(){this.shareInfoFilter||(this.shareInfoFilter=new Ze(this.opts.shareInfoFilterConfig))}},{key:"_setupShareManager",value:function(){var e=this;if(!this.shareManager){var r=Object.assign({},{noDefaultShare:!1,disableShare:!1,useNativeShareButton:!1,loadErrorRetry:1,enableInfiniteRetry:!1},this.opts.shareManagerConfig);this.shareManager=new be(r)}return this._managerReadyPromise=this._managerReadyPromise||this.shareManager.setup(),this._managerReadyPromise.then((function(r){e._managerReady=!0})).catch((function(r){e._managerReadyPromise=null})),this._managerReadyPromise}},{key:"_prepareDefaultShare",value:function(){(0,u.getCurrentPlatform)().isWeChatMiniProgram||(Object.assign(this.defaultShareEntityConfig,{title:"拼多多商城",message:"风靡全国的拼单商城，优质商品新鲜直供，快一起来拼多多吧",thumbnailURL:(0,n.H)("/base/logo.jpg"),shareURL:"/"}),this.prepareShare(this.defaultShareEntityConfig,void 0,{skipShareContentCheck:!0}))}},{key:"_prepareShareByShareType",value:(v=Qe(regeneratorRuntime.mark((function e(){var r,t,n,a,i,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o.length>0&&void 0!==o[0]?o[0]:{},t=o.length>1?o[1]:void 0,n=o.length>2?o[2]:void 0,this.setup(),this._managerReady){e.next=7;break}return e.next=7,this.waitManagerReady();case 7:return a=r.entityConfig,i=void 0===a?{}:a,this._buildThumbnailURL(i,t),this._buildShareURL(i,t),e.abrupt("return",this.shareManager.prepareShare(r,t,n));case 11:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"prepareShare",value:function(e,r){var t=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.setup();var a=this.shareInfoFilter.filter(e),i=this._prepareShareByShareType(a,r,n);return!this._sdkPrepared&&i.then((function(e){t._checkSDKPrepared(a)}),(function(e){t._checkSDKPrepared(a)})),i}},{key:"prepareShareSafe",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;this.setup();var n=this.shareInfoFilter.filter(r),a=n.flowControllConfig,i=void 0===a?{}:a;if(!this._sdkPrepared&&!i.isSDKPrepare)return this.waitSDKReady().then((function(){return e._prepareShareByShareType(n,t)}));var o=this._prepareShareByShareType(n,t);return!this._sdkPrepared&&o.then((function(r){e._checkSDKPrepared(n)}),(function(r){e._checkSDKPrepared(n)})),o}},{key:"waitSDKReady",value:function(){var e=this;return this.waitWeChatSDKReady().then((function(){return e.waitAppIDCacheBuild()}))}},{key:"waitWeChatSDKReady",value:(_=Qe(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._sdkPrepared){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:if(!this.sdkReadyPromise){e.next=8;break}return e.abrupt("return",this.sdkReadyPromise);case 8:return e.next=10,this.shareManager.getShareControllerAsync();case 10:if(r=e.sent){e.next=13;break}return e.abrupt("return",Promise.resolve());case 13:return this.sdkReadyPromise=new Promise((function(e,t){r.once(s.Z.ON_SDK_READY,(function(){e()}))})),e.abrupt("return",this.sdkReadyPromise);case 15:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:"waitAppIDCacheBuild",value:(p=Qe(regeneratorRuntime.mark((function e(){var r,t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=Y.getInstance()).isInited()){e.next=5;break}return e.abrupt("return",Promise.resolve());case 5:if(!this._actualWeChatAppID){e.next=9;break}return e.abrupt("return",r.build({wechatAppID:this._actualWeChatAppID}));case 9:if(this.appIDReadyPromise){e.next=16;break}return e.next=12,this.shareManager.getShareControllerAsync();case 12:if(t=e.sent){e.next=15;break}return e.abrupt("return",Promise.resolve());case 15:this.appIDReadyPromise=new Promise((function(e,n){t.once(s.Z.ON_SDK_READY,(function(t){var n=t.wechatAppID,a=t.magicTrace;Promise.all([r.build({wechatAppID:n}),We.Z.getInstance().build({magicTrace:a})]).then((function(){e()}))}))}));case 16:return e.abrupt("return",this.appIDReadyPromise);case 17:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"waitManagerReady",value:function(){return this._managerReady?Promise.resolve():this._managerReadyPromise?this._managerReadyPromise:this._setupShareManager()}},{key:"share",value:(f=Qe(regeneratorRuntime.mark((function e(r,t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setup(),!t){e.next=5;break}return e.abrupt("return",this.prepareShareSafe(t,r).then((function(){return n.shareManager.share(r)})));case 5:if(this._managerReady){e.next=8;break}return e.next=8,this.waitManagerReady();case 8:return e.abrupt("return",this.shareManager.share(r));case 9:case"end":return e.stop()}}),e,this)}))),function(e,r){return f.apply(this,arguments)})},{key:"_buildThumbnailURL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,t=e.thumbnailURL;if(void 0!==t){var n=e.waterMark,a=t||"";null==n&&(n=He.DEFAULT),a=Xe(a,n),r===o.Z.WECHAT_SESSION&&n===He.DEFAULT&&(a=Xe(a,He.WE_CHAT_MSG,!0)),a=(a||"").replace(/^\/\//,"http://"),e.thumbnailURL=a}}},{key:"_buildShareURL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,t=e.shareURL;if(t){if(e.urlWrapType!==V.ZP.RAW){var n=new L.Z(t),s=n.query||{},h=Object.keys(s).reduce((function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Ve.indexOf(r)>=0&&(e[r]=null),e}),{}),c=(0,a.H4)(!0),l={_wv:41729,_wvx:10};!(0,u.getCurrentPlatform)().isWeChatPlatform||r!==o.Z.QQ_CHAT_SESSION&&r!==o.Z.QQ_ZONE||(l.sf_tag="wechat"),r!==o.Z.WECHAT_TIMELINE_IMAGE&&r!==o.Z.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK||(l.from="qrImg");var f=n.pathname||"",p=Object.assign({},l,c,s,qe,h),_=e.shareDomain||Ye.shareDomain;e.shareURL=(0,je.Z)(p,(0,i.De)(f),_)}}else delete e.shareURL}},{key:"_checkSDKPrepared",value:(l=Qe(regeneratorRuntime.mark((function e(r){var t,n,a,i,o,u,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.flowControllConfig,n=void 0===t?{}:t,a=r.otherConfig,i=void 0===a?{}:a,!n.isSDKPrepare||this._sdkPrepared){e.next=10;break}return this._sdkPrepared=!0,e.next=5,this.shareManager.getShareControllerAsync();case 5:o=e.sent,i.wechatAppID&&(this._actualWeChatAppID=i.wechatAppID),(u=i.shareTypeEnable)&&"object"===Fe(u)&&(h=Object.keys(u).filter((function(e){return!u[e]})).map((function(e){return parseInt(e,10)})),o&&o.disableShare(h)),o&&o.emit(s.Z.ON_SDK_READY,{wechatAppID:i.wechatAppID,magicTrace:i.magicTrace});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"getShareManager",value:function(){return this.setup(),this.shareManager}},{key:"setupNativeShareButton",value:(c=Qe(regeneratorRuntime.mark((function e(r,t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setup(),this.shareManager){e.next=3;break}return e.abrupt("return");case 3:if(this._managerReady){e.next=6;break}return e.next=6,this.waitManagerReady();case 6:return e.abrupt("return",this.shareManager.setupNativeShareButton(r,t));case 7:case"end":return e.stop()}}),e,this)}))),function(e,r){return c.apply(this,arguments)})}],t&&Ke(r.prototype,t),h&&Ke(r,h),e}();$e.getInstance=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ze||(ze=new $e(e)),ze};var Je=$e,er=t(24778),rr=t(76181),tr=t(44893),nr=t(71975),ar=t(9389),ir=_.Z.ShareErrorCode,or=Je},65232:function(e,r,t){t.d(r,{i:function(){return i}});var n=t(73897),a=[n.Z.QQ_CHAT_SESSION,n.Z.QQ_ZONE,n.Z.QQ_CHAT_SESSION_IMAGE,n.Z.QQ_ZONE_IMAGE],i=function(e){return a.indexOf(e)>=0}},31790:function(e,r,t){function n(e,r,t){return n=a()?Reflect.construct:function(e,r,t){var n=[null];n.push.apply(n,r);var a=new(Function.bind.apply(e,n));return t&&i(a,t.prototype),a},n.apply(null,arguments)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function i(e,r){return i=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},i(e,r)}function o(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function s(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.d(r,{s:function(){return c}});var u=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this._cacheMap={},this._cacheLimit=r.cacheLimit||20}var r,t,n;return r=e,t=[{key:"getResponseByHash",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=this._cacheMap[e];return r?r.response:null}},{key:"cacheResponseByHash",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0;if(e&&r){var t=Object.keys(this._cacheMap).length||0;if(!(t>=this._cacheLimit)){var n=this._cacheMap[e];n?n.response=r:this._cacheMap[e]={response:r,count:1,trigger:!1,complete:!1}}}}},{key:"_write",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2?arguments[2]:void 0,n=this._cacheMap[r]||{};n[e]=t,this._cacheMap[r]=n}},{key:"_read",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(this._cacheMap[r]||{})[e]}},{key:"getCountByHash",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._read("count",e)||0}},{key:"increaseCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._write("count",e,this.getCountByHash()+1)}},{key:"getShareID",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._read("share_id",e)}},{key:"setShareID",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._write("share_id",e,r)}}],t&&s(r.prototype,t),n&&s(r,n),e}(),h=null;function c(){return h||(h=n(u,Array.prototype.slice.call(arguments))),h}},32393:function(e,r,t){t.d(r,{Z:function(){return d}});var n=t(90608),a=t(71538),i=t(44293),o=t(81666);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}var u="api/flow/audience/share/trace";function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=(0,o.e)({pageInfo:{pageId:(0,i.e6)()}},{defaultErrorHandler:function(e){}}),n={};return n.origin=r.platform||"",n.share_params=r.shareParams||{},n.page_sn=r.pageSn||(0,i.kd)()+"",n.page_info=r.pageInfo||{page_name:(0,i.j0)(),page_url:location&&location.href},r.payloadMixin&&"object"===s(r.payloadMixin)&&(n=Object.assign(n,r.payloadMixin)),("post"===e.toLowerCase()?t.post(u,n):t.get(u,{params:n})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.magic_trace}))}var c=t(2002),l=t(84691);function f(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function p(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,r){if(!(r&&r.key&&r.value&&r.trace))return e;var t=new n.Z(e),i=r.key,o=r.value,s=r.trace;return(0,a.Z)(Object.assign(function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}({},i,o),t.query),s,t.origin)}var v=function(){function e(){f(this,e),this._isInited=!1,this._magicTrace=null}var r,t,n;return r=e,t=[{key:"build",value:function(e){var r=e.magicTrace,t=void 0===r?{}:r;return this._isInited||t.key&&t.value&&t.trace&&(this._magicTrace=t,this._isInited=!0),Promise.resolve()}},{key:"isInited",value:function(){return this._isInited}},{key:"transform",value:function(e){return _(e,this._magicTrace)}},{key:"transformByShareEntity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return h("post",{platform:(0,l.Z)(),shareParams:(0,c.I)(e),payloadMixin:e.payloadMixin}).then((function(r){return _(e.shareURL,r)}))}}],t&&p(r.prototype,t),n&&p(r,n),e}(),y=null;v.getInstance=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return y||(y=new v(e)),y};var d=v},90608:function(e,r){function t(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,a,i=[],o=!0,s=!1;try{for(t=t.call(e);!(o=(n=t.next()).done)&&(i.push(n.value),!r||i.length!==r);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==t.return||t.return()}finally{if(s)throw a}}return i}(e,r)||function(e,r){if(!e)return;if("string"==typeof e)return n(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return n(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function a(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function i(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";a(this,e),this.hostname="",this.origin="",this.pagename="",this.pathname="",this.port=0,this.protocol="",this.query={},this.search="",this.hashTag="",this.parseURL(r)}var r,n,o;return r=e,n=[{key:"parseURL",value:function(e){var r=e.split("#"),n=r[0]||"";this.hashTag=r[1]||"";var a=n.split("?"),i=a[0]||"",o=a[1]||"";this.search="?"+o,this.query=(o.split("&")||[]).reduce((function(e){var r,t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=n.split("=");try{r=decodeURIComponent(a[0]||""),t=decodeURIComponent(a[1]||"")}catch(e){r=""}return r&&(e[r]=t),e}),{});var s=i.match(/^([a-zA-Z]+:)\/\//)||[];this.protocol=s[1]||"",s[0]&&(i=i.replace(s[0],""));var u=i.match(/^((:?[a-zA-Z0-9](:?[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,6})(:\d+)?\//)||[],h=t((u[0]||"").replace(/\//g,"").split(":"),2),c=h[0],l=h[1];this.hostname=c,this.port=parseInt(l||0,10),u[0]&&(i=i.replace(u[0],"")),this.protocol&&this.hostname&&(this.origin="".concat(this.protocol,"//").concat(this.hostname)),this.pathname="/"+i.replace(/^\//,"");var f=i.match(/\/?(\w+\.html)$/)||[];this.pagename=f[1]||""}}],n&&i(r.prototype,n),o&&i(r,o),e}();r.Z=o},80322:function(e,r,t){t.d(r,{vD:function(){return a},uW:function(){return i},Pp:function(){return o}});var n={DEFAULT:0,REDIRECT:1,SERVER_DOMAIN:2,SERVER_CONTROL:3,SERVER_SHORT_URL:4,RAW:5,SERVER_TINY_DOMAIN:6,SERVER_DOMAIN_BASE64:7,DOMAIN_REPLACE:8,MAGIC_TRACE:9,MAGIC_TRACE_DYNAMIC:10,SERVER_SHORT_URL_WITH_CACHE:11,SERVER_TP_APP:12,SERVER_TP_APP_CARD:13,SERVER_QUERY_APPEND:14,CATEGORY_PROCEDURE:15,CATEGORY_PROCEDURE_CUSTOM:16};function a(e){return[n.SERVER_CONTROL,n.SERVER_SHORT_URL,n.SERVER_TINY_DOMAIN,n.SERVER_DOMAIN_BASE64,n.DOMAIN_REPLACE,n.SERVER_SHORT_URL_WITH_CACHE].indexOf(e)>=0}function i(e){return[n.SERVER_CONTROL,n.SERVER_TINY_DOMAIN,n.SERVER_DOMAIN_BASE64,n.DOMAIN_REPLACE].indexOf(e)>=0}function o(e){return[n.SERVER_SHORT_URL,n.SERVER_SHORT_URL_WITH_CACHE,n.SERVER_TP_APP_CARD,n.CATEGORY_PROCEDURE,n.CATEGORY_PROCEDURE_CUSTOM].indexOf(e)>=0}r.ZP=n},71538:function(e,r,t){t.d(r,{Z:function(){return i}});var n=t(39569),a=t(90608);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return 0===window.location.href.indexOf("amcomponent://")&&(t=t||new a.Z(r).origin),r=(0,n.ru)(e,(0,n.De)(r||location.href)),t?(t=t.replace(/\/$/g,""),"".concat(t).concat((0,n.Rh)(r))):r}},55525:function(e,r,t){t.d(r,{Z:function(){return o}});var n=t(71538),a=t(37335),i=t.n(a);function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.shareURL,t=(0,n.Z)({refer_share_id:null,refer_share_uid:null,refer_share_channel:null,refer_share_uin:null},r),a=e.payloadMixin||{},o=JSON.stringify(a);return i()(t+o)}},44293:function(e,r,t){t.d(r,{I8:function(){return a},e6:function(){return i},kd:function(){return o},j0:function(){return s}});var n={};function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(n,e)}function i(){return n.pageId||""}function o(){return n.pageSN||""}function s(){return n.pageName||""}},84973:function(e,r,t){t.d(r,{Z:function(){return i}});var n=t(58701),a="undefined"!=typeof window;function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.match(/^http:?/)?e:(0,n.getCurrentPlatform)().isNativePlatform||!a?"http://".concat(e):location.protocol?"".concat(location.protocol,"//").concat(e):void 0}},61340:function(e,r,t){t.d(r,{O$:function(){return p},Hr:function(){return _},ZP:function(){return v}});var n=t(39569),a=t(71538),i=t(90608),o=t(68647),s=["refer_share_uid"];function u(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function h(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?u(Object(t),!0).forEach((function(r){c(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function c(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function l(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var f={};function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=new i.Z(e.shareURL).query||{};return{refer_share_id:r.refer_share_id,refer_share_uid:r.refer_share_uid,refer_share_channel:r.refer_share_channel,refer_share_uin:r.refer_share_uin}}function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/^(?:https?:?)?\/\//,"https://")}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e.miniObjectPath,o=new i.Z(t),u=new i.Z(o.query.target_page||""),c=u.query||{},v=r.appendQuery||{},y=h(h({},p(e)),v),d=(y.refer_share_uid,l(y,s)),E=e.shareDomain||f.shareDomain;if(c.specialUrl||c.src)return c.src?c.src=(0,a.Z)(d,c.src,E):c.src=_(e.shareURL),"".concat(o.pathname,"?").concat((0,n.XP)(Object.assign({},o.query,{target_page:"".concat(u.pathname,"?").concat((0,n.XP)(c))})));if(c.jump_url||c.launch_url){if(c.jump_url){var m=new i.Z(c.jump_url);if(!m.hostname){var S=m.query;S.specialUrl&&(S.src?S.src=(0,a.Z)(d,S.src,E):S.src=_(e.shareURL),c.jump_url="".concat(m.pathname,"?").concat((0,n.XP)(S)))}}return c.launch_url&&(c.launch_url=(0,a.Z)(d,c.launch_url)),"".concat(o.pathname,"?").concat((0,n.XP)(Object.assign({},o.query,{target_page:"".concat(u.pathname,"?").concat((0,n.XP)(c))})))}return o.hostname||u.hostname||!o.query.target_page?"".concat(o.pathname,"?").concat((0,n.XP)(Object.assign({},o.query,d))):"".concat(o.pathname,"?").concat((0,n.XP)(Object.assign({},o.query,{target_page:"".concat(u.pathname,"?").concat((0,n.XP)(Object.assign(c,d)))})))}"undefined"!=typeof window&&(f=o.Z.get(location.host)||{})},94075:function(e,r,t){t.d(r,{v3:function(){return h},X4:function(){return c},SY:function(){return f},ZP:function(){return p}});var n=t(44293),a=t(81666),i=t(61340),o=t(90608),s=t(39569);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}var h={WEIXIN_TINY_DOMAIN:"weixin",SHORT_LINK:"link"},c={WECHAT:"h5",IOS:"ios",ANDROID:"android"},l="api/flow/chron/share/miniprogram";function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=(0,a.e)({pageInfo:{pageId:(0,n.e6)()}},{defaultErrorHandler:function(e){}}),o={};o.share_refer=(0,i.O$)({shareURL:r.shareURL}),r.payloadMixin&&"object"===u(r.payloadMixin)&&(o=Object.assign(o,r.payloadMixin));var s=r.shortURLApi||l;return("post"===e.toLowerCase()?t.post(s,o):t.get(s,{params:o})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e}))}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=(0,a.e)({pageInfo:{pageId:(0,n.e6)()}},{defaultErrorHandler:function(e){}}),c={};c.url=r.shareURL||"",c.activity=r.marketActivityID||0,c.platform=r.platform||"",c.share_refer=(0,i.O$)({shareURL:r.shareURL}),c.page_sn=(0,n.kd)(),r.payloadMixin&&"object"===u(r.payloadMixin)&&(c=Object.assign(c,r.payloadMixin));var l=r.urlAlias||"url_code",f=c[l];if(f&&"string"==typeof f){var p=new o.Z(f).query||{};Object.assign(p,c.share_refer),c[l]="".concat(f.split("?")[0]||"","?").concat((0,s.XP)(p))}var _="api/flow/audience/activity/domain/weixin";return r.shareDomainType===h.SHORT_LINK?_=r.shortURLApi?r.shortURLApi:r.shortCommandApi?r.shortCommandApi:"api/flow/audience/activity/domain/short_url":r.domainURLApi&&(_=r.domainURLApi),("post"===e.toLowerCase()?t.post(_,c):t.get(_,{params:c})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{domain:e.domain,openAppID:e.open_app_id||"",shortURL:e.short_url||"",shareText:e.share_text||"",raw:e}}))}},93556:function(e,r,t){t.d(r,{Yy:function(){return d},CU:function(){return E},Ep:function(){return m},ls:function(){return S}});var n=t(94075),a=t(58701),i=t(68340),o=t(65232),s=t(32393),u=t(55525),h=t(31790),c=t(80322),l=t(90608),f=t(84973),p=t(71538),_=["share_title","share_img","dev_infos"];function v(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var y=["mobile.yangkeduo.com","m.hutaojie.com","panduoduo.yangkeduo.com"],d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.shareURL||"",t=e.urlWrapType;if(t===c.ZP.DEFAULT||t===c.ZP.RAW)return Promise.resolve({missed:!0,realShareURL:r,targetShareURL:r});if(e.marketActivityID&&(0,c.vD)(t)){var a=(0,c.uW)(t)?n.v3.WEIXIN_TINY_DOMAIN:n.v3.SHORT_LINK,i=r.replace(/^(\w+:)?\/\//,""),o=(0,u.Z)(e),f=(0,h.s)(),y=function(){var s=new Promise((function(o,s){(0,n.ZP)(e.requestUsePost?"post":"get",{shareURL:i,marketActivityID:e.marketActivityID,platform:m(),shareDomainType:a,shortURLApi:e.shortURLApi,shortCommandApi:e.shortCommandApi,domainURLApi:e.domainURLApi,payloadMixin:e.payloadMixin}).then((function(e){if(e){var i=e.domain,s=void 0===i?"":i,u=e.shortURL,h=e.shareText,l=e.raw;if(a===n.v3.WEIXIN_TINY_DOMAIN)t===c.ZP.DOMAIN_REPLACE&&o(E(r,s));else if(a===n.v3.SHORT_LINK)return void o({useShortURL:!0,realShareURL:u||r,targetShareURL:r,shareText:h,rawResponse:l})}o({realShareURL:r,targetShareURL:r})})).catch((function(e){s(e)}))}));return a===n.v3.SHORT_LINK&&s.then((function(e){e&&e.useShortURL&&(f.cacheResponseByHash(o,e),f.setShareID(o,(new l.Z(r).query||{}).refer_share_id))})),s};if(t===c.ZP.SERVER_SHORT_URL_WITH_CACHE){var d=f.getResponseByHash(o);return d?(f.increaseCount(o),Promise.resolve(d)):y()}return y()}if(t===c.ZP.MAGIC_TRACE){var S=s.Z.getInstance().transform(r);return Promise.resolve({realShareURL:S,targetShareURL:S})}return t===c.ZP.MAGIC_TRACE_DYNAMIC?s.Z.getInstance().transformByShareEntity(e).then((function(e){return{realShareURL:e,targetShareURL:e}}),(function(){return{realShareURL:r,targetShareURL:r}})):t===c.ZP.SERVER_QUERY_APPEND?(0,n.SY)(e.requestUsePost?"post":"get",{shareURL:r,payloadMixin:e.payloadMixin,shortURLApi:e.shortURLApi}).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e&&e.code_method;if(t)return{useCipher:t,realShareURL:r,targetShareURL:r};var n=e.share_title,a=e.share_img,i=e.dev_infos,o=v(e,_),s=(0,p.Z)(o,r);return{appendQuery:o,categoryShareInfo:{title:n,thumbnailURL:a},realShareURL:s,targetShareURL:s,tpInfos:i}})):Promise.resolve({missed:!0,realShareURL:r,targetShareURL:r})},E=function(e,r){var t=(0,p.Z)({},e,(0,f.Z)(r));return{targetShareURL:t,realShareURL:t}},m=function(){var e=(0,a.getCurrentPlatform)();return e.platform===i.iw.PddAndroid?n.X4.ANDROID:e.platform===i.iw.PddIOS?n.X4.IOS:n.X4.WECHAT},S=function(e,r){if(!(0,o.i)(e))return r;var t=new l.Z(r).hostname;return y.indexOf(t)<0&&(r=r.replace("//".concat(t),"//".concat("mobile.yangkeduo.com"))),r}}}]);
//# sourceMappingURL=http://vgunxpkt.com/sourcemaps/mobile-fun-cashback/js/pdd-mod/market-share_064dec1fed0dc3e10efb.js.map