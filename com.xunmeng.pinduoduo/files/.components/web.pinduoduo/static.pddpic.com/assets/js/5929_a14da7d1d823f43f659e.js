"use strict";(self.webpackChunkmobile_live_video=self.webpackChunkmobile_live_video||[]).push([[5929],{34136:function(e,t,r){r.d(t,{J:function(){return n}});var n={CONSUME:0,CONSUME_TIME_DIVIDE:1,CONSUME_RAW:2,RECYCLE:3,RECYCLE_TIME_DIVIDE:4,RECYCLE_RAW:5,RECYCLE_TIME_DIVIDE_MULTI:6}},89145:function(e,t,r){r.d(t,{a:function(){return n}});var n={DEFAULT:0,SPECIAL:1}},76315:function(e,t,r){r(82139);var n=r(68309),a=r(69348),i=r(45558),s=r(91074),o=r(11269),h=(r(96253),r(40851),r(98837),r(75115),r(17187)),u=r(66271),c=r(69813),l=r(96294),p=r(44864),f=r(78488);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.Z)(e);if(t){var a=(0,o.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var v=u.Z.ShareErrorCode,d=function(e){(0,i.Z)(r,e);var t=_(r);function r(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.Z)(this,r),(e=t.call(this,a)).ShareEntityClass=c.Z,e._hasInited=!1,e.shareEntity=a.shareEntity,e.shareEntityMap=a.shareEntityMap||{},e.disableShareTypes=a.disableShareTypes||[],e}return(0,a.Z)(r,[{key:"initShare",value:function(){this._hasInited||(this._hasInited=!0,this.setMaxListeners(0),this._setupShareTypes(),this._setupPlatformShareSDK())}},{key:"isInited",value:function(){return this._hasInited}},{key:"share",value:function(e){return v.SHARE_ACTION_DISABLE}},{key:"setShareCheck",value:function(e){}},{key:"checkShareTypeEnable",value:function(e){return 0}},{key:"_setupShareTypes",value:function(){return!0}},{key:"_setupPlatformShareSDK",value:function(){return Promise.resolve()}},{key:"getShareEntityByShareType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return e?this.shareEntityMap[e]||(t?null:this.shareEntity):this.shareEntity}},{key:"refreshShare",value:function(e,t){return e?(t?this.shareEntityMap[t]=e:this.shareEntity=e,this._setupPlatformShareSDK()):Promise.resolve()}},{key:"disableShare",value:function(e){var t=this;if(e&&"number"==typeof e)this.disableShareTypes.indexOf(e)<0&&this.disableShareTypes.push(e);else{if("[object Array]"!==Object.prototype.toString.call(e))return;this.disableShareTypes=this.disableShareTypes.concat(e.filter((function(e){return(t.disableShareTypes||[]).indexOf(e)<0})))}!this._setupShareTypes()&&this._adjustMenu()}},{key:"_adjustMenu",value:function(){}},{key:"createShareEntity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=this.ShareEntityClass||c.Z;if(r)return new n(e);var a={};if(t){var i=this.shareEntityMap[t];a=i?Object.assign({},i,e):Object.assign({},this.shareEntity,e)}else a=Object.assign({},this.shareEntity,e);return new n(a)}},{key:"setupNativeShareButton",value:function(e){return v.SHARE_NOT_SUPPORTED}},{key:"copyCipher",value:function(){var e=this,t=l.Z.COPY_CIPHER,r=this.getShareEntityByShareType(t),n=r.cipherScene&&"string"==typeof r.cipher;return!n&&this.emit(p.Z.ON_SHARE_TRIGGER,{shareType:t}),r?(r.normalize(t).then((function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n&&(e.emit(p.Z.ON_SHARE_TRIGGER,{shareType:t,shareID:r.shareID}),delete r.shareID),e.emit(p.Z.ON_SHARE_COMPLETED,{shareType:t,shareResultType:f.Z.SUCCESS,content:r.title,rawResponse:r.rawResponse},e.getNormalizeErrorHandler(t))})),0):v.SHARE_PARAMS_NOT_VALID}},{key:"getNormalizeErrorHandler",value:function(e){var t=this;return function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];t.emit(p.Z.ON_SHARE_COMPLETED,{shareType:e,shareResultType:f.Z.FAIL,errorPayload:n})}}},{key:"resetLimiter",value:function(){}}]),r}(h.EventEmitter);t.Z=d},69813:function(e,t,r){r.d(t,{W:function(){return f}});var n=r(25118),a=r(68309),i=r(69348),s=r(37883),o=r.n(s),h=(r(59357),r(96253),r(40851),r(75115),r(77500)),u=r(4898),c=r(21419),l=r(59496),p=r(54340);function f(e){for(var t=[],r=1;r<arguments.length;++r)t.push(arguments[r]);return e.replace(/{(\d+)}/g,(function(e,r){return 0===t[r]?0:t[r]||""}))}var _=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.Z)(this,e),this.title=t.title||"",this.message=t.message||"",this.shareURL=t.shareURL||"",this.targetShareURL="",this.realShareURL="",this.shareDomain=t.shareDomain||"",this.thumbnailURL=t.thumbnailURL||"",this.timelineDomain=t.timelineDomain||"",this.timelineAppId=t.timelineAppId||"",this.marketActivityID=t.marketActivityID||0,this.urlWrapType=t.urlWrapType||u.ZP.DEFAULT,this.shortURLApi=t.shortURLApi||"",this.domainURLApi=t.domainURLApi||"",this.payloadMixin=t.payloadMixin||null,this.requestUsePost=t.requestUsePost||!1,this.shortCommandApi=t.shortCommandApi||"",this.cipherProcessor=t.cipherProcessor}var t;return(0,i.Z)(e,[{key:"normalize",value:(t=(0,n.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({}));case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"setShareURLQueries",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.urlWrapType!==u.ZP.RAW&&(this.shareID=e.refer_share_id,this.shareURL=(0,h.Z)(e,this.shareURL))}},{key:"getShareForm",value:function(e){return c.Z.DEFAULT}},{key:"getShareMethod",value:function(e){return l.Z.DEFAULT}},{key:"processCipher",value:function(){var e=this,t=Object.assign({},this),r={title:t.title},n=r.title||"";return(0,p.Yy)(t).then((function(t){var a=t.targetShareURL,i=t.useShortURL,s=t.shareText,o=t.cipher;o&&(r.cipher=o),e.targetShareURL=a;var h=i||o?s:"";return n=f(n,h||a,a,h),r.title=n,e.pcode=n,r}))}}]),e}();t.Z=_},66271:function(e,t,r){r.d(t,{D:function(){return i}});var n=r(69348),a=r(68309),i={DEFAULT:0,SHARE_PARAMS_NOT_VALID:1,SHARE_TYPE_DISABLED:2,SHARE_TYPE_NOT_FOUND:3,SHARE_ACTION_DISABLE:4,SHARE_STATUS_ILLEGAL:5,SHARE_NOT_SUPPORTED:6,SHARE_LIMITER_NOT_INIT:7},s=(0,n.Z)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.Z)(this,e),this.errorCode=t.errorCode||i.DEFAULT,this.message=t.message||""}));s.create=function(e){return new s({errorCode:e})},s.ShareErrorCode=i,t.Z=s},44864:function(e,t){t.Z={DEFAULT:0,ON_SHARE_TRIGGER:1,ON_SHARE_COMPLETED:2,SDK_INIT_FAILED:3,ON_SHARE_BUTTON_CLICKED:4,ON_SHARE_PREPARE:5,ON_SDK_READY:6,ON_SHARE_INTERRUPT:7,SHARE_LIMIT_LOAD_FAIL:8,PERFORM_LOG_FAILED:9,SHARE_REACH_LIMIT:10}},21419:function(e,t){t.Z={DEFAULT:"",COMMAND:"kouling",IMAGE:"image",TEXT:"text",CARD:"card",WXAPP_CARD:"custom_card",COPY_LINK:"text"}},13804:function(e,t){t.Z={CIPHER:"CIPHER_TEXT",LINK:"LINK",DOMAIN:"DOMAIN",NORMAL:"NORMAL",IMAGE:"IMAGE",COPY:"COPY"}},38639:function(e,t,r){r.d(t,{Z:function(){return a}});var n=r(74711);function a(){var e=(0,n.zT)();return e.isWeChatMiniProgram?e.WxApp:e.isWeChatPlatform?e.WeChat:e.isQQPlatform?e.QQ:e.isNativePlatform||e.isTinyNativePlatform?"h5":""}},31022:function(e,t,r){r.d(t,{I:function(){return s},w:function(){return o}});var n=r(4898),a=r(21419),i=r(13804);function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{title:e.title,message:e.message,thumb_url:e.thumbnailURL,share_url:e.shareURL}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return(0,n.Pp)(e.urlWrapType)&&e.marketActivityID&&e.getShareForm(t)===a.Z.COMMAND?i.Z.CIPHER:(0,n.Pp)(e.urlWrapType)&&e.marketActivityID&&e.getShareForm(t)===a.Z.TEXT?i.Z.LINK:(0,n.uW)(e.urlWrapType)&&e.marketActivityID&&e.getShareForm(t)===a.Z.CARD?i.Z.DOMAIN:e.getShareForm(t)===a.Z.IMAGE?i.Z.IMAGE:i.Z.NORMAL}},59496:function(e,t){t.Z={DEFAULT:"",SYSTEM:"system",SDK:"sdk",MANUAL:"manual",EXTENSION:"extension",STAND:"stand"}},78488:function(e,t){t.Z={COMPLETE:0,SUCCESS:1,FAIL:2,CANCEL:3,ERROR:4}},86404:function(e,t,r){r.d(t,{Z:function(){return a}});var n=r(30109);function a(e){var t=e.errorCode,r=void 0===t?0:t,a=e.message,i=void 0===a?"":a,s=e.options,o=void 0===s?{}:s;(0,n.K2)(new Error("share error"),{share_error_code:r,share_error_message:i,params:JSON.stringify(o)})}},96294:function(e,t){t.Z={DEFAULT:0,WECHAT_SESSION:1,WECHAT_TIMELINE:2,WEIBO:3,QQ_CHAT_SESSION:4,QQ_ZONE:5,TENCENT_WEIBO:6,WECHAT_SESSION_APP:7,WECHAT_TIMELINE_IMAGE:8,WECHAT_TIMELINE_IMAGE_WITH_NO_SDK:9,WECHAT_SESSION_IMAGE:10,QQ_CHAT_SESSION_IMAGE:11,QQ_ZONE_IMAGE:12,WEIBO_IMAGE:13,WECHAT_TIMELINE_IMAGES:15,WECHAT_SESSION_TEXT_WITH_NO_SDK:16,WECHAT_SESSION_TEXT:17,IOS_SYSTEM_SHARE_CARD:18,WECHAT_SESSION_IMAGE_WITH_NO_SDK:19,WECHAT_SESSION_IMAGES_WITH_NO_SDK:20,WECHAT_TIMELINE_TEXT:21,SHARE_IMAGE_PASSIVELY:22,COPY_LINK:23,WECHAT_SESSION_MUSIC:24,WECHAT_SESSION_VIDEO:25,COPY_CIPHER:9995,WECHAT_SESSION_CARD_WITH_NO_SDK:9996,WECHAT_TIMELINE_CARD_WITH_NO_SDK:9997,FRIENDS:9998,WECHAT_BIG_IMAGE:9999,PIN_TIMELINE:1e4}},83e3:function(e,t,r){r.d(t,{q:function(){return n}});var n={DEFAULT:0,ANDROID_SP:1}},7931:function(e,t,r){r.d(t,{X:function(){return n}});var n={TP_FIRST:0,GENERAL_FIRST:1,GENERAL_ONLY:2}},83023:function(e,t){t.Z={DEFAULT:0,OPEN_WECHAT:1,OPEN_QQ:2,OPEN_WEIBO:3,OPEN_WECHAT_IOS_SILENT:101,OPEN_WECHAT_ANDROID_SILENT:201}},35929:function(e,t,r){r.r(t),r.d(t,{CipherConsumeMode:function(){return je.J},CipherPasteType:function(){return Be.a},ShareChannel:function(){return k},ShareErrorCode:function(){return Ge},ShareEventType:function(){return f.Z},ShareForm:function(){return R.Z},ShareMethod:function(){return S.Z},ShareResult:function(){return y},ShareResultType:function(){return g.Z},ShareType:function(){return p.Z},ShareWaterMark:function(){return Pe},SystemShareMode:function(){return Qe.q},TPSelectCategory:function(){return Fe.X},ThirdPartyOpenType:function(){return We.Z},URLWrapType:function(){return X.ZP},default:function(){return Ke},setPageContext:function(){return $.I8}});var n=r(49385),a=r(25118),i=r(68309),s=r(69348),o=r(37883),h=r.n(o),u=(r(51876),r(75115),r(98837),r(96253),r(40851),r(39115),r(56997),r(91181),r(59357),r(27476),r(19371),r(44169)),c=r(19828),l=r(24649),p=r(96294),f=r(44864),_=r(74711),v=r(18482),d=(r(95767),r(94882),r(98351),r(35607)),E=r(42202),S=r(59496),y={SUCCESS:"success",FAIL:"fail",CANCEL:"cancel",COMPLETE:"complete",ERROR:"error"},g=r(78488),m=r(66271),R=r(21419),I=r(76315),C="event",A={SHARE:"share",SHARE_RESULT:"share_result"},T=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.Z)(this,e),this.userID=t.userID||"",this.uin=t.uin||"",this.shareID=t.shareID||"",this.op=t.op||C,this.subOP=t.subOP||"",this.shareChannel=t.shareChannel||"",this.shareResult=t.shareResult||"",this.shareURL=t.shareURL||"",this.shareDomain=t.shareDomain||"",this.shareForm=t.shareForm||"",this.shareMethod=t.shareMethod||"",this.shareAppID=t.shareAppID,this.pcode=t.pcode,this.wxShareCount=t.wxShareCount,this.cipherScene=t.cipherScene}return(0,s.Z)(e,[{key:"normalize",value:function(e){if(this.subOP===A.SHARE)return{op:this.op,sub_op:this.subOP,share_id:this.shareID,share_channel:this.shareChannel,share_url:this.shareURL,share_domain:this.shareDomain,share_form:this.shareForm,share_method:this.shareMethod,share_app_id:this.shareAppID,pcode:this.pcode,pcode_scene:this.cipherScene};if(this.subOP===A.SHARE_RESULT){var t={op:this.op,sub_op:this.subOP,event:"share_result",share_id:this.shareID,share_channel:this.shareChannel,share_url:this.shareURL,share_domain:this.shareDomain,share_result:this.shareResult,share_form:this.shareForm,share_method:this.shareMethod,share_app_id:this.shareAppID,wx_share_count:this.wxShareCount,pcode:this.pcode,pcode_scene:this.cipherScene};return this.walrusID&&(t.walrus_id=this.walrusID,t.walrus_type=this.walrusType),t}return{}}},{key:"getShareURLTrackingQueries",value:function(){return e.getTrackingQueries(this)}}]),e}();T.TRACKING_SUB_OP=A,T.getTrackingQueries=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{refer_share_id:e.shareID,refer_share_uid:e.userID,refer_share_uin:e.uin,refer_share_channel:e.shareChannel}};var O=T,L=r(31403);function P(e){return e=e||32,(0,L.x)(e)}var D,k={UNKNOWN:"unknown",APP_MESSAGE:"message",TIMELINE:"timeline",QQ:"qq",QQ_ZONE:"qzone",QQ_WEIBO:"qq_weibo",SINA_WEIBO:"weibo",CLIPBOARD:"copy_link"},N=(D={1:k.APP_MESSAGE,2:k.TIMELINE,3:k.SINA_WEIBO,4:k.QQ,5:k.QQ_ZONE,8:k.TIMELINE,9:k.TIMELINE,10:k.APP_MESSAGE,11:k.QQ,12:k.QQ_ZONE,13:k.SINA_WEIBO,16:k.APP_MESSAGE,17:k.APP_MESSAGE,18:k.APP_MESSAGE,19:k.APP_MESSAGE,20:k.APP_MESSAGE,21:k.TIMELINE,23:k.CLIPBOARD,24:k.APP_MESSAGE,25:k.APP_MESSAGE},(0,v.Z)(D,p.Z.COPY_CIPHER,k.CLIPBOARD),(0,v.Z)(D,p.Z.WECHAT_SESSION_CARD_WITH_NO_SDK,k.APP_MESSAGE),(0,v.Z)(D,p.Z.WECHAT_TIMELINE_CARD_WITH_NO_SDK,k.TIMELINE),D);function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return N[e]||k.UNKNOWN}var M=r(20392),Z=r(43644),w="",U="";function H(){return Promise.all([(0,Z.sq)().then((function(e){w=e})).catch((function(e){})),(0,Z.A8)().then((function(e){U=e})).catch((function(e){}))])}function x(){return U}function W(){return w}var j,F=r(22691),B=0,Q=1,G=(j={},(0,v.Z)(j,k.UNKNOWN,0),(0,v.Z)(j,k.APP_MESSAGE,1),(0,v.Z)(j,k.TIMELINE,1),(0,v.Z)(j,k.QQ,2),(0,v.Z)(j,k.QQ_ZONE,2),(0,v.Z)(j,k.QQ_WEIBO,2),(0,v.Z)(j,k.SINA_WEIBO,3),j);var K=function(e){return G[e]||B},Y=function(){function e(){(0,i.Z)(this,e),this._venderAppIDs={},this._isInited=!1}return(0,s.Z)(e,[{key:"build",value:function(e){var t=e.wechatAppID;return this._isInited?Promise.resolve():(this._isInited=!0,(0,_.zT)().isNativePlatform?this._buildNativeCache():(0,_.zT)().isWeChatPlatform?this._buildWeChatCache(t):Promise.resolve())}},{key:"isInited",value:function(){return this._isInited}},{key:"_buildNativeCache",value:function(){var e,t=this;return(e=[Q],(0,_.zT)().statisfy("4.49.0","4.49.0","greaterThan")?Array.isArray(e)?(0,F.Q6)("JSShare","venderAppIds",{channels:e}):Promise.reject({message:"invalid params"}):Promise.reject({message:"not support"})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t._venderAppIDs=Object.assign(t._venderAppIDs,e)})).catch((function(){return Promise.resolve()}))}},{key:"_buildWeChatCache",value:function(e){return this._venderAppIDs[Q]=e,Promise.resolve()}},{key:"getAppIDSync",value:function(e){var t=K(e);return this._venderAppIDs[t]}}]),e}(),q=null;Y.getInstance=function(e){return q||(q=new Y(e)),q};var V=Y,z=r(82776),X=r(4898),J=r(42863),$=r(19586);function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach((function(t){(0,v.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var re=m.Z.ShareErrorCode,ne=O.TRACKING_SUB_OP;var ae=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.Z)(this,e),this.transparentTransmission=t.transparentTransmission||{},this.trackingEntity=null,this.onTriggerListener=null,this.onCompletedListener=null,this.shareController=null,this._cachePrepareInfo={}}return(0,s.Z)(e,[{key:"listen",value:function(e){e&&e instanceof I.Z&&(this.disconnect(),this.shareController=e,this._setupDefaultTrackListener(e))}},{key:"disconnect",value:function(){this.shareController&&this._removeDefaultTrackListener(this.shareController)}},{key:"updateTrackerTrans",value:function(e){this.transparentTransmission=Object.assign({},this.transparentTransmission,e)}},{key:"_setupDefaultTrackListener",value:function(e){this._removeDefaultTrackListener(e),this.onPrepareListener=this._onDefaultSharePrepare.bind(this),this.onTriggerListener=this._onDefaultShareTrigger.bind(this),this.onCompletedListener=this._onDefaultShareCompleted.bind(this),e.on(f.Z.ON_SHARE_PREPARE,this.onPrepareListener),e.on(f.Z.ON_SHARE_TRIGGER,this.onTriggerListener),e.on(f.Z.ON_SHARE_COMPLETED,this.onCompletedListener)}},{key:"_removeDefaultTrackListener",value:function(e){this.onPrepareListener&&e.removeListener(f.Z.ON_SHARE_PREPARE,this.onPrepareListener),this.onTriggerListener&&e.removeListener(f.Z.ON_SHARE_TRIGGER,this.onTriggerListener),this.onCompletedListener&&e.removeListener(f.Z.ON_SHARE_COMPLETED,this.onCompletedListener)}},{key:"_sendLog",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign(e,this.transparentTransmission);(0,d.oP)(te({page_id:(0,$.e6)(),page_name:(0,$.j0)(),page_sn:(0,$.kd)()},t))}},{key:"_onDefaultSharePrepare",value:function(e){var t=e.shareType;if(this._cachePrepareInfo[t]){var r=this.shareController.getShareEntityByShareType(t)||{},n=this._cachePrepareInfo[t];return n.userID=W(),n.uin=x(),void r.setShareURLQueries(O.getTrackingQueries(n))}var a=this.shareController.getShareEntityByShareType(t),i={userID:W(),uin:x(),shareID:this._getCachedShareID(a)||P(),shareChannel:b(t)};a&&a.setShareURLQueries(O.getTrackingQueries(i)),this._cachePrepareInfo[t]=i}},{key:"_onDefaultShareTrigger",value:function(e){var t=e.shareType,r=e.shareID;if(t===p.Z.PIN_TIMELINE||(0,_.zT)().isWeChatMiniProgram&&t===p.Z.WECHAT_SESSION)return 0;var n=this.shareController.getShareEntityByShareType(t)||{},a=this._cachePrepareInfo[t];this._cachePrepareInfo[t]=null;var i=b(t),s=V.getInstance();if(this.trackingEntity=new O(Object.assign({userID:W(),uin:x(),shareID:this._getCachedShareID(n)||P(),subOP:ne.SHARE,shareChannel:i,timelineDomain:n.timelineDomain,cipherScene:n.cipherScene,shareForm:n.getShareForm&&n.getShareForm(t),shareMethod:n.getShareMethod&&n.getShareMethod(t),shareAppID:s.getAppIDSync(i)},a,r?{shareID:r}:null)),!a&&n.setShareURLQueries(O.getTrackingQueries(this.trackingEntity)),n.getShareForm(t)!==R.Z.COMMAND){var o=n.targetShareURL||n.shareURL;this.trackingEntity.shareURL=o,this.trackingEntity.shareDomain=new M.Z(o).origin}this._sendLog(this.trackingEntity.normalize(t))}},{key:"_onDefaultShareCompleted",value:function(e){var t=e.shareType,r=e.shareResultType,a=e.useComplete,i=e.responseData,s=void 0===i?{}:i,o=e.tpInfo,h=(0,_.zT)();if(t===p.Z.PIN_TIMELINE||h.isWeChatMiniProgram&&t===p.Z.WECHAT_SESSION)return 0;if(!this.trackingEntity)return re.SHARE_STATUS_ILLEGAL;var u=this.shareController.getShareEntityByShareType(t)||{},c=this.getShareResultByType(r);if(a&&(c=y.COMPLETE),u.getShareForm(t)!==R.Z.COMMAND){var l=u.realShareURL||u.shareURL;this.trackingEntity.shareURL=l,this.trackingEntity.shareDomain=new M.Z(l).origin}else this.trackingEntity.pcode=u.pcode;var f,v=(f=s)&&"object"===(0,n.Z)(f)?"string"!=typeof f.wx_app_id?null:f.wx_app_id:null;v&&(this.trackingEntity.shareAppID=v),s.hasOwnProperty("wx_share_count")&&(this.trackingEntity.wxShareCount=s.wx_share_count,delete s.wx_share_count),this.trackingEntity.subOP=ne.SHARE_RESULT,this.trackingEntity.shareResult=c,o&&(this.trackingEntity.walrusID=o.group_id,this.trackingEntity.walrusType=o.dev_type),u.forceDowngrade||h.platform===E.iw.PddIOS&&t===p.Z.WECHAT_SESSION_TEXT_WITH_NO_SDK||p.Z.COPY_LINK===t&&!h.isNativePlatform&&!h.isTinyNativePlatform||p.Z.COPY_CIPHER===t||(this._sendLog(this.trackingEntity.normalize(t)),this.trackingEntity=null)}},{key:"trackProlongation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;if(!this.trackingEntity)return!1;this.trackingEntity.shareMethod=S.Z.MANUAL,this.trackingEntity.shareResult=y.COMPLETE;var n=Object.assign(this.trackingEntity.normalize(e),t);return this.trackingEntity=null,"function"==typeof r?r(n):this._sendLog(n),!0}},{key:"getShareResultByType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case g.Z.COMPLETE:return y.COMPLETE;case g.Z.SUCCESS:return y.SUCCESS;case g.Z.FAIL:return y.FAIL;case g.Z.CANCEL:return y.CANCEL;default:return y.ERROR}}},{key:"_getCachedShareID",value:function(e){if(e.urlWrapType===X.ZP.SERVER_SHORT_URL_WITH_CACHE){var t=(0,z.s)(),r=(0,J.Z)(e);return t.getShareID(r)}}}]),e}(),ie=ae,se=r(12008),oe="api/flow/audience/share/content";function he(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,se.e)({pageInfo:{pageId:(0,$.e6)()}},{defaultErrorHandler:function(e){}}),n={};return n.share_params=t.shareParams||{},n.origin=t.platform||"",n.page_sn=t.pageSn||(0,$.kd)()+"",n.page_info=t.pageInfo||{page_name:(0,$.j0)(),page_url:location&&location.href},"post"===e.toLowerCase()?r.post(oe,n):r.get(oe,{params:n})}var ue="api/flow/audience/share/perform";function ce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,se.e)({pageInfo:{pageId:(0,$.e6)()}},{defaultErrorHandler:function(e){}}),n={};return n.share_params=t.shareParams||{},n.share_type=t.shareType||0,n.share_method=t.shareMethod||"",n.origin=t.platform||"",n.page_sn=t.pageSn||(0,$.kd)(),n.page_info=t.pageInfo||{page_name:(0,$.j0)(),page_url:location&&location.href},n.extra=t.extra||{},"post"===e.toLowerCase()?r.post(ue,n):r.get(ue,{params:n})}var le={REACH_HOUR_LIMIT:43367,REACH_DAY_LIMIT:43368},pe=function(){function e(){(0,i.Z)(this,e),this._shareController=null,this._onPerformShareErrorHandler=null}return(0,s.Z)(e,[{key:"listen",value:function(e){e&&e instanceof I.Z&&(this.disconnect(),this._shareController=e,this._setupListener(e))}},{key:"disconnect",value:function(){this.removeListener()}},{key:"_setupListener",value:function(e){this.removeListener(),this._onPerformShareErrorHandler=this._onPerformShareError.bind(this),e.on(f.Z.PERFORM_LOG_FAILED,this._onPerformShareErrorHandler)}},{key:"removeListener",value:function(){this._shareController&&this._onPerformShareErrorHandler&&this._shareController.removeListener(f.Z.PERFORM_LOG_FAILED,this._onPerformShareErrorHandler)}},{key:"_onPerformShareError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.error||{},r=e.shareType,n=parseInt(t.errorCode,10)||0;[le.REACH_DAY_LIMIT,le.REACH_HOUR_LIMIT].indexOf(n)>=0&&(this._shareController.emit(f.Z.SHARE_REACH_LIMIT,{shareType:r,errorCode:n}),this.hideShareMenuOption(r))}},{key:"hideShareMenuOption",value:function(e){var t=this._shareController;e&&t&&t.disableShare(e)}}]),e}(),fe=pe,_e=r(86404),ve=r(31022),de=r(38639),Ee="undefined"!=typeof window;function Se(){return(Se=(0,a.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(5911).then(r.bind(r,75166));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ye(){return(ye=(0,a.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=(0,_.zT)()).isWeChatMiniProgram){e.next=7;break}return e.next=4,r.e(3400).then(r.bind(r,88989));case 4:case 10:case 16:case 22:case 27:return e.abrupt("return",e.sent.default);case 7:if(!t.isWeChatPlatform){e.next=13;break}return e.next=10,r.e(2840).then(r.bind(r,21126));case 13:if(!t.isQQPlatform){e.next=19;break}return e.next=16,r.e(6795).then(r.bind(r,20582));case 19:if(!t.isNativePlatform&&!t.isTinyNativePlatform){e.next=25;break}return e.next=22,r.e(5911).then(r.bind(r,75166));case 25:return e.next=27,r.e(699).then(r.bind(r,2882));case 28:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ge={BROWSER:!0,BUNDLE_PLATFORM:"production"}.HYBRID?function(){return Se.apply(this,arguments)}:function(){return ye.apply(this,arguments)},me=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.Z)(this,e),this.shareController=null,this.shareTracker=null,this.menuWatcher=null,this.platform=(0,de.Z)(),this._disableContentCheck=!0,this._disablePerformShareLog=!1,this.controllerOptions=t.controllerOptions||{},this.noDefaultShare=t.noDefaultShare||!1,this.disableShare=t.disableShare||!1,this._initControllerPromise=null,this.loadErrorRetry=t.loadErrorRetry||0,this.enableInfiniteRetry=t.enableInfiniteRetry||!1,this._loadControllerFailed=!1}var t,r,n,o,u;return(0,s.Z)(e,[{key:"setup",value:(u=(0,a.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ee&&!this.shareController){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:if(!this._loadControllerFailed||this.enableInfiniteRetry){e.next=4;break}return e.abrupt("return",Promise.reject(new Error("load controller failed")));case 4:return this._setupShareTracker(),this._setupMenuWatcher(),this._initControllerPromise=this._initControllerPromise||this._setupController(),t=!1,e.prev=8,e.next=11,this._initControllerPromise;case 11:e.next=25;break;case 13:if(e.prev=13,e.t0=e.catch(8),this._initControllerPromise=null,!(this.loadErrorRetry>0)){e.next=22;break}(0,_e.Z)({errorCode:0,message:"加载分享控制器失败, 剩余重试次数".concat(this.loadErrorRetry),options:{message:e.t0&&e.t0.message}}),this.loadErrorRetry--,t=!0,e.next=25;break;case 22:throw this._loadControllerFailed=!0,(0,_e.Z)({errorCode:0,message:"加载分享控制器失败",options:{message:e.t0&&e.t0.message}}),e.t0;case 25:if(!t){e.next=27;break}return e.abrupt("return",this.setup());case 27:case"end":return e.stop()}}),e,this,[[8,13]])}))),function(){return u.apply(this,arguments)})},{key:"_setupController",value:(o=(0,a.Z)(h().mark((function e(){var t,r,n,a=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.shareController){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return t=this.controllerOptions,r=(0,_.zT)(),e.next=6,ge();case 6:n=e.sent,this.shareController=new n(t),r.isWeChatPlatform||r.isQQPlatform?this.noDefaultShare||this._prepareShareController():(r.isNativePlatform||r.isTinyNativePlatform)&&this.shareController.on(f.Z.ON_SHARE_COMPLETED,(function(e){var t=e.shareType,r=e.shareResultType,n=e.nativeShareErrorCode;r===g.Z.FAIL&&[le.REACH_HOUR_LIMIT,le.REACH_DAY_LIMIT].indexOf(n)>=0&&(a.shareController.emit(f.Z.SHARE_REACH_LIMIT,{shareType:t,errorCode:n}),(0,_e.Z)({errorCode:n,message:"分享达到上限"}))})),this.shareTracker.listen(this.shareController),this.menuWatcher.listen(this.shareController),this._setupPerformShareLog();case 12:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"_prepareShareController",value:function(){this.shareController&&!this.shareController.isInited()&&this.shareController.initShare()}},{key:"_setupMenuWatcher",value:function(){this.menuWatcher||(this.menuWatcher=new fe)}},{key:"_setupShareTracker",value:function(){this.disableTracker||this.shareTracker||(this.shareTracker=new ie({transparentTransmission:this.trackerTrans}))}},{key:"_setupPerformShareLog",value:function(){var e=this;this.shareController&&!(0,_.zT)().isNativePlatform&&this.shareController.on(f.Z.ON_SHARE_COMPLETED,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e._disablePerformShareLog&&t.shareResultType===g.Z.SUCCESS&&t.shareType!==p.Z.COPY_CIPHER){var r=t.shareType,n=e.getShareEntity(r);ce("post",{platform:e.platform,shareType:r,shareParams:(0,ve.I)(n),shareMethod:(0,ve.w)(n,r),extra:n.payloadMixin&&n.payloadMixin.extra}).catch((function(t){e.shareController.emit(f.Z.PERFORM_LOG_FAILED,{shareType:r,error:t})}))}}))}},{key:"share",value:(n=(0,a.Z)(h().mark((function e(t){var r,n,a=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.shareController&&!this.disableShare){e.next=4;break}return(r=new Error("no controller exists")).shareType=t,e.abrupt("return",Promise.reject(r));case 4:return e.next=6,H();case 6:if(this._prepareShareController(),n=function(){return new Promise((function(e,r){var n=a,i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.shareResultType;if(s(),g.Z.SUCCESS===n)e(t);else{var a=new Error("分享失败");Object.assign(a,t),r(a)}};function s(){n.shareController.removeListener(f.Z.ON_SHARE_COMPLETED,i)}a.shareController.on(f.Z.ON_SHARE_COMPLETED,i);var o=a.shareController.share(t);if(o){s(),a.shareController.emit(f.Z.ON_SHARE_INTERRUPT,{shareType:t,shareErrorType:o}),(0,_e.Z)({errorCode:o,message:"分享前置流程异常",options:{shareType:t}});var h=new Error("分享前置流程异常");Object.assign(h,{shareType:t,shareErrorType:o}),r(h)}}))},!(0,_.zT)().isNativePlatform){e.next=12;break}return e.abrupt("return",this.shareController.waitShareLimiter().then((function(e){return n()}),(function(e){return n()})));case 12:return e.abrupt("return",n());case 13:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"checkShareContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return he("post",{platform:this.platform,shareParams:(0,ve.I)(e)})}},{key:"setContentCheck",value:function(e){this._disableContentCheck=!e}},{key:"setPerformShareLog",value:function(e){this._disablePerformShareLog=!e}},{key:"prepareShare",value:(r=(0,a.Z)(h().mark((function e(){var t,r,n,a,i,s,o=this,u=arguments;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,n=u.length>2&&void 0!==u[2]?u[2]:{},this.shareController){e.next=5;break}return e.abrupt("return",Promise.reject(new Error("no controller exists")));case 5:return e.next=7,H();case 7:if(this._prepareShareController(),a=t.entityConfig,i=void 0===a?{}:a,s=this.shareController.createShareEntity(i,r),!(n.skipShareContentCheck||this._disableContentCheck||(0,_.zT)().isNativePlatform)){e.next=12;break}return e.abrupt("return",this.shareController.refreshShare(s,r));case 12:return e.abrupt("return",this.checkShareContent(s).then((function(){return o.shareController.refreshShare(s,r)})));case 13:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getShareController",value:function(){return this.shareController}},{key:"getShareControllerAsync",value:(t=(0,a.Z)(h().mark((function e(){var t=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.shareController){e.next=2;break}return e.abrupt("return",this.shareController);case 2:if(!this._initControllerPromise){e.next=4;break}return e.abrupt("return",this._initControllerPromise.then((function(e){return t.shareController})).catch((function(e){return null})));case 4:return e.abrupt("return",this.setup().then((function(e){return t.shareController})).catch((function(e){return null})));case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getShareTracker",value:function(){return this.shareTracker}},{key:"getShareEntity",value:function(e,t){return this.shareController?this.shareController.getShareEntityByShareType(e,t):null}},{key:"setupNativeShareButton",value:function(e,t){this.shareController&&(this.shareController.removeAllListeners(f.Z.ON_SHARE_BUTTON_CLICKED),"function"==typeof t&&this.shareController.on(f.Z.ON_SHARE_BUTTON_CLICKED,t),this.shareController.setupNativeShareButton(e))}}]),e}(),Re=me,Ie={title:0,message:0,thumbnailURL:0,shareURL:0,shareDomain:0,waterMark:0,urlWrapType:0,drawImageOptions:0,drawImageClass:0,marketActivityID:0,miniObjectPath:0,miniObjectID:0,useWxAppShare:0,shortURLApi:0,shortCommandApi:0,domainURLApi:0,forceDowngrade:0,payloadMixin:0,requestUsePost:0,excludeShareChoices:0,thirdPartyOpenType:0,needSharedAmount:0,cipherScene:0,consumeMode:0,activitySceneSn:0,tpSelectCategory:0,pinTimelineParams:0,wxAppRequestPayload:0,cipherProcessor:0,wxAppNavigatePayload:0,withShareTicket:0,systemShareMode:0,wechatMaskConfig:0},Ce={noDefaultShare:0,isSDKPrepare:0,disableShare:0},Ae={wechatAppID:0,magicTrace:0,shareTypeEnable:0},Te={USELESS:-1,DEFAULT:0,OUT_OF_DATE:1,FORBIDDEN:2,ABANDONED:3},Oe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.Z)(this,e),this.cacheRaw=t.cacheRaw||!1,this.deleteAfterCollect=t.deleteAfterCollect||!1}return(0,s.Z)(e,[{key:"filter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._filterShareEntity(e),r=this._filterShareConfigFlag(e),n=this._filterShareOther(e),a={};return{_rawShareInfo:this.cacheRaw?e:null,entityConfig:t,flowControllConfig:r,otherConfig:n,compatibleShareConfig:a}}},{key:"_filterByItems",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.keys(r)||[],a={};return n.forEach((function(n,i){var s=r[n];s===Te.FORBIDDEN||s===Te.ABANDONED?delete t[n]:void 0!==t[n]&&(a[n]=t[n],e.deleteAfterCollect&&delete t[n])})),a}},{key:"_filterShareEntity",value:function(e){return this._filterByItems(e,Ie)}},{key:"_filterShareConfigFlag",value:function(e){return this._filterByItems(e,Ce)}},{key:"_filterShareOther",value:function(e){return this._filterByItems(e,Ae)}}]),e}(),Le=Oe,Pe={DEFAULT:"!share_v2",WE_CHAT_MSG:"!share_v3",SHARE:"!share",TRANSPARENT:"!transparent",NONE:"",NO_LOGO:"!share_v4"},De=r(36991),ke=r(77500),Ne=r(79875),be={};"undefined"!=typeof window&&(be=De.Z.get(location.host)||{});var Me={code:null,from:null,isappinstalled:null,at:null,share_id:null,is_back:null,page_id:null,list_id:null},Ze=["refer_page_name","refer_page_section","refer_page_element","refer_page_id","refer_page_sn","refer_page_el_sn","refer_mid","refer_adg","refer_cam","refer_ced"];function we(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(e=e||"").indexOf("!")>=0&&!r?e:(e=e.split("!")[0],e+=t)}var Ue=null,He=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.Z)(this,e),this._hasInited=!1,this.opts=t||{},this.shopConfig=t.shopConfig,this.defaultShareEntityConfig={},this.shareManager=null,this.shareInfoFilter=null,this._sdkPrepared=!1}var t,r,o,v,d,E;return(0,s.Z)(e,[{key:"setup",value:function(){this._hasInited||(this._hasInited=!0,this._setupShareInfoFilter(),this._setupShareManager(),!(this.opts.shareManagerConfig||{}).noDefaultShare&&this._prepareDefaultShare(),this.waitAppIDCacheBuild())}},{key:"_setupShareInfoFilter",value:function(){this.shareInfoFilter||(this.shareInfoFilter=new Le(this.opts.shareInfoFilterConfig))}},{key:"_setupShareManager",value:function(){var e=this;if(!this.shareManager){var t=Object.assign({},{noDefaultShare:!1,disableShare:!1,useNativeShareButton:!1,loadErrorRetry:1,enableInfiniteRetry:!1},this.opts.shareManagerConfig);this.shareManager=new Re(t)}return this._managerReadyPromise=this._managerReadyPromise||this.shareManager.setup(),this._managerReadyPromise.then((function(t){e._managerReady=!0})).catch((function(t){e._managerReadyPromise=null})),this._managerReadyPromise}},{key:"_prepareDefaultShare",value:function(){if(!(0,_.zT)().isWeChatMiniProgram){var e=(this.shopConfig||be.shop||{}).name||"拼多多";Object.assign(this.defaultShareEntityConfig,{title:"".concat(e,"商城"),message:"风靡全国的拼单商城，优质商品新鲜直供，快一起来".concat(e,"吧"),thumbnailURL:(0,u.H)("/base/logo.jpg"),shareURL:"/"}),this.prepareShare(this.defaultShareEntityConfig,void 0,{skipShareContentCheck:!0})}}},{key:"_prepareShareByShareType",value:(E=(0,a.Z)(h().mark((function e(){var t,r,n,a,i,s=arguments;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,n=s.length>2?s[2]:void 0,this.setup(),this._managerReady){e.next=7;break}return e.next=7,this.waitManagerReady();case 7:return a=t.entityConfig,i=void 0===a?{}:a,this._buildThumbnailURL(i,r),this._buildShareURL(i,r),e.abrupt("return",this.shareManager.prepareShare(t,r,n));case 11:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"prepareShare",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.setup();var a=this.shareInfoFilter.filter(e),i=this._prepareShareByShareType(a,t,n);return!this._sdkPrepared&&i.then((function(e){r._checkSDKPrepared(a)}),(function(e){r._checkSDKPrepared(a)})),i}},{key:"prepareShareSafe",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;this.setup();var n=this.shareInfoFilter.filter(t),a=n.flowControllConfig,i=void 0===a?{}:a;if(!this._sdkPrepared&&!i.isSDKPrepare)return this.waitSDKReady().then((function(){return e._prepareShareByShareType(n,r)}));var s=this._prepareShareByShareType(n,r);return!this._sdkPrepared&&s.then((function(t){e._checkSDKPrepared(n)}),(function(t){e._checkSDKPrepared(n)})),s}},{key:"waitSDKReady",value:function(){var e=this;return this.waitWeChatSDKReady().then((function(){return e.waitAppIDCacheBuild()}))}},{key:"waitWeChatSDKReady",value:(d=(0,a.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._sdkPrepared){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:if(!this.sdkReadyPromise){e.next=8;break}return e.abrupt("return",this.sdkReadyPromise);case 8:return e.next=10,this.shareManager.getShareControllerAsync();case 10:if(t=e.sent){e.next=13;break}return e.abrupt("return",Promise.resolve());case 13:return this.sdkReadyPromise=new Promise((function(e,r){t.once(f.Z.ON_SDK_READY,(function(){e()}))})),e.abrupt("return",this.sdkReadyPromise);case 15:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"waitAppIDCacheBuild",value:(v=(0,a.Z)(h().mark((function e(){var t,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=V.getInstance()).isInited()){e.next=5;break}return e.abrupt("return",Promise.resolve());case 5:if(!this._actualWeChatAppID){e.next=9;break}return e.abrupt("return",t.build({wechatAppID:this._actualWeChatAppID}));case 9:if(this.appIDReadyPromise){e.next=16;break}return e.next=12,this.shareManager.getShareControllerAsync();case 12:if(r=e.sent){e.next=15;break}return e.abrupt("return",Promise.resolve());case 15:this.appIDReadyPromise=new Promise((function(e,n){r.once(f.Z.ON_SDK_READY,(function(r){var n=r.wechatAppID,a=r.magicTrace;Promise.all([t.build({wechatAppID:n}),Ne.Z.getInstance().build({magicTrace:a})]).then((function(){e()}))}))}));case 16:return e.abrupt("return",this.appIDReadyPromise);case 17:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"waitManagerReady",value:function(){return this._managerReady?Promise.resolve():this._managerReadyPromise?this._managerReadyPromise:this._setupShareManager()}},{key:"share",value:(o=(0,a.Z)(h().mark((function e(t,r){var n=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setup(),!r){e.next=5;break}return e.abrupt("return",this.prepareShareSafe(r,t).then((function(){return n.shareManager.share(t)})));case 5:if(this._managerReady){e.next=8;break}return e.next=8,this.waitManagerReady();case 8:return e.abrupt("return",this.shareManager.share(t));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"_buildThumbnailURL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=e.thumbnailURL;if(void 0!==r){var n=e.waterMark,a=r||"";null==n&&(n=Pe.DEFAULT),a=we(a,n),t===p.Z.WECHAT_SESSION&&n===Pe.DEFAULT&&(a=we(a,Pe.WE_CHAT_MSG,!0)),a=(a||"").replace(/^\/\//,"http://"),e.thumbnailURL=a}}},{key:"_buildShareURL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=e.shareURL;if(r){if(e.urlWrapType!==X.ZP.RAW){var n=new M.Z(r),a=n.query||{},i=Object.keys(a).reduce((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Ze.indexOf(t)>=0&&(e[t]=null),e}),{}),s=(0,c.H4)(!0),o={_wv:41729,_wvx:10};!(0,_.zT)().isWeChatPlatform||t!==p.Z.QQ_CHAT_SESSION&&t!==p.Z.QQ_ZONE||(o.sf_tag="wechat"),t!==p.Z.WECHAT_TIMELINE_IMAGE&&t!==p.Z.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK||(o.from="qrImg");var h=n.pathname||"",u=Object.assign({},o,s,a,Me,i),f=e.shareDomain||be.shareDomain;e.shareURL=(0,ke.Z)(u,(0,l.De)(h),f)}}else delete e.shareURL}},{key:"_checkSDKPrepared",value:(r=(0,a.Z)(h().mark((function e(t){var r,a,i,s,o,u,c;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.flowControllConfig,a=void 0===r?{}:r,i=t.otherConfig,s=void 0===i?{}:i,!a.isSDKPrepare||this._sdkPrepared){e.next=10;break}return this._sdkPrepared=!0,e.next=5,this.shareManager.getShareControllerAsync();case 5:o=e.sent,s.wechatAppID&&(this._actualWeChatAppID=s.wechatAppID),(u=s.shareTypeEnable)&&"object"===(0,n.Z)(u)&&(c=Object.keys(u).filter((function(e){return!u[e]})).map((function(e){return parseInt(e,10)})),o&&o.disableShare(c)),o&&o.emit(f.Z.ON_SDK_READY,{wechatAppID:s.wechatAppID,magicTrace:s.magicTrace});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getShareManager",value:function(){return this.setup(),this.shareManager}},{key:"setupNativeShareButton",value:(t=(0,a.Z)(h().mark((function e(t,r){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setup(),this.shareManager){e.next=3;break}return e.abrupt("return");case 3:if(this._managerReady){e.next=6;break}return e.next=6,this.waitManagerReady();case 6:return e.abrupt("return",this.shareManager.setupNativeShareButton(t,r));case 7:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})}]),e}();He.getInstance=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ue||(Ue=new He(e)),Ue};var xe=He,We=r(83023),je=r(34136),Fe=r(7931),Be=r(89145),Qe=r(83e3),Ge=m.Z.ShareErrorCode,Ke=xe},43319:function(e,t,r){r.d(t,{i:function(){return i}});var n=r(96294),a=[n.Z.QQ_CHAT_SESSION,n.Z.QQ_ZONE,n.Z.QQ_CHAT_SESSION_IMAGE,n.Z.QQ_ZONE_IMAGE],i=function(e){return a.indexOf(e)>=0}},82776:function(e,t,r){r.d(t,{s:function(){return c}});r(82139);var n=r(22485);function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function i(e,t,r){return i=a()?Reflect.construct:function(e,t,r){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return r&&(0,n.Z)(i,r.prototype),i},i.apply(null,arguments)}var s=r(68309),o=r(69348),h=(r(27476),r(50110),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,s.Z)(this,e),this._cacheMap={},this._cacheLimit=t.cacheLimit||20}return(0,o.Z)(e,[{key:"getResponseByHash",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this._cacheMap[e];return t?t.response:null}},{key:"cacheResponseByHash",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if(e&&t){var r=Object.keys(this._cacheMap).length||0;if(!(r>=this._cacheLimit)){var n=this._cacheMap[e];n?n.response=t:this._cacheMap[e]={response:t,count:1,trigger:!1,complete:!1}}}}},{key:"_write",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0,n=this._cacheMap[t]||{};n[e]=r,this._cacheMap[t]=n}},{key:"_read",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(this._cacheMap[t]||{})[e]}},{key:"getCountByHash",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._read("count",e)||0}},{key:"increaseCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._write("count",e,this.getCountByHash()+1)}},{key:"getShareID",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._read("share_id",e)}},{key:"setShareID",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._write("share_id",e,t)}}]),e}()),u=null;function c(){return u||(u=i(h,Array.prototype.slice.call(arguments))),u}},79875:function(e,t,r){r.d(t,{Z:function(){return S}});var n=r(68309),a=r(69348),i=r(18482),s=(r(75115),r(96253),r(40851),r(20392)),o=r(77500),h=r(49385),u=r(19586),c=r(12008),l="api/flow/audience/share/trace";function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,c.e)({pageInfo:{pageId:(0,u.e6)()}},{defaultErrorHandler:function(e){}}),n={};return n.origin=t.platform||"",n.share_params=t.shareParams||{},n.page_sn=t.pageSn||(0,u.kd)()+"",n.page_info=t.pageInfo||{page_name:(0,u.j0)(),page_url:location&&location.href},t.payloadMixin&&"object"===(0,h.Z)(t.payloadMixin)&&(n=Object.assign(n,t.payloadMixin)),("post"===e.toLowerCase()?r.post(l,n):r.get(l,{params:n})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.magic_trace}))}var f=r(31022),_=r(38639);function v(e,t){if(!(t&&t.key&&t.value&&t.trace))return e;var r=new s.Z(e),n=t.key,a=t.value,h=t.trace;return(0,o.Z)(Object.assign((0,i.Z)({},n,a),r.query),h,r.origin)}var d=function(){function e(){(0,n.Z)(this,e),this._isInited=!1,this._magicTrace=null}return(0,a.Z)(e,[{key:"build",value:function(e){var t=e.magicTrace,r=void 0===t?{}:t;return this._isInited||r.key&&r.value&&r.trace&&(this._magicTrace=r,this._isInited=!0),Promise.resolve()}},{key:"isInited",value:function(){return this._isInited}},{key:"transform",value:function(e){return v(e,this._magicTrace)}},{key:"transformByShareEntity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p("post",{platform:(0,_.Z)(),shareParams:(0,f.I)(e),payloadMixin:e.payloadMixin}).then((function(t){return v(e.shareURL,t)}))}}]),e}(),E=null;d.getInstance=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return E||(E=new d(e)),E};var S=d},20392:function(e,t,r){var n=r(23877),a=r(68309),i=r(69348),s=(r(76142),r(51876),r(21466),r(59357),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(0,a.Z)(this,e),this.hostname="",this.origin="",this.pagename="",this.pathname="",this.port=0,this.protocol="",this.query={},this.search="",this.hashTag="",this.parseURL(t)}return(0,i.Z)(e,[{key:"parseURL",value:function(e){var t=e.split("#"),r=t[0]||"";this.hashTag=t[1]||"";var a=r.split("?"),i=a[0]||"",s=a[1]||"";this.search="?"+s,this.query=(s.split("&")||[]).reduce((function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=n.split("=");try{t=decodeURIComponent(a[0]||""),r=decodeURIComponent(a[1]||"")}catch(e){t=""}return t&&(e[t]=r),e}),{});var o=i.match(/^([a-zA-Z]+:)\/\//)||[];this.protocol=o[1]||"";o[0]&&(i=i.replace(o[0],""));var h=i.match(/^((:?[a-zA-Z0-9](:?[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,6})(:\d+)?\//)||[],u=(h[0]||"").replace(/\//g,"").split(":"),c=(0,n.Z)(u,2),l=c[0],p=c[1];this.hostname=l,this.port=parseInt(p||0,10),h[0]&&(i=i.replace(h[0],"")),this.protocol&&this.hostname&&(this.origin="".concat(this.protocol,"//").concat(this.hostname)),this.pathname="/"+i.replace(/^\//,"");var f=i.match(/\/?(\w+\.html)$/)||[];this.pagename=f[1]||""}}]),e}());t.Z=s},4898:function(e,t,r){r.d(t,{Pp:function(){return s},uW:function(){return i},vD:function(){return a}});var n={DEFAULT:0,REDIRECT:1,SERVER_DOMAIN:2,SERVER_CONTROL:3,SERVER_SHORT_URL:4,RAW:5,SERVER_TINY_DOMAIN:6,SERVER_DOMAIN_BASE64:7,DOMAIN_REPLACE:8,MAGIC_TRACE:9,MAGIC_TRACE_DYNAMIC:10,SERVER_SHORT_URL_WITH_CACHE:11,SERVER_TP_APP:12,SERVER_TP_APP_CARD:13,SERVER_QUERY_APPEND:14,CATEGORY_PROCEDURE:15,CATEGORY_PROCEDURE_CUSTOM:16};function a(e){return[n.SERVER_CONTROL,n.SERVER_SHORT_URL,n.SERVER_TINY_DOMAIN,n.SERVER_DOMAIN_BASE64,n.DOMAIN_REPLACE,n.SERVER_SHORT_URL_WITH_CACHE].indexOf(e)>=0}function i(e){return[n.SERVER_CONTROL,n.SERVER_TINY_DOMAIN,n.SERVER_DOMAIN_BASE64,n.DOMAIN_REPLACE].indexOf(e)>=0}function s(e){return[n.SERVER_SHORT_URL,n.SERVER_SHORT_URL_WITH_CACHE,n.SERVER_TP_APP_CARD,n.CATEGORY_PROCEDURE,n.CATEGORY_PROCEDURE_CUSTOM].indexOf(e)>=0}t.ZP=n},77500:function(e,t,r){r.d(t,{Z:function(){return i}});r(59357);var n=r(24649),a=r(20392);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return 0===window.location.href.indexOf("amcomponent://")&&(r=r||new a.Z(t).origin),t=(0,n.ru)(e,(0,n.De)(t||location.href)),r?(r=r.replace(/\/$/g,""),"".concat(r).concat((0,n.Rh)(t))):t}},42863:function(e,t,r){r.d(t,{Z:function(){return s}});var n=r(77500),a=r(2568),i=r.n(a);function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.shareURL,r=(0,n.Z)({refer_share_id:null,refer_share_uid:null,refer_share_channel:null,refer_share_uin:null},t),a=e.payloadMixin||{},s=JSON.stringify(a);return i()(r+s)}},19586:function(e,t,r){r.d(t,{I8:function(){return a},e6:function(){return i},j0:function(){return o},kd:function(){return s}});r(75115);var n={};function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(n,e)}function i(){return n.pageId||""}function s(){return n.pageSN||""}function o(){return n.pageName||""}},18223:function(e,t,r){r.d(t,{Z:function(){return i}});r(21466);var n=r(74711),a="undefined"!=typeof window;function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.match(/^http:?/)?e:(0,n.zT)().isNativePlatform||!a?"http://".concat(e):location.protocol?"".concat(location.protocol,"//").concat(e):void 0}},47503:function(e,t,r){r.d(t,{Hr:function(){return p},O$:function(){return l},ZP:function(){return f}});r(27476),r(95767),r(98837),r(94882),r(98351);var n=r(18482),a=(r(59357),r(75115),r(24649)),i=r(77500),s=r(20392),o=r(36991);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c={};function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new s.Z(e.shareURL).query||{};return{refer_share_id:t.refer_share_id,refer_share_uid:t.refer_share_uid,refer_share_channel:t.refer_share_channel,refer_share_uin:t.refer_share_uin}}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/^(?:https?:?)?\/\//,"https://")}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.miniObjectPath,n=new s.Z(r),o=new s.Z(n.query.target_page||""),h=o.query||{},f=t.appendQuery||{},_=u(u({},l(e)),f),v=e.shareDomain||c.shareDomain;if(h.specialUrl||h.src)return h.src?h.src=(0,i.Z)(_,h.src,v):h.src=p(e.shareURL),"".concat(n.pathname,"?").concat((0,a.XP)(Object.assign({},n.query,{target_page:"".concat(o.pathname,"?").concat((0,a.XP)(h))})));if(h.jump_url||h.launch_url){if(h.jump_url){var d=new s.Z(h.jump_url);if(!d.hostname){var E=d.query;E.specialUrl&&(E.src?E.src=(0,i.Z)(_,E.src,v):E.src=p(e.shareURL),h.jump_url="".concat(d.pathname,"?").concat((0,a.XP)(E)))}}return h.launch_url&&(h.launch_url=(0,i.Z)(_,h.launch_url)),"".concat(n.pathname,"?").concat((0,a.XP)(Object.assign({},n.query,{target_page:"".concat(o.pathname,"?").concat((0,a.XP)(h))})))}return n.hostname||o.hostname||!n.query.target_page?"".concat(n.pathname,"?").concat((0,a.XP)(Object.assign({},n.query,_))):"".concat(n.pathname,"?").concat((0,a.XP)(Object.assign({},n.query,{target_page:"".concat(o.pathname,"?").concat((0,a.XP)(Object.assign(h,_)))})))}"undefined"!=typeof window&&(c=o.Z.get(location.host)||{})},83170:function(e,t,r){r.d(t,{SY:function(){return p},X4:function(){return c},ZP:function(){return f},v3:function(){return u}});var n=r(49385),a=(r(75115),r(51876),r(19586)),i=r(12008),s=r(47503),o=r(20392),h=r(24649),u={WEIXIN_TINY_DOMAIN:"weixin",SHORT_LINK:"link"},c={WECHAT:"h5",IOS:"ios",ANDROID:"android"},l="api/flow/chron/share/miniprogram";function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,i.e)({pageInfo:{pageId:(0,a.e6)()}},{defaultErrorHandler:function(e){}}),o={};o.share_refer=(0,s.O$)({shareURL:t.shareURL}),t.payloadMixin&&"object"===(0,n.Z)(t.payloadMixin)&&(o=Object.assign(o,t.payloadMixin));var h=t.shortURLApi||l;return("post"===e.toLowerCase()?r.post(h,o):r.get(h,{params:o})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e}))}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,i.e)({pageInfo:{pageId:(0,a.e6)()}},{defaultErrorHandler:function(e){}}),c={};c.url=t.shareURL||"",c.activity=t.marketActivityID||0,c.platform=t.platform||"",c.share_refer=(0,s.O$)({shareURL:t.shareURL}),c.page_sn=(0,a.kd)(),t.payloadMixin&&"object"===(0,n.Z)(t.payloadMixin)&&(c=Object.assign(c,t.payloadMixin));var l=t.urlAlias||"url_code",p=c[l];if(p&&"string"==typeof p){var f=new o.Z(p).query||{};Object.assign(f,c.share_refer),c[l]="".concat(p.split("?")[0]||"","?").concat((0,h.XP)(f))}var _="api/flow/audience/activity/domain/weixin";return t.shareDomainType===u.SHORT_LINK?_=t.shortURLApi?t.shortURLApi:t.shortCommandApi?t.shortCommandApi:"api/flow/audience/activity/domain/short_url":t.domainURLApi&&(_=t.domainURLApi),("post"===e.toLowerCase()?r.post(_,c):r.get(_,{params:c})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{domain:e.domain,openAppID:e.open_app_id||"",shortURL:e.short_url||"",shareText:e.share_text||"",raw:e}}))}},54340:function(e,t,r){r.d(t,{CU:function(){return S},Ep:function(){return y},Yy:function(){return E},ls:function(){return g}});var n=r(95813),a=(r(96253),r(40851),r(59357),r(83170)),i=r(74711),s=r(42202),o=r(43319),h=r(79875),u=r(42863),c=r(82776),l=r(4898),p=r(20392),f=r(18223),_=r(77500),v=["share_title","share_img","dev_infos"],d=["mobile.yangkeduo.com","m.hutaojie.com","panduoduo.yangkeduo.com"],E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.shareURL||"",r=e.urlWrapType;if(r===l.ZP.DEFAULT||r===l.ZP.RAW)return Promise.resolve({missed:!0,realShareURL:t,targetShareURL:t});if(e.marketActivityID&&(0,l.vD)(r)){var i=(0,l.uW)(r)?a.v3.WEIXIN_TINY_DOMAIN:a.v3.SHORT_LINK,s=t.replace(/^(\w+:)?\/\//,""),o=(0,u.Z)(e),f=(0,c.s)(),d=function(){var n=new Promise((function(n,o){(0,a.ZP)(e.requestUsePost?"post":"get",{shareURL:s,marketActivityID:e.marketActivityID,platform:y(),shareDomainType:i,shortURLApi:e.shortURLApi,shortCommandApi:e.shortCommandApi,domainURLApi:e.domainURLApi,payloadMixin:e.payloadMixin}).then((function(e){if(e){var s=e.domain,o=void 0===s?"":s,h=e.shortURL,u=e.shareText,c=e.raw;if(i===a.v3.WEIXIN_TINY_DOMAIN)r===l.ZP.DOMAIN_REPLACE&&n(S(t,o));else if(i===a.v3.SHORT_LINK)return void n({useShortURL:!0,realShareURL:h||t,targetShareURL:t,shareText:u,rawResponse:c})}n({realShareURL:t,targetShareURL:t})})).catch((function(e){o(e)}))}));return i===a.v3.SHORT_LINK&&n.then((function(e){e&&e.useShortURL&&(f.cacheResponseByHash(o,e),f.setShareID(o,(new p.Z(t).query||{}).refer_share_id))})),n};if(r===l.ZP.SERVER_SHORT_URL_WITH_CACHE){var E=f.getResponseByHash(o);return E?(f.increaseCount(o),Promise.resolve(E)):d()}return d()}if(r===l.ZP.MAGIC_TRACE){var g=h.Z.getInstance().transform(t);return Promise.resolve({realShareURL:g,targetShareURL:g})}return r===l.ZP.MAGIC_TRACE_DYNAMIC?h.Z.getInstance().transformByShareEntity(e).then((function(e){return{realShareURL:e,targetShareURL:e}}),(function(){return{realShareURL:t,targetShareURL:t}})):r===l.ZP.SERVER_QUERY_APPEND?(0,a.SY)(e.requestUsePost?"post":"get",{shareURL:t,payloadMixin:e.payloadMixin,shortURLApi:e.shortURLApi}).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e&&e.code_method;if(r)return{useCipher:r,realShareURL:t,targetShareURL:t};var a=e.share_title,i=e.share_img,s=e.dev_infos,o=(0,n.Z)(e,v),h=(0,_.Z)(o,t);return{appendQuery:o,categoryShareInfo:{title:a,thumbnailURL:i},realShareURL:h,targetShareURL:h,tpInfos:s}})):Promise.resolve({missed:!0,realShareURL:t,targetShareURL:t})},S=function(e,t){var r=(0,_.Z)({},e,(0,f.Z)(t));return{targetShareURL:r,realShareURL:r}},y=function(){var e=(0,i.zT)();return e.platform===s.iw.PddAndroid?a.X4.ANDROID:e.platform===s.iw.PddIOS?a.X4.IOS:a.X4.WECHAT},g=function(e,t){if(!(0,o.i)(e))return t;var r=new p.Z(t).hostname;return d.indexOf(r)<0&&(t=t.replace("//".concat(r),"//".concat("mobile.yangkeduo.com"))),t}},17187:function(e){var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(r,n){function a(r){e.removeListener(t,i),n(r)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",a),r([].slice.call(arguments))}v(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&v(e,"error",t,r)}(e,a,{once:!0})}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function o(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function h(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var a,i,s,u;if(o(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]),void 0===s)s=i[t]=r,++e._eventsCount;else if("function"==typeof s?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(a=h(e))>0&&s.length>a&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,u=c,console&&console.warn&&console.warn(u)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},a=c.bind(n);return a.listener=r,n.wrapFn=a,a}function p(e,t,r){var n=e._events;if(void 0===n)return[];var a=n[t];return void 0===a?[]:"function"==typeof a?r?[a.listener||a]:[a]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(a):_(a,a.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function _(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function v(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function a(i){n.once&&e.removeEventListener(t,a),r(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return h(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var a="error"===e,i=this._events;if(void 0!==i)a=a&&void 0===i.error;else if(!a)return!1;if(a){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var h=i[e];if(void 0===h)return!1;if("function"==typeof h)n(h,this,t);else{var u=h.length,c=_(h,u);for(r=0;r<u;++r)n(c[r],this,t)}return!0},i.prototype.addListener=function(e,t){return u(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return u(this,e,t,!0)},i.prototype.once=function(e,t){return o(t),this.on(e,l(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return o(t),this.prependListener(e,l(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,n,a,i,s;if(o(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(a=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){s=r[i].listener,a=i;break}if(a<0)return this;0===a?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,a),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var a,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(a=i[n])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return p(this,e,!0)},i.prototype.rawListeners=function(e){return p(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},i.prototype.listenerCount=f,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}}}]);
//# sourceMappingURL=http://vgunxpkt.com/sourcemaps/assets/js/5929_a14da7d1d823f43f659e.js.map